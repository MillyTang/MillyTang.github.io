<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"github.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Comfortably Numb">
<meta property="og:url" content="https://github.com/MillyTang/MillyTang.github.io/index.html">
<meta property="og:site_name" content="Comfortably Numb">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://github.com/MillyTang/MillyTang.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Comfortably Numb</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Comfortably Numb</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">åæ–¹å‘çš„é’Ÿ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/07/19/ui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/19/ui/" class="post-title-link" itemprop="url">vue3 composables ç»„ä»¶</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-07-19 14:36:15" itemprop="dateCreated datePublished" datetime="2021-07-19T14:36:15+08:00">2021-07-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-07 13:21:35" itemprop="dateModified" datetime="2021-09-07T13:21:35+08:00">2021-09-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ–½å·¥ğŸš§ä¸­ï¼Œæ•¬è¯·æœŸå¾…</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/06/26/ts-type-challenges/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/26/ts-type-challenges/" class="post-title-link" itemprop="url">TypeScript ç±»å‹ä½“æ“</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-26 16:48:14" itemprop="dateCreated datePublished" datetime="2021-06-26T16:48:14+08:00">2021-06-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-01 12:54:40" itemprop="dateModified" datetime="2021-09-01T12:54:40+08:00">2021-09-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>æŒ‘æˆ˜ç±»å‹ä½“æ“ç­”æ¡ˆåˆé›†ï¼Œä¸€éƒ¨åˆ†æ˜¯è‡ªå·±åšçš„ï¼Œä¸€éƒ¨åˆ†æ˜¯è‡ªå·±æŠ„çš„</p>
</blockquote>
<h2 id="çƒ­èº«è¿åŠ¨"><a href="#çƒ­èº«è¿åŠ¨" class="headerlink" title="çƒ­èº«è¿åŠ¨"></a>çƒ­èº«è¿åŠ¨</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœŸæœ›æ˜¯ä¸€ä¸ª string ç±»å‹</span></span><br><span class="line"><span class="comment">// any -&gt; string</span></span><br><span class="line"><span class="keyword">type</span> HelloWorld = <span class="built_in">string</span></span><br><span class="line"><span class="comment">// ä½ éœ€è¦ä½¿å¾—å¦‚ä¸‹è¿™è¡Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="keyword">type</span> test = Expect&lt;Equal&lt;HelloWorld, <span class="built_in">string</span>&gt;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å®ç°Pick"><a href="#å®ç°Pick" class="headerlink" title="å®ç°Pick"></a>å®ç°Pick</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  title: <span class="built_in">string</span></span><br><span class="line">  description: <span class="built_in">string</span></span><br><span class="line">  completed: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyPick&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> K]: T[P] </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoPreview = MyPick&lt;Todo, <span class="string">&#x27;title&#x27;</span> | <span class="string">&#x27;completed&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todo: TodoPreview = &#123;</span><br><span class="line">    title: <span class="string">&#x27;Clean room&#x27;</span>,</span><br><span class="line">    completed: <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Readonly"><a href="#Readonly" class="headerlink" title="Readonly"></a>Readonly</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  title: <span class="built_in">string</span></span><br><span class="line">  description: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyReadonly&lt;T&gt; = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todo: MyReadonly&lt;Todo&gt; = &#123;</span><br><span class="line">  title: <span class="string">&quot;Hey&quot;</span>,</span><br><span class="line">  description: <span class="string">&quot;foobar&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">todo.title = <span class="string">&quot;Hello&quot;</span> <span class="comment">// Error: cannot reassign a readonly property</span></span><br><span class="line">todo.description = <span class="string">&quot;barFoo&quot;</span> <span class="comment">// Error: cannot reassign a readonly property</span></span><br></pre></td></tr></table></figure>

<h2 id="Omit"><a href="#Omit" class="headerlink" title="Omit"></a>Omit</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  title: <span class="built_in">string</span></span><br><span class="line">  description: <span class="built_in">string</span></span><br><span class="line">  completed: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyOmit&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T <span class="keyword">as</span> P <span class="keyword">extends</span> K ? <span class="built_in">never</span>: P]: T[P]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoPreview = MyOmit&lt;Todo, <span class="string">&#x27;description&#x27;</span> | <span class="string">&#x27;title&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todo: TodoPreview = &#123;</span><br><span class="line">  completed: <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Exclude"><a href="#Exclude" class="headerlink" title="Exclude"></a>Exclude</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»Tä¸­æ’é™¤å¯åˆ†é…ç»™Uçš„ç±»å‹</span></span><br><span class="line"><span class="comment">// T, U éƒ½æ˜¯ç±»å‹</span></span><br><span class="line"><span class="comment">// MyExclude&lt;&#x27;a&#x27; | &#x27;b&#x27; | &#x27;c&#x27;, &#x27;a&#x27;&gt; // è¾“å‡º &#x27;b&#x27; | &#x27;c&#x27;</span></span><br><span class="line"><span class="keyword">type</span> MyExclude&lt;T, U&gt; = T <span class="keyword">extends</span> U ? <span class="built_in">never</span> : T</span><br></pre></td></tr></table></figure>

<!-- ## PromiseAll

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PromiseAll&lt;&gt;</span><br><span class="line"><span class="keyword">const</span> promise1 = <span class="built_in">Promise</span>.resolve(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">const</span> promise3 = <span class="keyword">new</span> <span class="built_in">Promise</span>&lt;<span class="built_in">string</span>&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(resolve, <span class="number">100</span>, <span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// expected to be `Promise&lt;[number, number, string]&gt;`</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="built_in">Promise</span>.all([promise1, promise2, promise3] <span class="keyword">as</span> <span class="keyword">const</span>) --&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/04/15/using-es6-in-node-when-write-plugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/15/using-es6-in-node-when-write-plugin/" class="post-title-link" itemprop="url">å¼€å‘viteç›¸å…³æ’ä»¶çš„é—®é¢˜</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-15 15:50:22" itemprop="dateCreated datePublished" datetime="2021-04-15T15:50:22+08:00">2021-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-27 10:46:29" itemprop="dateModified" datetime="2021-04-27T10:46:29+08:00">2021-04-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>æ¸©é¦¨æç¤ºï¼š å…ˆåˆ«æ›¿æ¢ ant-design-vue ä¸­çš„ moment ä¸º dayjs, æœ‰bug, date-pickerä¼šåæ‰ï¼Œç­‰ä½œè€…ä¿®å¥½å†æ¢</p>
</blockquote>
<p>æœ¬é¡¹ç›®çš„æŠ€æœ¯æ ˆæ˜¯ï¼š<code>vite vue3 ant-desing-vue</code>ã€‚<br>é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„<code>ant-desing-vue</code>UI ç»„ä»¶ä¾èµ–<code>moment</code>,æˆ‘çœ‹å®˜ç½‘æç¤ºæœ‰æ’ä»¶å¯ä»¥æ”¹æˆ<code>dayjs</code>,å¯ä»¥ä½¿æ•´ä¸ªåŒ…å°ä¸€ç‚¹ï¼Œçœ‹äº†<code>antd-dayjs-webpack-plugin</code>çš„ä»£ç åå‘ç°æ²¡æœ‰é’ˆå¯¹<code>vite ant-desing-vue</code>çš„,å°±è·ƒè·ƒæ¬²è¯•æƒ³å†™ä¸€ä¸ª<code>vite-plugin-vue-ant-desing-vue-dayjs</code>æ’ä»¶ï¼Œä¸“é—¨ç”¨åœ¨<code>vite vue3 ant-desing-vue</code>é¡¹ç›®ä¸­ã€‚åé¢å…¶å®å‘ç°æ²¡å¿…è¦ï¼Œå½“ç„¶ï¼Œå†™å®Œæ‰å‘ç°-_-||</p>
<h2 id="ä¸»è¦é—®é¢˜"><a href="#ä¸»è¦é—®é¢˜" class="headerlink" title="ä¸»è¦é—®é¢˜"></a>ä¸»è¦é—®é¢˜</h2><h3 id="å äº†-3-ä¸ª-debuff-å¯¼è‡´è¿è¡Œæ—¶å‡ºé—®é¢˜"><a href="#å äº†-3-ä¸ª-debuff-å¯¼è‡´è¿è¡Œæ—¶å‡ºé—®é¢˜" class="headerlink" title="å äº† 3 ä¸ª debuff å¯¼è‡´è¿è¡Œæ—¶å‡ºé—®é¢˜"></a>å äº† 3 ä¸ª debuff å¯¼è‡´è¿è¡Œæ—¶å‡ºé—®é¢˜</h3><ol>
<li>ç”±äºæˆ‘ fork äº†ä¸€éƒ¨åˆ†<code>antd-dayjs-webpack-plugin</code>ä»£ç ï¼Œå†…éƒ¨æ˜¯<code>module.exports</code></li>
<li>åŒæ—¶å…¥å£æ–‡ä»¶é‡Œæ˜¯ç›´æ¥<code>export default vitePluginVueAntDVueDayjs(Options=&#123;&#125;) &#123;...&#125;</code></li>
<li>è€Œä¸”æ˜¯ç›´æ¥<code>yarn add git+ssh://git@github.com:xxx/some-project.git --dev</code>ï¼Œè¿™ä¸ª<code>some-project</code>å°±æ˜¯å†™çš„æ’ä»¶ï¼Œ<code>package.json</code>é‡Œæš´éœ²çš„ç›´æ¥æ˜¯<code>main: src/index.js</code>,</li>
</ol>
<p>ç¬¬ä¸€æ¬¡å†™æ’ä»¶ï¼Œå¿ƒæƒ…ååˆ†æ¿€åŠ¨ç»“æœåˆšè¿è¡Œå°±æŠ¥é”™,æœäº†ä¸€ä¸‹åŸæ¥æ˜¯ node ç¯å¢ƒé‡Œä¸èƒ½ç›´æ¥åŠ è½½<code>ES6</code>æ¨¡å—ã€‚ã€‚ã€‚äºæ˜¯æˆ‘é‡æ–°çœ‹äº†ä¸€æ¬¡ es6 æ–‡æ¡£<code>node ç¯å¢ƒå¦‚ä½•åŠ è½½es6æ¨¡å—</code>ï¼Œç„¶åæŸ¥äº†ä¸€ä¸‹<code>@vite/plugin-vue</code>çš„è§£å†³åŠæ³•</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ol>
<li>å®Œå…¨é‡‡ç”¨ cjs æ¨¡å—æ–¹å¼ç¼–å†™ï¼Œä¸€æ°´å„¿çš„<code>module.export</code> -&gt; é’ˆå¯¹å…¥å£æ–‡ä»¶éæ‰“åŒ…åçš„æ’ä»¶ã€‚å¦‚<code>package.jsonä¸­çš„main: src/index.js</code></li>
<li>å°† es6 æ¨¡å—æ‰“åŒ…ç¼–è¯‘æˆ node æ¨¡å—ï¼ˆ@vite/plugin-vueï¼‰å°±æ˜¯è¿™ä¹ˆåšçš„ï¼š<code>esbuild src/index.ts --bundle --platform=node --target=node12 --external:@vue/compiler-sfc --outfile=dist/index.js</code> -&gt; å®Œå…¨ä½¿ç”¨ es6 æ¨¡å—ç¼–å†™æ’ä»¶ï¼Œç„¶åä½¿ç”¨æ‰“åŒ…åçš„ cjs æ¨¡å—, <code>package.jsonä¸­çš„main: dist/index.js</code></li>
</ol>
<h2 id="æ²¡å¿…è¦å†™æ˜¯å› ä¸ºç›´æ¥é…ç½®å³å¯"><a href="#æ²¡å¿…è¦å†™æ˜¯å› ä¸ºç›´æ¥é…ç½®å³å¯" class="headerlink" title="æ²¡å¿…è¦å†™æ˜¯å› ä¸ºç›´æ¥é…ç½®å³å¯"></a>æ²¡å¿…è¦å†™æ˜¯å› ä¸ºç›´æ¥é…ç½®å³å¯</h2><pre><code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤è¡Œ</span></span><br><span class="line"><span class="comment"># npm i dayjs</span></span><br><span class="line">yarn add dayjs</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vite.config.jsæ–‡ä»¶</span></span><br><span class="line">&#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      moment: <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line"><span class="keyword">import</span> isSameOrBefore <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/isSameOrBefore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> isSameOrAfter <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/isSameOrAfter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> advancedFormat <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/advancedFormat&#x27;</span></span><br><span class="line"><span class="keyword">import</span> customParseFormat <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/customParseFormat&#x27;</span></span><br><span class="line"><span class="keyword">import</span> weekday <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/weekday&#x27;</span></span><br><span class="line"><span class="keyword">import</span> weekOfYear <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/weekOfYear&#x27;</span></span><br><span class="line"><span class="keyword">import</span> isMoment <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/isMoment&#x27;</span></span><br><span class="line"><span class="keyword">import</span> localeData <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/localeData&#x27;</span></span><br><span class="line"><span class="keyword">import</span> localizedFormat <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/localizedFormat&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dayjs/locale/zh-cn&#x27;</span> <span class="comment">// å¯¼å…¥æœ¬åœ°åŒ–è¯­è¨€</span></span><br><span class="line"></span><br><span class="line">dayjs.extend(isSameOrBefore)</span><br><span class="line">dayjs.extend(isSameOrAfter)</span><br><span class="line">dayjs.extend(advancedFormat)</span><br><span class="line">dayjs.extend(customParseFormat)</span><br><span class="line">dayjs.extend(weekday)</span><br><span class="line">dayjs.extend(weekOfYear)</span><br><span class="line">dayjs.extend(isMoment)</span><br><span class="line">dayjs.extend(localeData)</span><br><span class="line">dayjs.extend(localizedFormat)</span><br><span class="line">dayjs.locale(<span class="string">&#x27;zh-cn&#x27;</span>) <span class="comment">// ä½¿ç”¨æœ¬åœ°åŒ–è¯­è¨€</span></span><br></pre></td></tr></table></figure></code></pre>
<h2 id="æ’ä»¶æ­¥éª¤"><a href="#æ’ä»¶æ­¥éª¤" class="headerlink" title="æ’ä»¶æ­¥éª¤"></a>æ’ä»¶æ­¥éª¤</h2><p>å¦‚æœè¦å†™ä¹Ÿä¸æ˜¯ä¸è¡Œï¼šçœ‹ä¸Šé¢çš„é…ç½®æ­¥éª¤å³å¯çŸ¥é“æ€è·¯ï¼Œå¯å‚è€ƒé¡¹ç›®<a href="https://github.com/MillyTang/vite-plugin-for-antd-dayjs">vite-plugin-vue-antd-dayjs</a></p>
<h3 id="ç¬¬ä¸€ç§ï¼š-ä½¿ç”¨éæ‰“åŒ…æ’ä»¶"><a href="#ç¬¬ä¸€ç§ï¼š-ä½¿ç”¨éæ‰“åŒ…æ’ä»¶" class="headerlink" title="ç¬¬ä¸€ç§ï¼š ä½¿ç”¨éæ‰“åŒ…æ’ä»¶"></a>ç¬¬ä¸€ç§ï¼š ä½¿ç”¨éæ‰“åŒ…æ’ä»¶</h3><blockquote>
<p>æœ‰ä¸ªç›´æ¥çš„å¥½å¤„ï¼Œå®‰è£…åå¯ä»¥ç›´æ¥ä¿®æ”¹åŒ…æ–‡ä»¶æ¥æµ‹è¯•ä»£ç é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œå³æ”¹å³ç”¨,æˆ‘å½“æ—¶é‡‡ç”¨çš„å°±æ˜¯è¿™ç§å†™æ³•</p>
</blockquote>
<h4 id="1-æ–°å»ºé¡¹ç›®"><a href="#1-æ–°å»ºé¡¹ç›®" class="headerlink" title="1. æ–°å»ºé¡¹ç›®"></a>1. æ–°å»ºé¡¹ç›®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¡¹ç›®ç»“æ„</span></span><br><span class="line">|-- src</span><br><span class="line">|----|--index.js</span><br><span class="line">|-- package.json</span><br><span class="line">|-- README.md</span><br></pre></td></tr></table></figure>

<h4 id="2-package-json-é…ç½®"><a href="#2-package-json-é…ç½®" class="headerlink" title="2. package.json é…ç½®"></a>2. package.json é…ç½®</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packgae.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;vite-plugin-xxx&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Description of the vite-plugin-xxx&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;src/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span>: [<span class="string">&quot;vite-plugin&quot;</span>, <span class="string">&quot;vite-plugin-vue&quot;</span>, <span class="string">&quot;rollup-plugin&quot;</span>, <span class="string">&quot;xxx&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;engines&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;node&quot;</span>: <span class="string">&quot;&gt;=12.0.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;dayjs&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;dayjs&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;homepage&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;bugs&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;repository&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;git&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;your Name&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-å…¥å£æ–‡ä»¶"><a href="#3-å…¥å£æ–‡ä»¶" class="headerlink" title="3. å…¥å£æ–‡ä»¶"></a>3. å…¥å£æ–‡ä»¶</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">VitePluginVueXXX</span>(<span class="params">Options = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> virtualFile = <span class="string">&quot;@virtual-file&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    name: <span class="string">&quot;vite-plugin-vue-xxx&quot;</span>,</span><br><span class="line">    enforce: <span class="string">&quot;pre&quot;</span>, <span class="comment">// åŠ è½½viteå†…ç½®æ’ä»¶ä¹‹å‰åŠ è½½</span></span><br><span class="line">    config: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">      <span class="string">&quot;resolve.alias&quot;</span>: &#123;</span><br><span class="line">        moment: <span class="string">&quot;dayjs&quot;</span>, <span class="comment">// set dayjs alias</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;), <span class="comment">// åœ¨è¢«è§£æä¹‹å‰ä¿®æ”¹ Vite é…ç½®</span></span><br><span class="line">    configResolved(resolvedConfig) &#123;</span><br><span class="line">      <span class="comment">// å­˜å‚¨æœ€ç»ˆè§£æçš„é…ç½®</span></span><br><span class="line">      config = resolvedConfig;</span><br><span class="line">    &#125;, <span class="comment">// åœ¨è§£æ Vite é…ç½®åè°ƒç”¨</span></span><br><span class="line">    resolveId(id) &#123;</span><br><span class="line">      <span class="comment">// æ¯ä¸ªä¼ å…¥çš„æ¨¡å—è¯·æ±‚æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">      <span class="keyword">if</span> (id === virtualFile) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;resolveid id test&quot;</span>, id);</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    load(id) &#123;</span><br><span class="line">      <span class="comment">// æ¯ä¸ªä¼ å…¥çš„æ¨¡å—è¯·æ±‚æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">      <span class="keyword">if</span> (id === virtualFile) &#123;</span><br><span class="line">        <span class="comment">// åœ¨è¿™é‡Œreturnä¸Šé¢main.jså¼•å…¥çš„æ’ä»¶å’Œä¾èµ–</span></span><br><span class="line">        <span class="comment">// å¦‚æœéœ€è¦çŸ¥é“å“ªäº›æ’ä»¶å¿…é¡»å¼•å…¥ï¼Œç›´æ¥æŸ¥çœ‹dayjså®˜ç½‘çš„æ’ä»¶åˆé›†</span></span><br><span class="line">        <span class="comment">// return å‡ºå»çš„æ˜¯ `@virtual-file`çš„æ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œå†™æˆ `const xxx = require(&#x27;xxx&#x27;)` or `import xxx from &#x27;xxxx&#x27;`éƒ½æ˜¯å¯ä»¥çš„ï¼Œæ³¨æ„åœ¨`main.js`å†…çš„å¼•ç”¨å½¢å¼å³å¯</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚ï¼šisMoment plugin</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">`const isMoment =  require(&#x27;dayjs/plugin/isMoment&#x27;); dayjs.extend(isMoment);module.exports = &#123;isMoment&#125;`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="4-å®‰è£…-æ²¡æœ‰å‘å¸ƒçš„åŒ…æ–‡ä»¶"><a href="#4-å®‰è£…-æ²¡æœ‰å‘å¸ƒçš„åŒ…æ–‡ä»¶" class="headerlink" title="4. å®‰è£… æ²¡æœ‰å‘å¸ƒçš„åŒ…æ–‡ä»¶"></a>4. å®‰è£… æ²¡æœ‰å‘å¸ƒçš„åŒ…æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… æ’ä»¶çš„ peerDependencies</span></span><br><span class="line">yarn add dayjs</span><br><span class="line"><span class="comment"># å®‰æ²¡æœ‰å‘å¸ƒçš„è£…æ’ä»¶åŒ…</span></span><br><span class="line">yarn add git+ssh://git@github.com:xxx.git --dev</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ vite.configå†…é…ç½®</span></span><br><span class="line"><span class="comment">// å¼•å…¥æ’ä»¶</span></span><br><span class="line">  <span class="keyword">const</span> vitePluginVueForAntdDayjs = <span class="built_in">require</span>(<span class="string">&#x27;vite-plugin-vue-antd-dayjs&#x27;</span>)</span><br><span class="line"> &#123;</span><br><span class="line">    plugins:  [vue(),vitePluginVueForAntdDayjs()],</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">        moment: <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-åœ¨-main-js-é‡Œå¼•å…¥è™šæ‹Ÿæ–‡ä»¶å³å¯"><a href="#5-åœ¨-main-js-é‡Œå¼•å…¥è™šæ‹Ÿæ–‡ä»¶å³å¯" class="headerlink" title="5. åœ¨ main.js é‡Œå¼•å…¥è™šæ‹Ÿæ–‡ä»¶å³å¯"></a>5. åœ¨ main.js é‡Œå¼•å…¥è™šæ‹Ÿæ–‡ä»¶å³å¯</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥ isMoment ä¸ºä¾‹</span></span><br><span class="line"><span class="comment">// åœ¨ mjs å†… å¼•å…¥ cjs æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> isMoment <span class="keyword">from</span> <span class="string">&quot;@virtual-file&quot;</span>;</span><br><span class="line"><span class="comment">// å¦‚æœæ¨¡å—å¾ˆå¤šï¼Œä¸€æ¬¡å¼•å…¥å¾ˆå¤šæ¨¡å—, ç›´æ¥å¼•å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;@virtual-file&quot;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯åŠ¨é¡¹ç›®ï¼š <code>yarn dev</code>, vite æ‰“åŒ…ä¼šå‘ç°æœ‰æç¤ºï¼š<code>[vite] new dependencies found: dayjs/plugin/isSameOrAfter, dayjs/plugin/advancedFormat, dayjs/plugin/customParseFormat, dayjs/plugin/weekday, dayjs/plugin/weekYear, dayjs/plugin/weekOfYear, dayjs/plugin/isMoment, dayjs/plugin/localeData, dayjs/plugin/localizedFormat, dayjs/locale/zh-cn, updating...</code> è¯´æ˜å·²ç»æˆåŠŸå¼•å…¥</p>
</blockquote>
<h4 id="6-æ‰“åŒ…æ¯”è¾ƒå‰ååŒ…çš„å·®å¼‚"><a href="#6-æ‰“åŒ…æ¯”è¾ƒå‰ååŒ…çš„å·®å¼‚" class="headerlink" title="6. æ‰“åŒ…æ¯”è¾ƒå‰ååŒ…çš„å·®å¼‚"></a>6. æ‰“åŒ…æ¯”è¾ƒå‰ååŒ…çš„å·®å¼‚</h4><h3 id="ç¬¬äºŒç§ï¼šä½¿ç”¨æ‰“åŒ…åçš„æ’ä»¶"><a href="#ç¬¬äºŒç§ï¼šä½¿ç”¨æ‰“åŒ…åçš„æ’ä»¶" class="headerlink" title="ç¬¬äºŒç§ï¼šä½¿ç”¨æ‰“åŒ…åçš„æ’ä»¶"></a>ç¬¬äºŒç§ï¼šä½¿ç”¨æ‰“åŒ…åçš„æ’ä»¶</h3><blockquote>
<p>æ­¥éª¤è·Ÿä¸Šé¢çš„å·®ä¸å¤šï¼Œåªæ˜¯å†™çš„æ—¶å€™ä½¿ç”¨ es6 æ¨¡å—,å¤šä¸€æ­¥æ‰“åŒ…&amp;å…¥å£æ–‡ä»¶æœ‰ç‚¹ä¸åŒï¼Œå¯å‚è€ƒé¡¹ç›®<a href="https://github.com/MillyTang/vite-plugin-antd-vue-ts">vite-plugin-antd-vue-ts</a></p>
</blockquote>
<ol>
<li><p>packgae.json çš„é…ç½®</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;dist/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;types&quot;</span>: <span class="string">&quot;dist/index.d.ts&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;build:boundle&quot;</span>: <span class="string">&quot;`esbuild src/index.ts --bundle --platform=node --target=node12 --external:dayjs --outfile=dist/index.js&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;esbuild&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;dayjs&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;dayjs&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¥å£æ–‡ä»¶</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">VitePluginVueXXX</span>(<span class="params">Options = &#123;&#125;</span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æ‰§è¡Œæ‰“åŒ…å‘½ä»¤</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build:boudle</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>é…ç½® <code>vite.config.js</code> &amp; åœ¨<code>main.js</code>å¼•å…¥æ–‡ä»¶æ­¥éª¤åŒä¸Š</li>
</ol>
<blockquote>
<p>å¦‚æœè¦å®ç°åœ¨å…¥å£æ–‡ä»¶çš„å¼•ç”¨æ–¹å¼ä¸º <code>import someplugin from &#39;path/to/all-plugin-file-name&#39;</code>,åœ¨æ’ä»¶å†…ä½¿ç”¨ <code>export default</code> å’Œ <code>module.exports</code>æ˜¯ä¸€æ ·çš„æ•ˆæœ</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/02/18/vite2-vue3-ts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/18/vite2-vue3-ts/" class="post-title-link" itemprop="url">æ„å»º vite2 & Vue3 & tsé¡¹ç›®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-18 17:27:53" itemprop="dateCreated datePublished" datetime="2021-02-18T17:27:53+08:00">2021-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-02 17:02:56" itemprop="dateModified" datetime="2021-09-02T17:02:56+08:00">2021-09-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æ­¥éª¤æ€»è§ˆ"><a href="#æ­¥éª¤æ€»è§ˆ" class="headerlink" title="æ­¥éª¤æ€»è§ˆ"></a>æ­¥éª¤æ€»è§ˆ</h2><h3 id="å¼€å‘å‰é…ç½®"><a href="#å¼€å‘å‰é…ç½®" class="headerlink" title="å¼€å‘å‰é…ç½®"></a>å¼€å‘å‰é…ç½®</h3><ol>
<li>å‘½ä»¤è¡Œä½¿ç”¨ vite ç”Ÿæˆé¡¹ç›®æ¨¡æ¿</li>
<li>é…ç½® TypeScript:<ol>
<li>tsconfig é…ç½®</li>
<li>å®‰è£… ts ç±»å‹æ£€æŸ¥</li>
</ol>
</li>
<li>é›†ä¸­å¤„ç†è¯·æ±‚ã€Axios åº“ã€‘</li>
<li>åˆ†æ”¯ç®¡ç†ä¿æŠ¤ä¸è‡ªåŠ¨åŒ–çš„2ç§æ–¹å¼ï¼Œ1ä¸ªå¿…è¦</li>
</ol>
<h3 id="å¼€å§‹å¼€å‘"><a href="#å¼€å§‹å¼€å‘" class="headerlink" title="å¼€å§‹å¼€å‘"></a>å¼€å§‹å¼€å‘</h3><ol>
<li>é…ç½®ç¯å¢ƒæ–‡ä»¶</li>
<li>é…ç½®åˆ«åã€å¯é€‰ã€‘</li>
<li>é…ç½®è·¯ç”±</li>
<li>é€‰æ‹©&amp;è°ƒç ”ç»„ä»¶åº“</li>
<li>é…ç½®ä¸»é¢˜æ–‡ä»¶</li>
<li>å®‰è£… CSS é¢„å¤„ç†å™¨</li>
<li>å¼€å‘è¿‡ç¨‹ä¸­ä¸ vue3 å¼€å‘æ–‡æ¡£ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹</li>
<li>å¼€å‘è¿‡ç¨‹ä¸­å¸¸è§çš„é—®é¢˜</li>
<li><a href="https://github.com/MillyTang/ts-in-vue3-project">åœ¨é¡¹ç›®ä¸­å†™å‡ºå¯ç»´æŠ¤å¯æ‹“å±•çš„ç±»å‹</a></li>
</ol>
<blockquote>
<p>ç»“å°¾æä¾›äº†å…¶ä»–ç›¸å…³é“¾æ¥</p>
</blockquote>
<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><blockquote>
<p>ä½¿ç”¨ nvm åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ node æ¥é€‚ç”¨ä¸åŒé¡¹ç›®</p>
</blockquote>
<h3 id="å‘½ä»¤è¡Œä½¿ç”¨-vite-ç”Ÿæˆé¡¹ç›®æ¨¡æ¿"><a href="#å‘½ä»¤è¡Œä½¿ç”¨-vite-ç”Ÿæˆé¡¹ç›®æ¨¡æ¿" class="headerlink" title="å‘½ä»¤è¡Œä½¿ç”¨ vite ç”Ÿæˆé¡¹ç›®æ¨¡æ¿"></a>å‘½ä»¤è¡Œä½¿ç”¨ vite ç”Ÿæˆé¡¹ç›®æ¨¡æ¿</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line"><span class="comment"># v8.9.4</span></span><br><span class="line">nvm use 12</span><br><span class="line"><span class="comment"># Now using node v12.19.0 (npm v6.14.8)</span></span><br><span class="line">yarn create @vitejs/app</span><br><span class="line"><span class="comment"># é€‰æ‹© vue-ts é¢„è®¾æ¨¡æ¿</span></span><br><span class="line"><span class="built_in">cd</span> my-vue3-vite2-app</span><br><span class="line">yarn</span><br><span class="line">yarn dev</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®-TypeScript"><a href="#é…ç½®-TypeScript" class="headerlink" title="é…ç½® TypeScript"></a>é…ç½® TypeScript</h3><h4 id="tsconfig-json-æ–‡ä»¶-å¢åŠ -2-é¡¹é…ç½®"><a href="#tsconfig-json-æ–‡ä»¶-å¢åŠ -2-é¡¹é…ç½®" class="headerlink" title="tsconfig.json æ–‡ä»¶ å¢åŠ  2 é¡¹é…ç½®"></a>tsconfig.json æ–‡ä»¶ å¢åŠ  2 é¡¹é…ç½®</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;isolatedModules&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;types&quot;</span>: [<span class="string">&quot;vite/client&quot;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å®‰è£…-ts-ç±»å‹æ£€æŸ¥"><a href="#å®‰è£…-ts-ç±»å‹æ£€æŸ¥" class="headerlink" title="å®‰è£… ts ç±»å‹æ£€æŸ¥"></a>å®‰è£… ts ç±»å‹æ£€æŸ¥</h4><blockquote>
<p>æ‰“å¼€ vite.config.ts æ–‡ä»¶æ—¶ æ§åˆ¶å°å°±ä¼šæŠ¥ failed to load the eslint library for the vite.config.ts é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºæœ¬åœ° eslint æ— æ³•è§£æ ts æ–‡ä»¶ï¼Œéœ€è¦å®‰è£… ts ä¾èµ– &amp; vite ä¸æä¾› ts ç±»å‹æ£€æŸ¥</p>
</blockquote>
<ul>
<li>è¯¦è§<a href="https://github.com/typescript-eslint/typescript-eslint/blob/master/docs/getting-started/linting/README.md">typescript-eslint é…ç½®</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ts eslint ä¾èµ–</span></span><br><span class="line"><span class="comment"># node version &gt;= 12</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šä»¥ä¸‹åŒ…ä¸æä¾›å¯¹ *.vue æ–‡ä»¶çš„æ£€æŸ¥</span></span><br><span class="line">yarn add -D eslint typescript @typescript-eslint/parser @typescript-eslint/eslint-plugin</span><br><span class="line"><span class="comment"># å¦‚éœ€åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹ *.vue æ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œè¯·å¢åŠ ä»¥ä¸‹åŒ…æ”¯æŒ</span></span><br><span class="line"><span class="comment"># yarn add -D eslint-plugin-vue</span></span><br><span class="line"><span class="comment"># å®‰è£…nodeå˜é‡çš„ç±»å‹å£°æ˜</span></span><br><span class="line">npm i --save-dev @types/node</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸‹è½½é¢å¤–çš„<code>npm</code>åŒ…éœ€è¦æ·»åŠ å…¶ä»–ç±»å‹å®šä¹‰ï¼š1.å®‰è£…<code>npm i --save-dev @types/xxx</code>ï¼›2.åœ¨<code>tsconfig.json</code>ä¸­æ·»åŠ ``types`çš„é…ç½®ã€ <strong><em>ç”±äº vite2 åˆ›å»ºçš„ ts é¡¹ç›®ä¸­å·²æ·»åŠ é»˜è®¤çš„ types å®šä¹‰ï¼Œæ ‡æ˜åªä½¿ç”¨è¯¥ç±»å‹å®šä¹‰ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å…¶ä»–ç±»å‹ï¼ˆä¸åœ¨@vite/client ä¸­ï¼‰ï¼Œéœ€è¦å¢åŠ é…ç½®</em></strong> ã€</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="comment">// åœ¨ node åé¢å¢åŠ ä¸€é¡¹xxxå³å¯</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;types&quot;</span>: [<span class="string">&quot;vite/client&quot;</span>, <span class="string">&quot;node&quot;</span>, <span class="string">&quot;xxx&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœ¬é¡¹ç›®ä½¿ç”¨ eslint:recommended è§„èŒƒï¼Œå¦‚éœ€ä¿®æ”¹è¯·å‚ç…§ tslint å®˜æ–¹æç¤º</p>
</blockquote>
<ol>
<li><p>å·¥ä½œç›®å½•ä¸‹æ–°å¢ <code>.eslintrc.js</code> æ–‡ä»¶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸å«  eslint-plugin-vue æ’ä»¶çš„é…ç½®</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  root: <span class="literal">true</span>,</span><br><span class="line">  parser: <span class="string">&quot;@typescript-eslint/parser&quot;</span>,</span><br><span class="line">  plugins: [<span class="string">&quot;@typescript-eslint&quot;</span>],</span><br><span class="line">  <span class="keyword">extends</span>: [<span class="string">&quot;eslint:recommended&quot;</span>, <span class="string">&quot;plugin:@typescript-eslint/recommended&quot;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// åŒ…å«  eslint-plugin-vue æ’ä»¶çš„é…ç½®</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  root: <span class="literal">true</span>,</span><br><span class="line">  parser: <span class="string">&quot;vue-eslint-parser&quot;</span>,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    parser: <span class="string">&quot;@typescript-eslint/parser&quot;</span>,</span><br><span class="line">    ecmaVersion: <span class="number">2020</span>,</span><br><span class="line">    sourceType: <span class="string">&quot;module&quot;</span>,</span><br><span class="line">    ecmaFeatures: &#123;</span><br><span class="line">      jsx: <span class="literal">true</span>,</span><br><span class="line">      tsx: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [<span class="string">&quot;@typescript-eslint&quot;</span>],</span><br><span class="line">  <span class="keyword">extends</span>: [</span><br><span class="line">    <span class="string">&quot;plugin:vue/vue3-recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eslint:recommended&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plugin:@typescript-eslint/recommended&quot;</span>,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å·¥ä½œç›®å½•ä¸‹æ–°å¢ <code>.eslintignore</code> æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># don&#39;t ever lint node_modules</span><br><span class="line">node_modules</span><br><span class="line"># don&#39;t lint build output (make sure it&#39;s set to your correct build folder name)</span><br><span class="line">dist</span><br><span class="line"># don&#39;t lint nyc coverage output</span><br><span class="line">coverage</span><br><span class="line"># don&#39;t lint .vscode</span><br><span class="line">.vscode</span><br><span class="line"># don&#39;t lint .eslintrc.js</span><br><span class="line">.eslintrc.js</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="é…ç½®è¯·æ±‚-Axios-é›†ä¸­å¤„ç†è¯·æ±‚"><a href="#é…ç½®è¯·æ±‚-Axios-é›†ä¸­å¤„ç†è¯·æ±‚" class="headerlink" title="é…ç½®è¯·æ±‚ Axios é›†ä¸­å¤„ç†è¯·æ±‚"></a>é…ç½®è¯·æ±‚ Axios é›†ä¸­å¤„ç†è¯·æ±‚</h3><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server/index.ts æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; AxiosRequestConfig, Method &#125; <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&quot;qs&quot;</span>;</span><br><span class="line"><span class="comment">// è¯·æ±‚å¸¸é‡é…ç½®</span></span><br><span class="line"><span class="keyword">const</span> BASE_URL = <span class="keyword">import</span>.meta.env.VITE_APP_BASE_URL <span class="keyword">as</span> <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">const</span> SEUCCESS_CODE = [<span class="string">&quot;200&quot;</span>]; <span class="comment">// å¤šä¸ªcodeå¯å…¼å®¹å†å²apiçš„æˆåŠŸè¿”å›å€¼</span></span><br><span class="line"><span class="keyword">const</span> SPECIAL_CODE_403 = []; <span class="comment">// æ·»åŠ ä¸šåŠ¡è¦æ±‚çš„ æ— æƒé™çš„codeç </span></span><br><span class="line"><span class="keyword">const</span> LOGOUT_CODE = []; <span class="comment">// æ·»åŠ ä¸šåŠ¡è¦æ±‚ç™»å‡ºçš„codeç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> resType = <span class="string">&quot;json&quot;</span> | <span class="string">&quot;blob&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: BASE_URL,</span><br><span class="line">  timeout: <span class="number">30000</span>,</span><br><span class="line">  withCredentials: <span class="literal">true</span>, <span class="comment">// è¡¨ç¤ºè·¨åŸŸè¯·æ±‚æ—¶æ˜¯å¦éœ€è¦ä½¿ç”¨å‡­è¯</span></span><br><span class="line">  validateStatus: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt;= <span class="number">304</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  paramsSerializer: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> qs.stringify(params);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªåŸºæœ¬å‡½æ•°ï¼Œåç»­çš„ post &amp; getæ–¹æ³•éƒ½åŸºäºbaseFunc</span></span><br><span class="line"><span class="comment">// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨</span></span><br><span class="line">instance.interceptors.request.use(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚éœ€è‡ªå®šä¹‰config,å¯åœ¨è°ƒç”¨apiæ—¶ä¼ å…¥ï¼Œåœ¨æ­¤å¤„ä¿®æ”¹ã€å¢åŠ ã€è¦†ç›–</span></span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">      ...config,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        ...config.headers,</span><br><span class="line">        <span class="comment">// &#x27;X-TOKEN&#x27;: config.headers[&#x27;X-TOKEN&#x27;] || &#x27;default value or test token for testing&#x27; // è¯·æ±‚å¤´è‡ªå®šä¹‰token, é‡ç½® responseType || Content-Type</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> options;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å“åº”æ‹¦æˆªå™¨</span></span><br><span class="line">instance.interceptors.response.use(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; status, data &#125;: &#123; status: <span class="built_in">number</span>; data: <span class="built_in">any</span> &#125; = response;</span><br><span class="line">    <span class="comment">// ç‰¹æ®Šå¤„ç†è¿”å›ç±»å‹æ˜¯ blob ç±»å‹çš„è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">if</span> (status === <span class="number">200</span> &amp;&amp; response.config.responseType === <span class="string">&quot;blob&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; code &#125; = data;</span><br><span class="line">    <span class="keyword">if</span> (SEUCCESS_CODE.includes(code + <span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">      <span class="comment">// ç¬¦åˆè¯·æ±‚æˆåŠŸæ ‡å‡†</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(data.data || &#123;&#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (SPECIAL_CODE_403.includes(code + <span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">      <span class="comment">// 403éœ€è¦é‡æ–°æˆæƒ</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(data);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (LOGOUT_CODE.includes(code + <span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">      <span class="comment">// æ„å¤–ç™»å‡ºï¼Œé‡æ–°ç™»å½•</span></span><br><span class="line">      <span class="comment">// reLogin</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(data);</span><br><span class="line">      <span class="comment">// return Promise.resolve(data)</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// ç»Ÿä¸€å¼¹çª—æç¤ºé”™è¯¯</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(data);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// é›†ä¸­å¤„ç†è¶…æ—¶é”™è¯¯</span></span><br><span class="line">    <span class="comment">// æˆ–è€… ç»Ÿä¸€å‘ä¸ŠæŠ›å‡º</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// åŸºæœ¬é…ç½®</span></span><br><span class="line"><span class="comment">// è¿™é‡Œæœ‰2ç§æ–¹å¼å¯ä»¥è¿”å› ä½¿ç”¨apiæ—¶é…ç½®çš„è¿”å›ç±»å‹</span></span><br><span class="line"><span class="comment">// 1. ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹æ·»åŠ  Axios çš„ç±»å‹å£°æ˜ï¼Œæ”¹å†™è¿”å›ç±»å‹</span></span><br><span class="line"><span class="comment">// 2. å¼•å…¥Axiosæ˜¯ç‚¹å‡»æŸ¥çœ‹ Axios å®šä¹‰çš„ç±»å‹ï¼Œåœ¨ä½¿ç”¨ `instance.request` æ—¶æ”¹æˆè¿”å›ä¼ å…¥æ³›å‹å³å¯</span></span><br><span class="line"><span class="comment">// è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span>&lt;<span class="title">T</span>&gt;(<span class="params">method: Method, url: <span class="built_in">string</span>, config: AxiosRequestConfig</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>&lt;T&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    instance</span><br><span class="line">      .request&lt;T, T&gt;(&#123;</span><br><span class="line">        method: method,</span><br><span class="line">        url: url,</span><br><span class="line">        ...config,</span><br><span class="line">      &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(res);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åç»­æ ¹æ®å…·ä½“å‚æ•°ç±»å‹è¿”å›</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span>&lt;<span class="title">T</span>&gt;(<span class="params">url: <span class="built_in">string</span>, data?: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request&lt;T&gt;(<span class="string">&quot;PUT&quot;</span>, url, &#123; data &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">post</span>&lt;<span class="title">T</span>&gt;(<span class="params">url: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, responseType?: resType</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request&lt;T&gt;(<span class="string">&quot;POST&quot;</span>, url, &#123; data, responseType &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">del</span>&lt;<span class="title">T</span>&gt;(<span class="params">url: <span class="built_in">string</span>, data?: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request&lt;T&gt;(<span class="string">&quot;DELETE&quot;</span>, url, &#123; data &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>&lt;<span class="title">T</span>&gt;(<span class="params">url: <span class="built_in">string</span>, params?: <span class="built_in">any</span>, responseType?: resType</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request&lt;T&gt;(<span class="string">&quot;GET&quot;</span>, url, &#123; params, responseType &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨å®šä¹‰å¥½çš„-post-getç­‰æ–¹æ³•"><a href="#ä½¿ç”¨å®šä¹‰å¥½çš„-post-getç­‰æ–¹æ³•" class="headerlink" title="ä½¿ç”¨å®šä¹‰å¥½çš„ post, getç­‰æ–¹æ³•"></a>ä½¿ç”¨å®šä¹‰å¥½çš„ <code>post, get</code>ç­‰æ–¹æ³•</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const-api-path.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> POST_SOME_LIST = <span class="string">&quot;/path/to/some/list&quot;</span>;</span><br><span class="line"><span class="comment">// api.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; post, get &#125; <span class="keyword">from</span> <span class="string">&quot;./index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; POST_SOME_LIST &#125; <span class="keyword">from</span> <span class="string">&quot;./const-api-path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ListReturnType, ListParamType &#125; <span class="keyword">from</span> <span class="string">&quot;./api-types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getSomeList = <span class="function">(<span class="params">data: ListParamType</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> post&lt;ListReturnType&gt;(POST_SOME_LIST, data);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h3 id="åˆ†æ”¯ç®¡ç†ä¿æŠ¤ä¸è‡ªåŠ¨åŒ–"><a href="#åˆ†æ”¯ç®¡ç†ä¿æŠ¤ä¸è‡ªåŠ¨åŒ–" class="headerlink" title="åˆ†æ”¯ç®¡ç†ä¿æŠ¤ä¸è‡ªåŠ¨åŒ–"></a>åˆ†æ”¯ç®¡ç†ä¿æŠ¤ä¸è‡ªåŠ¨åŒ–</h3><blockquote>
<p>æµ‹è¯•ç¯å¢ƒçš„å‘å¸ƒåˆ†æ”¯åªæœ‰ 2 ä¸ªï¼š dev, hotfix</p>
</blockquote>
<h4 id="åˆ†æ”¯ç®¡ç†ã€ä¿æŠ¤çš„2ç§æ–¹å¼ï¼Œ1ä¸ªå¿…è¦"><a href="#åˆ†æ”¯ç®¡ç†ã€ä¿æŠ¤çš„2ç§æ–¹å¼ï¼Œ1ä¸ªå¿…è¦" class="headerlink" title="åˆ†æ”¯ç®¡ç†ã€ä¿æŠ¤çš„2ç§æ–¹å¼ï¼Œ1ä¸ªå¿…è¦"></a>åˆ†æ”¯ç®¡ç†ã€ä¿æŠ¤çš„2ç§æ–¹å¼ï¼Œ1ä¸ªå¿…è¦</h4><blockquote>
<p>åŸºç¡€ä»“åº“å½±å“èŒƒå›´è¾ƒå¤§ï¼Œåˆ†åˆ«å¯¹åº”å¤šä¸ªé¡¹ç›®çš„ä¸åŒé˜¶æ®µï¼Œåˆ™éœ€è¦å¯¹è¯¥é¡¹ç›®è¿›è¡Œåˆ†æ”¯ç®¡ç†å’Œä¿æŠ¤ï¼Œé€šå¸¸åªä¿æŠ¤3ä¸ªä¸»è¦åˆ†æ”¯ï¼š main, dev,hotfix</p>
</blockquote>
<h5 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h5><blockquote>
<p>ä¸€ä¸ªæ–°éœ€æ±‚çš„å…¨éƒ¨å·¥ä½œæµç¨‹</p>
</blockquote>
<ol>
<li>æ–°å»ºåŠŸèƒ½åˆ†æ”¯ï¼Œä»¥ <code>feature-</code> å¼€å¤´</li>
<li>åŠŸèƒ½å¼€å‘ç»“æŸç»™ <code>dev</code> æ <code>merge request</code></li>
<li>ä»£ç å®¡æ ¸ç»“æŸæˆåŠŸåˆå¹¶åˆ° <code>dev</code>åï¼Œå¼€å§‹æµ‹è¯•</li>
<li>é€šè¿‡æµ‹è¯•åæäº¤ <code>merge request</code> åˆ° <code>main</code>åˆ†æ”¯å‡†å¤‡å‘å¸ƒ</li>
<li>å‘å¸ƒæˆåŠŸä¸”çº¿ä¸ŠéªŒæ”¶æˆåŠŸåï¼Œåœ¨æœ€æ–°æäº¤ä¸Šæ‰“ <code>tag</code>, å¹¶æ¨é€ tags</li>
<li>ä¿ç•™è¯¥åŠŸèƒ½åˆ†æ”¯ 2 å‘¨åˆ é™¤è¯¥åˆ†æ”¯å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ï¼Œä»¥é˜²åç»­å¼€å‘åŠŸèƒ½åˆ†æ”¯è¶Šæ¥è¶Šå¤š</li>
</ol>
<blockquote>
<p>ä¸€ä¸ªç´§æ€¥ä¿®å¤çš„å…¨éƒ¨æµç¨‹</p>
</blockquote>
<ol>
<li><code>git checkout hotfix</code></li>
<li><code>git pull</code></li>
<li>å¼€å§‹ä¿®å¤ï¼Œä¿®å¤ç»“æŸåæäº¤ä»£ç å‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒæµ‹è¯•</li>
<li>é€šè¿‡æµ‹è¯•åæäº¤ mr åˆ° <code>main</code>åˆ†æ”¯å‡†å¤‡å‘å¸ƒ</li>
<li>å‘å¸ƒæˆåŠŸä¸”çº¿ä¸ŠéªŒæ”¶æˆåŠŸåï¼Œåœ¨æœ€æ–°æäº¤ä¸Šæ‰“ <code>tag</code>, å¹¶æ¨é€ tags</li>
</ol>
<h5 id="ç¬¬äºŒç§æ–¹å¼"><a href="#ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼"></a>ç¬¬äºŒç§æ–¹å¼</h5><blockquote>
<p>ä¸€ä¸ªä¸»ä»“åº“åˆ†åˆ«ç”±å„ä¸ªå¼€å‘forkåˆ°è‡ªå·±çš„group, ä¸»ä»“åº“åªä¿ç•™3ä¸ªåˆ†æ”¯ï¼šmain(ç¨³å®šç‰ˆæœ¬-çº¿ä¸Šç¯å¢ƒ), hotfix(ç´§æ€¥ä¿®å¤-å‘å¸ƒæµ‹è¯•ç¯å¢ƒ), dev(å¼€å‘æ—¶-å‘å¸ƒæµ‹è¯•ç¯å¢ƒ), forkä»“åº“å®Œå…¨ç”±å¼€å‘è€…è‡ªè¡Œç®¡ç†</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># forkåçš„é¡¹ç›®æ–°å¢ä¸€ä¸ª remote</span></span><br><span class="line">git remote add source-hub-name source-hub-ssh-path-or-https-path</span><br><span class="line"><span class="comment"># æ‹‰å– ä¸»ä»“åº“æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git fetch source-hub-name</span><br><span class="line"><span class="comment"># å»ºç«‹å¼€å‘è¿›åº¦å¯¹åº”åˆ†æ”¯</span></span><br><span class="line">git checkout -b dev-source-hub-name</span><br><span class="line"><span class="comment"># æ‹‰å– ä¸»ä»“åº“ dev åˆ†æ”¯æ‰€æœ‰commit</span></span><br><span class="line">git pull source-hub-name dev</span><br><span class="line"><span class="comment"># å›åˆ°devåˆ†æ”¯ï¼Œåˆå¹¶ä¸»ä»“åº“è¿›åº¦</span></span><br><span class="line">git checkout dev</span><br><span class="line"><span class="comment"># æˆ–è€…ä»…pickéƒ¨åˆ†æäº¤</span></span><br><span class="line">git merge dev-source-hub-name</span><br></pre></td></tr></table></figure>

<h2 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h2><h3 id="é…ç½®ç¯å¢ƒæ–‡ä»¶"><a href="#é…ç½®ç¯å¢ƒæ–‡ä»¶" class="headerlink" title="é…ç½®ç¯å¢ƒæ–‡ä»¶"></a>é…ç½®ç¯å¢ƒæ–‡ä»¶</h3><ul>
<li>æ„å»ºåŒ…æ–‡ä»¶ä¼šé€šè¿‡ç¯å¢ƒæ–‡ä»¶æ¥ç¡®å®šç¯å¢ƒå˜é‡ï¼Œåœ¨é¡¹ç›®ä¸‹æ–°å¢:<ul>
<li><code>.env.production</code>æ–‡ä»¶</li>
<li><code>.env.development</code>æ–‡ä»¶</li>
<li><code>.env.stagging</code>æ–‡ä»¶</li>
</ul>
</li>
</ul>
<h3 id="é…ç½®åˆ«åã€å¯é€‰ã€‘"><a href="#é…ç½®åˆ«åã€å¯é€‰ã€‘" class="headerlink" title="é…ç½®åˆ«åã€å¯é€‰ã€‘"></a>é…ç½®åˆ«åã€å¯é€‰ã€‘</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  plugins: [vue()],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&quot;@&quot;</span>: path.resolve(__dirname, <span class="string">&quot;./src&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®è·¯ç”±"><a href="#é…ç½®è·¯ç”±" class="headerlink" title="é…ç½®è·¯ç”±"></a>é…ç½®è·¯ç”±</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add vue-router@4</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> HelloWorld <span class="keyword">from</span> <span class="string">&quot;@/components/hello-world.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory, RouteRecordRaw &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±æ‡’åŠ è½½</span></span><br><span class="line"><span class="keyword">const</span> About = <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../components/about.vue&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> routes: RouteRecordRaw[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    component: HelloWorld, <span class="comment">// éæ‡’åŠ è½½</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">    component: About,</span><br><span class="line">    <span class="comment">// metaç±»å‹éœ€è¦é¢å¤–å£°æ˜ï¼Œæ­¤å£°æ˜åœ¨ src/typings/augmenation.d.tså†…</span></span><br><span class="line">    meta: &#123;</span><br><span class="line">      isAdmin: <span class="literal">false</span>,</span><br><span class="line">      title: <span class="string">&quot;å…³äº&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> router = createRouter(&#123;</span><br><span class="line">  history: createWebHashHistory(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ é¢å¤–çš„-meta-å­—æ®µçš„ç±»å‹å£°æ˜"><a href="#æ·»åŠ é¢å¤–çš„-meta-å­—æ®µçš„ç±»å‹å£°æ˜" class="headerlink" title="æ·»åŠ é¢å¤–çš„ meta å­—æ®µçš„ç±»å‹å£°æ˜"></a>æ·»åŠ é¢å¤–çš„ meta å­—æ®µçš„ç±»å‹å£°æ˜</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// augmenation.d.ts</span></span><br><span class="line"><span class="comment">// Ensure this file is parsed as a module regardless of dependencies.</span></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> &quot;vue-router&quot; &#123;</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰å…ƒå­—æ®µå£°æ˜</span></span><br><span class="line">  <span class="keyword">interface</span> RouteMeta &#123;</span><br><span class="line">    <span class="comment">// is optional</span></span><br><span class="line">    isAdmin?: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="comment">// is optional</span></span><br><span class="line">    requiresAuth?: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="comment">// must be declared by every route</span></span><br><span class="line">    title: <span class="built_in">string</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ è·¯ç”±å…ƒä¿¡æ¯å£°æ˜"><a href="#æ·»åŠ è·¯ç”±å…ƒä¿¡æ¯å£°æ˜" class="headerlink" title="æ·»åŠ è·¯ç”±å…ƒä¿¡æ¯å£°æ˜"></a>æ·»åŠ è·¯ç”±å…ƒä¿¡æ¯å£°æ˜</h4><h3 id="é€‰æ‹©ç»„ä»¶åº“-â˜-æœ¬é¡¹ç›®ä½¿ç”¨-ant-design-vue-æ‰€ä»¥é€‰ç”¨-less-æ–¹ä¾¿è¦†ç›–é»˜è®¤ä¸»é¢˜"><a href="#é€‰æ‹©ç»„ä»¶åº“-â˜-æœ¬é¡¹ç›®ä½¿ç”¨-ant-design-vue-æ‰€ä»¥é€‰ç”¨-less-æ–¹ä¾¿è¦†ç›–é»˜è®¤ä¸»é¢˜" class="headerlink" title="é€‰æ‹©ç»„ä»¶åº“ â˜ æœ¬é¡¹ç›®ä½¿ç”¨ ant-design-vue, æ‰€ä»¥é€‰ç”¨ less, æ–¹ä¾¿è¦†ç›–é»˜è®¤ä¸»é¢˜"></a>é€‰æ‹©ç»„ä»¶åº“ â˜ æœ¬é¡¹ç›®ä½¿ç”¨ <code>ant-design-vue</code>, æ‰€ä»¥é€‰ç”¨ less, æ–¹ä¾¿è¦†ç›–é»˜è®¤ä¸»é¢˜</h3><h4 id="é…ç½®ä¸»é¢˜æ–‡ä»¶"><a href="#é…ç½®ä¸»é¢˜æ–‡ä»¶" class="headerlink" title="é…ç½®ä¸»é¢˜æ–‡ä»¶"></a>é…ç½®ä¸»é¢˜æ–‡ä»¶</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ’ä»¶è½¬æ¢æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> lessToJS <span class="keyword">from</span> <span class="string">&#x27;less-vars-to-js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> themeVariables = lessToJS(</span><br><span class="line">  fs.readFileSync(path.resolve(__dirname, <span class="string">&#x27;./src/styles/variable.less&#x27;</span>), <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="comment">// vite.config.js</span></span><br><span class="line">&#123;</span><br><span class="line">  css: &#123;</span><br><span class="line">    preprocessorOptions: &#123;</span><br><span class="line">      <span class="comment">// åœ¨è¿™é‡Œè¦†ç›–csså…¨å±€å˜é‡, å¯è¦†ç›–å˜é‡å¯åœ¨varible.lessä¸­æŸ¥çœ‹</span></span><br><span class="line">      less: &#123;</span><br><span class="line">        modifyVars: themeVariables,</span><br><span class="line">        javascriptEnabled: <span class="literal">true</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…-CSS-é¢„å¤„ç†å™¨"><a href="#å®‰è£…-CSS-é¢„å¤„ç†å™¨" class="headerlink" title="å®‰è£… CSS é¢„å¤„ç†å™¨"></a>å®‰è£… CSS é¢„å¤„ç†å™¨</h3><blockquote>
<p>è¯·åŒ¹é… ç»„ä»¶åº“ çš„é€‰æ‹©</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .scss and .sass</span></span><br><span class="line">npm install -D sass</span><br><span class="line"><span class="comment"># .less</span></span><br><span class="line">npm install -D less</span><br><span class="line"><span class="comment"># .styl and .stylus</span></span><br><span class="line">npm install -D stylus</span><br></pre></td></tr></table></figure>

<h4 id="æ›¿æ¢-moment-ä¸º-dayjs"><a href="#æ›¿æ¢-moment-ä¸º-dayjs" class="headerlink" title="æ›¿æ¢ moment ä¸º dayjs"></a>æ›¿æ¢ moment ä¸º dayjs</h4><ol>
<li><p><code>yarn add dayjs</code> or <code>npm i dayjs</code></p>
</li>
<li><p>åœ¨ <code>vite.config</code>ä¸­æ·»åŠ  alias</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      moment: <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <code>main.ts</code>æ–‡ä»¶é‡Œæ·»åŠ ç›¸å…³æ’ä»¶, æ·»åŠ å‰ååˆ†åˆ«æ‰“åŒ…è¿›è¡Œæ¯”è¾ƒ</p>
</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&quot;dayjs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> isSameOrBefore <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/isSameOrBefore&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> isSameOrAfter <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/isSameOrAfter&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> advancedFormat <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/advancedFormat&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> customParseFormat <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/customParseFormat&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> weekday <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/weekday&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> weekOfYear <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/weekOfYear&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> isMoment <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/isMoment&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> localeData <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/localeData&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> localizedFormat <span class="keyword">from</span> <span class="string">&quot;dayjs/plugin/localizedFormat&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;dayjs/locale/zh-cn&quot;</span>; <span class="comment">// å¯¼å…¥æœ¬åœ°åŒ–è¯­è¨€</span></span><br><span class="line"></span><br><span class="line">dayjs.extend(isSameOrBefore);</span><br><span class="line">dayjs.extend(isSameOrAfter);</span><br><span class="line">dayjs.extend(advancedFormat);</span><br><span class="line">dayjs.extend(customParseFormat);</span><br><span class="line">dayjs.extend(weekday);</span><br><span class="line">dayjs.extend(weekOfYear);</span><br><span class="line">dayjs.extend(isMoment);</span><br><span class="line">dayjs.extend(localeData);</span><br><span class="line">dayjs.extend(localizedFormat);</span><br><span class="line">dayjs.locale(<span class="string">&quot;zh-cn&quot;</span>); <span class="comment">// ä½¿ç”¨æœ¬åœ°åŒ–è¯­è¨€</span></span><br></pre></td></tr></table></figure>

<h2 id="å¼€å‘è¿‡ç¨‹ä¸­ä¸-vue3-å¼€å‘æ–‡æ¡£ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹"><a href="#å¼€å‘è¿‡ç¨‹ä¸­ä¸-vue3-å¼€å‘æ–‡æ¡£ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹" class="headerlink" title="å¼€å‘è¿‡ç¨‹ä¸­ä¸ vue3 å¼€å‘æ–‡æ¡£ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹"></a>å¼€å‘è¿‡ç¨‹ä¸­ä¸ vue3 å¼€å‘æ–‡æ¡£ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹</h2><h3 id="å“åº”å¼-API"><a href="#å“åº”å¼-API" class="headerlink" title="å“åº”å¼ API"></a>å“åº”å¼ API</h3><ul>
<li><code>reaÃ¥ctive()</code>: è¿”å›å¯¹è±¡çš„å“åº”å¼å‰¯æœ¬</li>
</ul>
<h3 id="SetUp-amp-ref-unRef-amp-toRefs"><a href="#SetUp-amp-ref-unRef-amp-toRefs" class="headerlink" title="SetUp &amp; ref() || unRef() &amp; toRefs()"></a>SetUp &amp; ref() || unRef() &amp; toRefs()</h3><p><strong><em>SetUp(props, context)</em></strong> é€»è¾‘å—ç»„åˆï¼Œå¯ç»„åˆ:<code>ç”Ÿå‘½å‘¨æœŸå‡½æ•°/watch/computed</code>ï¼Œè¿”å›<strong>å¯¹è±¡</strong>ï¼Œå¯¹è±¡å¯åŒ…å« <code>data/methods/computed</code></p>
<h4 id="ç”Ÿå‘½å‘¨æœŸæ˜ å°„å…³ç³»"><a href="#ç”Ÿå‘½å‘¨æœŸæ˜ å°„å…³ç³»" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸæ˜ å°„å…³ç³»"></a>ç”Ÿå‘½å‘¨æœŸæ˜ å°„å…³ç³»</h4><ul>
<li><del><code>beforeCreate</code></del> -&gt; use <code>setup()</code></li>
<li><del><code>created</code></del> -&gt; use <code>setup()</code></li>
<li><code>beforeMount</code> -&gt; <code>onBeforeMount</code></li>
<li><code>mounted</code> -&gt; <code>onMounted</code></li>
<li><code>beforeUpdate</code> -&gt; <code>onBeforeUpdate</code></li>
<li><code>updated</code> -&gt; <code>onUpdated</code></li>
<li><code>beforeUnmount</code> -&gt; <code>onBeforeUnmount</code></li>
<li><code>unmounted</code> -&gt; <code>onUnmounted</code></li>
<li><code>errorCaptured</code> -&gt; <code>onErrorCaptured</code></li>
<li><code>renderTracked</code> -&gt; <code>onRenderTracked</code></li>
<li><code>renderTriggered</code> -&gt; <code>onRenderTriggered</code></li>
</ul>
<blockquote>
<p>ç”±äº <code>props</code> æ˜¯å“åº”å¼çš„ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨<code>ES6è§£æ„</code>ï¼Œå› ä¸º <strong><em>è§£æ„æ˜¯æµ…å¤åˆ¶ï¼Œéå¼•ç”¨ç±»å‹å±æ€§æ‹·è´åä¼šè·ŸåŸ prop å±æ€§è„±ç¦»ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæ²¡æœ‰å“åº”æ€§ï¼Œå¼•ç”¨ç±»å‹çš„å±æ€§ï¼ˆæ•°ç»„ï¼Œå¯¹è±¡ï¼Œå‡½æ•°ï¼‰è¿˜ä¼šä¿æŒå¼•ç”¨ï¼Œè¿™ 2 ç§æƒ…å†µä¸‹è§£æ„åçš„å˜é‡å“åº”æ€§ä¸ç»Ÿä¸€</em></strong> æ‰€ä»¥ä¼šæ¶ˆé™¤ prop çš„å“åº”æ€§ï¼Œå¦‚æœéœ€è¦è§£æ„ prop,ä½¿ç”¨ <code>toRefs</code></p>
</blockquote>
<blockquote>
<p>è‹¥è¦è·å–ä¼ é€’ç»™ setup() çš„å‚æ•°çš„ç±»å‹æ¨æ–­ï¼Œè¯·ä½¿ç”¨ <code>defineComponent</code></p>
</blockquote>
<h4 id="åœ¨-Setup-ä¸­ä½¿ç”¨-Router"><a href="#åœ¨-Setup-ä¸­ä½¿ç”¨-Router" class="headerlink" title="åœ¨ Setup ä¸­ä½¿ç”¨ Router"></a>åœ¨ Setup ä¸­ä½¿ç”¨ Router</h4><blockquote>
<p>è¯·ä½¿ç”¨<code>useRouter()</code> || <code>useRoute()</code>, æ¨¡æ¿ä¸­å¯ä»¥è®¿é—® <code>$router</code> å’Œ <code>$route</code>ï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨ setup ä¸­è¿”å› <code>router</code> æˆ– <code>route</code></p>
</blockquote>
<ul>
<li><code>userLink &amp; RouterLink</code>: å†…éƒ¨è¡Œä¸ºå·²ç»ä½œä¸ºä¸€ä¸ªç»„åˆå¼ API å‡½æ•°å…¬å¼€</li>
</ul>
<h3 id="ts-ç›¸å…³"><a href="#ts-ç›¸å…³" class="headerlink" title="ts ç›¸å…³"></a>ts ç›¸å…³</h3><ul>
<li><code>setup()</code> å‡½æ•°ä¸­ï¼Œä¸éœ€è¦å°†ç±»å‹ä¼ é€’ç»™ props å‚æ•°ï¼Œå› ä¸ºå®ƒå°†ä» props ç»„ä»¶é€‰é¡¹æ¨æ–­ç±»å‹</li>
<li><code>refs()</code> 1.åˆå§‹å€¼æ¨æ–­ç±»å‹;2.ä¼ é€’ä¸€ä¸ªæ³›å‹å‚æ•°;3. ä½¿ç”¨<code>Ref&lt;T&gt;</code>æ›¿ä»£<code>ref</code></li>
<li><code>readtive()</code> ä½¿ç”¨æ¥å£(<code>Interface</code>)</li>
<li><code>computed</code>è‡ªåŠ¨æ¨æ–­</li>
</ul>
<h4 id="ä¸-Options-api-ä¸€èµ·ä½¿ç”¨"><a href="#ä¸-Options-api-ä¸€èµ·ä½¿ç”¨" class="headerlink" title="ä¸ Options api ä¸€èµ·ä½¿ç”¨"></a>ä¸ Options api ä¸€èµ·ä½¿ç”¨</h4><ul>
<li>å¤æ‚çš„ç±»å‹æˆ–æ¥å£ä½¿ç”¨ <strong>as</strong> å¼ºåˆ¶è½¬æ¢</li>
</ul>
<h4 id="æ³¨è§£è¿”å›ç±»å‹"><a href="#æ³¨è§£è¿”å›ç±»å‹" class="headerlink" title="æ³¨è§£è¿”å›ç±»å‹"></a>æ³¨è§£è¿”å›ç±»å‹</h4><ul>
<li>computed çš„ç±»å‹éš¾ä»¥æ¨æ–­ éœ€è¦æ³¨è§£</li>
</ul>
<h4 id="æ³¨è§£-props"><a href="#æ³¨è§£-props" class="headerlink" title="æ³¨è§£ props"></a>æ³¨è§£ props</h4><ul>
<li>ä½¿ç”¨ PropType å¼ºåˆ¶è½¬æ¢æ„é€ å‡½æ•°</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent, PropType &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œæ˜¯æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯type</span></span><br><span class="line"><span class="keyword">interface</span> Book &#123;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  author: <span class="built_in">string</span>;</span><br><span class="line">  year: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Component = defineComponent(&#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    success: &#123; <span class="keyword">type</span>: <span class="built_in">String</span> &#125;,</span><br><span class="line">    callback: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">Function</span> <span class="keyword">as</span> PropType&lt;<span class="function">() =&gt;</span> <span class="built_in">void</span>&gt;,</span><br><span class="line">    &#125;,</span><br><span class="line">    book: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">Object</span> <span class="keyword">as</span> PropType&lt;Book&gt;,</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>ç”±äº ts çš„è®¾è®¡é™åˆ¶ï¼šæ¶‰åŠåˆ°ä¸ºäº†å¯¹å‡½æ•°è¡¨è¾¾å¼è¿›è¡Œç±»å‹æ¨ç†ï¼Œä½ å¿…é¡»æ³¨æ„Â·å¯¹è±¡å’Œæ•°ç»„çš„<code>validators</code> å’Œ <code>default</code> å€¼</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent, PropType &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Book &#123;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  year?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Component = defineComponent(&#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    bookA: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">Object</span> <span class="keyword">as</span> PropType&lt;Book&gt;,</span><br><span class="line">      <span class="comment">// è¯·åŠ¡å¿…ä½¿ç”¨ç®­å¤´å‡½æ•°</span></span><br><span class="line">      <span class="keyword">default</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        title: <span class="string">&quot;Arrow Function Expression&quot;</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      validator: <span class="function">(<span class="params">book: Book</span>) =&gt;</span> !!book.title,</span><br><span class="line">    &#125;,</span><br><span class="line">    bookB: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">Object</span> <span class="keyword">as</span> PropType&lt;Book&gt;,</span><br><span class="line">      <span class="comment">// æˆ–è€…æä¾›ä¸€ä¸ªæ˜ç¡®çš„ this å‚æ•°</span></span><br><span class="line">      <span class="keyword">default</span>(<span class="built_in">this</span>: <span class="built_in">void</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          title: <span class="string">&quot;Function Expression&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">      validator(<span class="built_in">this</span>: <span class="built_in">void</span>, book: Book) &#123;</span><br><span class="line">        <span class="keyword">return</span> !!book.title;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æ³¨è§£-emit"><a href="#æ³¨è§£-emit" class="headerlink" title="æ³¨è§£ emit"></a>æ³¨è§£ emit</h4><ul>
<li>ä¸ºè§¦å‘çš„äº‹ä»¶æ³¨è§£ä¸€ä¸ªæœ‰æ•ˆè½½è·ã€‚å¦å¤–ï¼Œæ‰€æœ‰æœªå£°æ˜çš„è§¦å‘äº‹ä»¶åœ¨è°ƒç”¨æ—¶éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç±»å‹é”™è¯¯ã€‚</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Component = defineComponent(&#123;</span><br><span class="line">  emits: &#123;</span><br><span class="line">    addBook(payload: &#123; bookName: <span class="built_in">string</span> &#125;) &#123;</span><br><span class="line">      <span class="comment">// perform runtime éªŒè¯</span></span><br><span class="line">      <span class="keyword">return</span> payload.bookName.length &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&quot;addBook&quot;</span>, &#123;</span><br><span class="line">        bookName: <span class="number">123</span>, <span class="comment">// ç±»å‹é”™è¯¯ï¼</span></span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&quot;non-declared-event&quot;</span>); <span class="comment">// ç±»å‹é”™è¯¯ï¼</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="ç±»å‹å£°æ˜-refs"><a href="#ç±»å‹å£°æ˜-refs" class="headerlink" title="ç±»å‹å£°æ˜ refs"></a>ç±»å‹å£°æ˜ refs</h4><ul>
<li>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸º ref çš„å†…éƒ¨å€¼æŒ‡å®šå¤æ‚ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨ ref é‡å†™é»˜è®¤æ¨ç†æ—¶ç®€å•åœ°ä¼ é€’ä¸€ä¸ªæ³›å‹å‚æ•°</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> year = ref&lt;<span class="built_in">string</span> | <span class="built_in">number</span>&gt;(<span class="string">&quot;2020&quot;</span>); <span class="comment">// year&#x27;s type: Ref&lt;string | number&gt;</span></span><br><span class="line">year.value = <span class="number">2020</span>; <span class="comment">// ok!</span></span><br><span class="line"><span class="comment">// å¦‚æœæ³›å‹çš„ç±»å‹æœªçŸ¥ï¼Œå»ºè®®å°† ref è½¬æ¢ä¸º Ref&lt;T&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ç±»å‹å£°æ˜-reactive"><a href="#ç±»å‹å£°æ˜-reactive" class="headerlink" title="ç±»å‹å£°æ˜ reactive"></a>ç±»å‹å£°æ˜ reactive</h4><blockquote>
<p>ä¸ <code>ref</code> çš„åŒºåˆ«ï¼š å½“å˜é‡åŸºç¡€ç±»å‹æ—¶ä½¿ç”¨<code>ref</code>, å¼•ç”¨ç±»å‹-å¯¹è±¡/æ•°ç»„ç­‰ä½¿ç”¨ <code>reactive</code></p>
</blockquote>
<ul>
<li>å½“å£°æ˜ç±»å‹ reactive propertyï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Book &#123;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  year?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  name: <span class="string">&quot;HelloWorld&quot;</span>,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    <span class="keyword">const</span> book = reactive&lt;Book&gt;(&#123; title: <span class="string">&quot;Vue 3 Guide&quot;</span> &#125;);</span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    <span class="keyword">const</span> book: Book = reactive(&#123; title: <span class="string">&quot;Vue 3 Guide&quot;</span> &#125;);</span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    <span class="keyword">const</span> book = reactive(&#123; title: <span class="string">&quot;Vue 3 Guide&quot;</span> &#125;) <span class="keyword">as</span> Book;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜-TroubleShooting"><a href="#å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜-TroubleShooting" class="headerlink" title="å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜[TroubleShooting]"></a>å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜[TroubleShooting]</h3><h4 id="æ³¨æ„ï¼švite2-è‡ªåŠ¨æ„å»º-typescript-æ¨¡æ¿é¡¹ç›®æ–‡ä»¶ï¼Œéƒ¨åˆ†åŒå­¦ä¼šåœ¨-build-é˜¶æ®µæŠ¥é”™ï¼Œè¯¦æƒ…è¯·ç§»æ­¥"><a href="#æ³¨æ„ï¼švite2-è‡ªåŠ¨æ„å»º-typescript-æ¨¡æ¿é¡¹ç›®æ–‡ä»¶ï¼Œéƒ¨åˆ†åŒå­¦ä¼šåœ¨-build-é˜¶æ®µæŠ¥é”™ï¼Œè¯¦æƒ…è¯·ç§»æ­¥" class="headerlink" title="æ³¨æ„ï¼švite2 è‡ªåŠ¨æ„å»º typescript æ¨¡æ¿é¡¹ç›®æ–‡ä»¶ï¼Œéƒ¨åˆ†åŒå­¦ä¼šåœ¨ build é˜¶æ®µæŠ¥é”™ï¼Œè¯¦æƒ…è¯·ç§»æ­¥"></a>æ³¨æ„ï¼švite2 è‡ªåŠ¨æ„å»º typescript æ¨¡æ¿é¡¹ç›®æ–‡ä»¶ï¼Œéƒ¨åˆ†åŒå­¦ä¼šåœ¨ build é˜¶æ®µæŠ¥é”™ï¼Œè¯¦æƒ…è¯·ç§»æ­¥</h4><ul>
<li><a href="https://github.com/znck/vue-developer-experience/issues/208">error VueDX/TS: context.imports.add is not a function</a></li>
<li><a href="https://github.com/znck/vue-developer-experience/issues/144">@vuedx/typecheck vite build error with <code>const FSP = require(&#39;fs/promises&#39;);</code></a></li>
</ul>
<blockquote>
<p>windows ç³»ç»Ÿçš„åŒå­¦å¯å°† build æ‰“åŒ…å‘½ä»¤ç”±<code>vuedx-typecheck . &amp;&amp; vite build</code> æ”¹ä¸º <code>vite build &amp;&amp; tsc</code>,ci è„šæœ¬å†…åŠ ä¸€æ¡ï¼š<code>run: npx --no-install vuedx-typecheck</code></p>
</blockquote>
<h4 id="åœ¨tsæ–‡ä»¶å†…ä½¿ç”¨-const-xxx-require-39-xxx-39-æŠ¥é”™ï¼šrequire-is-not-defined"><a href="#åœ¨tsæ–‡ä»¶å†…ä½¿ç”¨-const-xxx-require-39-xxx-39-æŠ¥é”™ï¼šrequire-is-not-defined" class="headerlink" title="åœ¨tsæ–‡ä»¶å†…ä½¿ç”¨ const xxx = require(&#39;xxx&#39;)æŠ¥é”™ï¼šrequire is not defined"></a>åœ¨<code>ts</code>æ–‡ä»¶å†…ä½¿ç”¨ <code>const xxx = require(&#39;xxx&#39;)</code>æŠ¥é”™ï¼š<code>require is not defined</code></h4><blockquote>
<p>å·²è§£å†³: <code>vite@2.4.1</code>å·²ä¿®å¤è¯¥é”™è¯¯ï¼Œå‡çº§å³å¯</p>
</blockquote>
<ul>
<li><a href="https://github.com/vitejs/vite/issues/2161">Error: require is mot defined</a></li>
</ul>
<h4 id="UI-ç»„ä»¶çš„é—®é¢˜"><a href="#UI-ç»„ä»¶çš„é—®é¢˜" class="headerlink" title="UI ç»„ä»¶çš„é—®é¢˜"></a>UI ç»„ä»¶çš„é—®é¢˜</h4><ul>
<li><p>ant-design-vue æŒ‰éœ€åŠ è½½é—®é¢˜:<br>æŸ¥çœ‹<a href="https://github.com/vueComponent/ant-design-vue/issues/3570">Imports using @ant-design/icons-vue should be importing the ESM version</a></p>
</li>
<li><p>and-design-vue ç‰ˆæœ¬é—®é¢˜ï¼ï¼ï¼ç°å‘ç° <code>form &amp; input</code>ç»„ä»¶åœ¨å¼•å…¥ es åŒ…æ—¶ä¸€ç›´æŠ¥é”™<code>The requesed module &#39;/node_modules/is-mobile/index.js&#39; is dose not provide an export named &#39;isMobile&#39;</code>ï¼Œé‚å‡çº§è‡³ 2.1.1 ç‰ˆæœ¬ï¼ŒåŒæ—¶åˆ é™¤ vite.config é‡Œ optimizeDeps çš„ exclude çš„é…ç½®,æ‰èƒ½ä½¿ç”¨:<br>è¯¦è§<a href="https://github.com/vueComponent/ant-design-vue/issues/1936">ç»„ä»¶åº“ä¾èµ–çš„ ismobilejs å­˜åœ¨å…¼å®¹æ€§é—®é¢˜</a></p>
</li>
<li><p>Element-plus åŒ…é—®é¢˜:<br>æŸ¥çœ‹<a href="https://github.com/element-plus/element-plus/issues/1632">element plus issues: [Bug Report] error: [ vite:dep-scan ] Failed to resolve entry for package â€œelement-plusâ€. The package may have incorrect main/module/exports specified in its package.json</a></p>
</li>
</ul>
<h3 id="ä¾èµ–å¼ºç¼“å­˜"><a href="#ä¾èµ–å¼ºç¼“å­˜" class="headerlink" title="ä¾èµ–å¼ºç¼“å­˜"></a>ä¾èµ–å¼ºç¼“å­˜</h3><ul>
<li>é€šè¿‡æµè§ˆå™¨ devtools çš„ Network é€‰é¡¹å¡æš‚æ—¶ç¦ç”¨ç¼“å­˜ï¼›</li>
<li>é‡å¯ Vite dev serverï¼Œä½¿ç”¨ â€“force æ ‡å¿—é‡æ–°æ‰“åŒ…ä¾èµ–ï¼›</li>
<li>é‡æ–°è½½å…¥é¡µé¢ã€‚</li>
</ul>
<h2 id="esbuild-é¢„æ„å»º"><a href="#esbuild-é¢„æ„å»º" class="headerlink" title="esbuild é¢„æ„å»º"></a>esbuild é¢„æ„å»º</h2><h2 id="ç›¸å…³æ–‡æ¡£é“¾æ¥"><a href="#ç›¸å…³æ–‡æ¡£é“¾æ¥" class="headerlink" title="ç›¸å…³æ–‡æ¡£é“¾æ¥"></a>ç›¸å…³æ–‡æ¡£é“¾æ¥</h2><ul>
<li><a href="https://github.com/typescript-eslint/typescript-eslint/blob/master/docs/getting-started/linting/README.md">tslint é…ç½®</a></li>
<li><a target="_blank" rel="noopener" href="https://esbuild.github.io/getting-started/#bundling-for-the-browser">esbuild</a></li>
<li><a target="_blank" rel="noopener" href="https://cn.vitejs.dev/guide/">vite</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/01/18/security-cryptography/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/18/security-cryptography/" class="post-title-link" itemprop="url">Security & Cryptography</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-01-18 13:54:14" itemprop="dateCreated datePublished" datetime="2021-01-18T13:54:14+08:00">2021-01-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-14 13:07:37" itemprop="dateModified" datetime="2021-02-14T13:07:37+08:00">2021-02-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ç†µ(Entropy), å•ä½ï¼šbit, ä¿¡æ¯ç†µçš„è®¡ç®—å…¬å¼ï¼šH(X)= -</p>
</blockquote>
<h2 id="æ•£åˆ—å‡½æ•°"><a href="#æ•£åˆ—å‡½æ•°" class="headerlink" title="æ•£åˆ—å‡½æ•°"></a>æ•£åˆ—å‡½æ•°</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span>(value: array&lt;byte&gt;) -&gt; vector&lt;byte, N&gt; (Nå¯¹äºè¯¥å‡½æ•°å›ºå®š)</span><br></pre></td></tr></table></figure>

<h2 id="SHA-1-git-ä¸­ä½¿ç”¨çš„"><a href="#SHA-1-git-ä¸­ä½¿ç”¨çš„" class="headerlink" title="SHA-1,git ä¸­ä½¿ç”¨çš„"></a>SHA-1,git ä¸­ä½¿ç”¨çš„</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2021/01/10/command-line/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/10/command-line/" class="post-title-link" itemprop="url">å‘½ä»¤è¡Œç¯å¢ƒ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-01-10 15:41:14" itemprop="dateCreated datePublished" datetime="2021-01-10T15:41:14+08:00">2021-01-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-07 17:53:24" itemprop="dateModified" datetime="2021-04-07T17:53:24+08:00">2021-04-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Vimã€Œä½œä¸ºç¼–è¾‘å™¨çš„ä½¿ç”¨åŠŸèƒ½ã€"><a href="#Vimã€Œä½œä¸ºç¼–è¾‘å™¨çš„ä½¿ç”¨åŠŸèƒ½ã€" class="headerlink" title="Vimã€Œä½œä¸ºç¼–è¾‘å™¨çš„ä½¿ç”¨åŠŸèƒ½ã€"></a>Vimã€Œä½œä¸ºç¼–è¾‘å™¨çš„ä½¿ç”¨åŠŸèƒ½ã€</h2><h3 id="ç¼–è¾‘æ¨¡å¼"><a href="#ç¼–è¾‘æ¨¡å¼" class="headerlink" title="ç¼–è¾‘æ¨¡å¼"></a>ç¼–è¾‘æ¨¡å¼</h3><ol>
<li><p>æ­£å¸¸ï¼šç§»åŠ¨å…‰æ ‡ä¿®æ”¹</p>
</li>
<li><p>æ’å…¥æ–‡æœ¬ï¼š é”®å…¥ <strong><em>i</em></strong> è¿›å…¥æ’å…¥æ¨¡å¼</p>
</li>
<li><p>æ›¿æ¢æ–‡æœ¬ï¼šé”®å…¥ <strong><em>R</em></strong> è¿›å…¥æ›¿æ¢æ¨¡å¼</p>
</li>
<li><p>å¯è§†åŒ–ï¼š é€‰ä¸­æ–‡æœ¬å—ï¼Œé”®å…¥ <strong><em>v</em></strong> è¿›å…¥å¯è§†åŒ–ä¸€èˆ¬æ¨¡å¼ï¼Œ<strong><em>V</em></strong> è¿›å…¥å¯è§†åŒ–è¡Œæ¨¡å¼ï¼Œ<strong><em>Ctrl+v</em></strong> å¯è§†åŒ–å—æ¨¡å¼</p>
</li>
<li><p>æ‰§è¡Œå‘½ä»¤ï¼šé”®å…¥ <strong><em>:</em></strong> è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼š</p>
<ul>
<li><code>:q</code> é€€å‡ºå…³é—­çª—å£</li>
<li><code>:w</code> ä¿å­˜ï¼ˆå†™ï¼‰</li>
<li><code>:wq</code> ä¿å­˜å¹¶é€€å‡º</li>
<li><code>:e &#123;file-name&#125;</code> æ‰“å¼€è¦ç¼–è¾‘çš„æ–‡ä»¶</li>
<li><code>:ls</code> æ˜¾ç¤ºæ‰“å¼€çš„ç¼“å­˜</li>
<li><code>:help &#123;æ ‡é¢˜&#125;</code> æ‰“å¼€å¸®åŠ©æ–‡æ¡£ï¼š<ul>
<li><code>:help :w</code> æ‰“å¼€<code>:w</code>å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£</li>
<li><code>:help w</code> æ‰“å¼€<code>w</code>ç§»åŠ¨çš„å¸®åŠ©æ–‡æ¡£</li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote>
<p>é”®å…¥ <code>ESC</code> åˆ‡æ¢ä¸ºæ­£å¸¸æ¨¡å¼</p>
</blockquote>
<h2 id="vimã€Œä½œä¸ºç¼–ç¨‹è¯­è¨€ã€"><a href="#vimã€Œä½œä¸ºç¼–ç¨‹è¯­è¨€ã€" class="headerlink" title="vimã€Œä½œä¸ºç¼–ç¨‹è¯­è¨€ã€"></a>vimã€Œä½œä¸ºç¼–ç¨‹è¯­è¨€ã€</h2><h3 id="ç§»åŠ¨-åœ¨ç¼“å­˜ä¸­å¯¼èˆª"><a href="#ç§»åŠ¨-åœ¨ç¼“å­˜ä¸­å¯¼èˆª" class="headerlink" title="ç§»åŠ¨-åœ¨ç¼“å­˜ä¸­å¯¼èˆª"></a>ç§»åŠ¨-åœ¨ç¼“å­˜ä¸­å¯¼èˆª</h3><ol>
<li>åŸºæœ¬ç§»åŠ¨ï¼š<code>hjkl(å·¦ä¸‹å³ä¸Š-é€†æ—¶é’ˆ)</code></li>
<li>è¯ï¼š<code>w</code>-ä¸‹ä¸€ä¸ªè¯ï¼Œ<code>b</code>-è¯åˆï¼Œ<code>e</code>-è¯å°¾</li>
<li>è¡Œï¼š<code>0</code>è¡Œåˆï¼Œ<code>^</code>-ç¬¬ä¸€ä¸ªéç©ºæ ¼å­—ç¬¦ï¼Œ<code>$</code>è¡Œå°¾</li>
<li>å±å¹•ï¼š<code>H</code>-å±å¹•é¦–è¡Œï¼Œ<code>M</code>-å±å¹•ä¸­é—´ï¼Œ<code>L</code>-å±å¹•åº•éƒ¨</li>
<li>ç¿»é¡µï¼š<code>Ctrl+u</code>ä¸Šç¿»ï¼Œ<code>Ctrl+d</code>ä¸‹ç¿»</li>
<li>æ–‡ä»¶ï¼š <code>gg</code>-æ–‡ä»¶å¤´ï¼Œ<code>G</code>æ–‡ä»¶å°¾éƒ¨</li>
<li>æ‚é¡¹ï¼š<code>:&#123;line number&#125;&lt;CR&gt;</code> or <code>&#123;line number&#125;G</code></li>
<li>æŸ¥æ‰¾ï¼š<code>f&#123;character&#125;, t&#123;character&#125;, F&#123;character&#125;, T&#123;character&#125;</code>, (f/F = find, t/T = to, å°å†™æ˜¯ forward, å¤§å†™æ˜¯ backward)<ul>
<li>find/to forward/backward {character} on the current line</li>
<li><code>,</code> or <code>;</code>ç”¨äºå¯¼èˆªåŒ¹é…</li>
</ul>
</li>
<li>æœç´¢ï¼š<code>/&#123;regex&#125;</code>å‘åæœç´¢ï¼Œ<code>n</code> or <code>N</code>ç”¨äºå¯¼èˆªåŒ¹é…</li>
</ol>
<h3 id="ç¼–è¾‘-åŠ¨è¯"><a href="#ç¼–è¾‘-åŠ¨è¯" class="headerlink" title="ç¼–è¾‘-åŠ¨è¯"></a>ç¼–è¾‘-åŠ¨è¯</h3><ul>
<li><code>i</code> - insert mode</li>
<li><code>o</code>/<code>O</code> insert line below / above å‘ä¸‹ã€ä¸Šæ’å…¥è¡Œ</li>
<li><code>d&#123;motion&#125;</code>åˆ é™¤{ç§»åŠ¨å‘½ä»¤}ï¼Œ<code>dw</code>åˆ é™¤è¯,<code>d$</code>åˆ é™¤åˆ°è¡Œå°¾,<code>d0</code>-åˆ é™¤åˆ°è¡Œå¤´</li>
<li><code>c&#123;motion&#125;</code>æ”¹å˜{ç§»åŠ¨å‘½ä»¤}ï¼Œ<code>cw</code>æ”¹å˜è¯ï¼Œ<code>d&#123;motion&#125;</code>å†<code>i</code></li>
<li><code>x</code>åˆ é™¤å­—ç¬¦ï¼Œç­‰åŒäº<code>dl</code></li>
<li><code>s</code>æ›¿æ¢å­—ç¬¦ï¼Œç­‰åŒäº<code>xi</code></li>
<li>å¯è§†åŒ–æ¨¡å¼ + æ“ä½œ<ul>
<li>é€‰ä¸­æ–‡å­—ï¼Œ<code>d</code>åˆ é™¤æˆ–è€…<code>c</code>æ”¹å˜</li>
</ul>
</li>
<li><code>u</code>æ’¤é”€ï¼Œ<code>&lt;C-r&gt;</code>é‡åš</li>
<li><code>y</code> to copy / â€œyankâ€ (some other commands like d also copy)</li>
<li><code>p</code> ç²˜è´´</li>
<li><code>~</code> æ”¹å˜å­—ç¬¦å¤§å°å†™</li>
</ul>
<h3 id="è®¡æ•°"><a href="#è®¡æ•°" class="headerlink" title="è®¡æ•°"></a>è®¡æ•°</h3><blockquote>
<p><code>3w</code>å‘å‰ç§»åŠ¨ 3 ä¸ªè¯ï¼Œ<code>5j</code>å‘ä¸‹ç§»åŠ¨ 5 è¡Œï¼Œ<code>7dw</code>åˆ é™¤ 7 ä¸ªè¯</p>
</blockquote>
<h3 id="ä¿®é¥°è¯­ï¼šç”¨ä¿®é¥°è¯­æ”¹å˜è¯­ä¹‰"><a href="#ä¿®é¥°è¯­ï¼šç”¨ä¿®é¥°è¯­æ”¹å˜è¯­ä¹‰" class="headerlink" title="ä¿®é¥°è¯­ï¼šç”¨ä¿®é¥°è¯­æ”¹å˜è¯­ä¹‰"></a>ä¿®é¥°è¯­ï¼šç”¨ä¿®é¥°è¯­æ”¹å˜è¯­ä¹‰</h3><blockquote>
<p><code>i</code>, <code>a</code>è¡¨ç¤ºåœ¨å†…éƒ¨ï¼Œåœ¨å‘¨å›´</p>
</blockquote>
<ul>
<li><code>ci(</code>æ”¹å˜å½“å‰æ‹¬å·å†…å®¹</li>
<li><code>ci[</code>æ”¹å˜å½“å‰æ–¹æ‹¬å·å†…å®¹</li>
<li><code>da&#39;</code>åˆ é™¤ä¸€ä¸ªå•å¼•å·å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬å‘¨å›´çš„å•å¼•å·</li>
</ul>
<h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h2><blockquote>
<p>å®(macro)ï¼šæ‰¹å¤„ç†ï¼Œå‘½ä»¤é›†åˆ</p>
</blockquote>
<ol>
<li><p>æœç´¢&amp;æ›¿æ¢ï¼š<code>:s</code>æ›¿æ¢</p>
</li>
<li><p>å¤šçª—å£ï¼š<code>:sp</code> or <code>:vsp</code>åˆ†å‰²çª—å£ï¼ŒåŒä¸€ä¸ªç¼“å­˜å¯ä»¥åœ¨å¤šä¸ªçª—å£æ˜¾ç¤º</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»¥ä¸‹è½½çš„ vimrc æ–‡ä»¶ä¸ºä¾‹</span></span><br><span class="line">vim vimrc</span><br><span class="line">:sp</span><br><span class="line"><span class="comment"># æ­¤æ—¶ä¼šæœ‰2ä¸ªçª—å£æŸ¥çœ‹æˆ–ç¼–è¾‘vimrcæ–‡ä»¶</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ï¼š<code>q&#123;character&#125;</code>å¼€å§‹åœ¨å¯„å­˜å™¨<code>&#123;character&#125;</code>ä¸­å½•åˆ¶å®ï¼Œ<code>q</code>åœæ­¢å½•åˆ¶ï¼Œ<code>@</code>é‡æ”¾å®</p>
</li>
<li><p>æ‰§è¡Œå® <code>&#123;æ¬¡æ•°&#125;@&#123;å­—ç¬¦&#125;</code>ï¼Œæ‰§è¡Œå®<code>&#123;æ¬¡æ•°&#125;</code>æ¬¡</p>
</li>
<li><p>å®é€’å½’ï¼š</p>
<ol>
<li><code>q&#123;character&#125;q</code>æ¸…é™¤å®</li>
<li>å½•åˆ¶è¯¥å®ï¼Œç”¨@{character}æ¥é€’å½’è°ƒç”¨è¯¥å®</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªåŠ¨åŠ æœ«å°¾è¡Œæ³¨é‡Šå®**@t**</span></span><br><span class="line">touch new-practice-vimrc</span><br><span class="line">vim new-practice-vimrc</span><br><span class="line"><span class="comment"># å½•åˆ¶å®t</span></span><br><span class="line">qt</span><br><span class="line"><span class="comment"># iè¿›å…¥ç¼–è¾‘æ¨¡å¼,ç¼–è¾‘å™¨åº•éƒ¨æ˜¾ç¤ºï¼š --INSERT --Recording @t</span></span><br><span class="line">i</span><br><span class="line"><span class="comment"># è¾“å…¥é€šç”¨è¡Œå°¾æ³¨é‡Š</span></span><br><span class="line"><span class="comment"># escé€€å‡ºåˆ°ç¼–è¾‘æ¨¡å¼,åº•éƒ¨æ˜¾ç¤º --Recording @t</span></span><br><span class="line"><span class="comment"># qåœæ­¢å®å½•åˆ¶</span></span><br><span class="line">q</span><br><span class="line"><span class="comment"># :wq!ä¿å­˜é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œç»“æŸ</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="vscode-é…ç½®-vim-æ’ä»¶"><a href="#vscode-é…ç½®-vim-æ’ä»¶" class="headerlink" title="vscode é…ç½® vim æ’ä»¶"></a>vscode é…ç½® vim æ’ä»¶</h2><ul>
<li>ä¸‹è½½æ’ä»¶ Vim</li>
<li>é…ç½® setting.json</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;vim.easymotion&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.suround&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.incsearch&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.useSystemClipboard&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.useCtrlKeys&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.hlsearch&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;vim.insertModeKeyBindings&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;before&quot;</span>: [<span class="string">&quot;j&quot;</span>, <span class="string">&quot;j&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;after&quot;</span>: [<span class="string">&quot;&lt;Esc&gt;&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;vim.normalModeKeyBindingsNonRecursive&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;before&quot;</span>: [<span class="string">&quot;&lt;leader&gt;&quot;</span>, <span class="string">&quot;d&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;after&quot;</span>: [<span class="string">&quot;d&quot;</span>, <span class="string">&quot;d&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;before&quot;</span>: [<span class="string">&quot;&lt;C-n&gt;&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;commands&quot;</span>: [<span class="string">&quot;:nohl&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;vim.leader&quot;</span>: <span class="string">&quot;&lt;space&gt;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;vim.handleKeys&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;&lt;C-a&gt;&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;&lt;C-f&gt;&quot;</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç»ƒä¹ -è§missing-semester-æ–‡ä»¶å¤¹"><a href="#ç»ƒä¹ -è§missing-semester-æ–‡ä»¶å¤¹" class="headerlink" title="ç»ƒä¹ -è§missing-semester æ–‡ä»¶å¤¹"></a>ç»ƒä¹ -è§<a href="https://github.com/MillyTang/missing-semester">missing-semester æ–‡ä»¶å¤¹</a></h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2020/11/07/three-easy-pieces/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/07/three-easy-pieces/" class="post-title-link" itemprop="url">three-easy-pieces</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-11-07 16:15:53" itemprop="dateCreated datePublished" datetime="2020-11-07T16:15:53+08:00">2020-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-02 17:08:32" itemprop="dateModified" datetime="2021-09-02T17:08:32+08:00">2021-09-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æ“ä½œç³»ç»Ÿé˜…è¯»ç¬”è®°-Three-Easy-Pieces"><a href="#æ“ä½œç³»ç»Ÿé˜…è¯»ç¬”è®°-Three-Easy-Pieces" class="headerlink" title="æ“ä½œç³»ç»Ÿé˜…è¯»ç¬”è®° - Three Easy Pieces"></a>æ“ä½œç³»ç»Ÿé˜…è¯»ç¬”è®° - Three Easy Pieces</h1><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol>
<li><a target="_blank" rel="noopener" href="http://pages.cs.wisc.edu/~remzi/OSTEP/">å…è´¹ä¹¦ç± PDF ç‰ˆæœ¬</a></li>
<li><a target="_blank" rel="noopener" href="http://pages.cs.wisc.edu/~remzi/OSTEP/Homework/homework.html">Homework</a></li>
<li><a href="https://github.com/remzi-arpacidusseau/ostep-projects">Projects</a></li>
<li><code>å…¶ä½™æ•™è¾…èµ„æ–™</code>è¯·å‘<code>contact@epubit.com.cn</code>å‘é€é‚®ä»¶è·å–</li>
<li><a href="https://github.com/remzi-arpacidusseau/ostep-projects">ostep-Projects</a></li>
</ol>
<h2 id="ç¬¬ä¸€ç« -è™šæ‹ŸåŒ–"><a href="#ç¬¬ä¸€ç« -è™šæ‹ŸåŒ–" class="headerlink" title="ç¬¬ä¸€ç«  - è™šæ‹ŸåŒ–"></a>ç¬¬ä¸€ç«  - è™šæ‹ŸåŒ–</h2><h3 id="ç¬¬ä¸€èŠ‚-CPU-è™šæ‹ŸåŒ–-æ—¶åˆ†å…±äº«-è¿›ç¨‹ï¼ˆå’Œç©ºåˆ†å…±äº«-ç£ç›˜ï¼‰"><a href="#ç¬¬ä¸€èŠ‚-CPU-è™šæ‹ŸåŒ–-æ—¶åˆ†å…±äº«-è¿›ç¨‹ï¼ˆå’Œç©ºåˆ†å…±äº«-ç£ç›˜ï¼‰" class="headerlink" title="ç¬¬ä¸€èŠ‚ - CPU è™šæ‹ŸåŒ–: æ—¶åˆ†å…±äº«-è¿›ç¨‹ï¼ˆå’Œç©ºåˆ†å…±äº«-ç£ç›˜ï¼‰"></a>ç¬¬ä¸€èŠ‚ - CPU è™šæ‹ŸåŒ–: æ—¶åˆ†å…±äº«-è¿›ç¨‹ï¼ˆå’Œç©ºåˆ†å…±äº«-ç£ç›˜ï¼‰</h3><h4 id="è¿›ç¨‹-æ“ä½œç³»ç»Ÿä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºæä¾›çš„æŠ½è±¡"><a href="#è¿›ç¨‹-æ“ä½œç³»ç»Ÿä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºæä¾›çš„æŠ½è±¡" class="headerlink" title="è¿›ç¨‹: æ“ä½œç³»ç»Ÿä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºæä¾›çš„æŠ½è±¡"></a>è¿›ç¨‹: æ“ä½œç³»ç»Ÿä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºæä¾›çš„æŠ½è±¡</h4><ol>
<li>è¿›ç¨‹çš„æœºå™¨çŠ¶æ€ç»„æˆï¼š</li>
</ol>
<ul>
<li>å†…å­˜</li>
<li>å¯„å­˜å™¨<ul>
<li>ç±»å‹ï¼šç¨‹åºè®¡æ•°å™¨ &amp; æ ˆæŒ‡é’ˆ &amp; å¸§æŒ‡é’ˆ</li>
<li>3 éƒ¨åˆ†ç»„æˆï¼šçŠ¶æ€ï¼Œæ•°æ®ï¼ŒæŒ‡ä»¤</li>
</ul>
</li>
</ul>
<ol start="2">
<li><p>å¯åŠ¨ç¨‹åºçš„è¿‡ç¨‹ï¼šæ“ä½œç³»ç»Ÿå°†ç¨‹åºçš„ <code>ä»£ç </code>å’Œ<code>é™æ€æ•°æ®</code>ä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶ä¸ºç¨‹åºçš„<code>è¿è¡Œæ—¶æ ˆ</code>å’ŒåŠ¨æ€å†…å­˜<code>å †</code>åˆ†é…å†…å­˜ï¼Œæœ€åå¯åŠ¨ç¨‹åºï¼Œé€šå¸¸æ˜¯ç¨‹åºå…¥å£ï¼ˆä»¥<code>c</code>ä¸ºä¾‹é€šå¸¸æ˜¯ main(ï¼‰å‡½æ•°ï¼‰ã€‚</p>
</li>
<li><p>é»˜è®¤æƒ…å†µä¸‹è¿›ç¨‹éƒ½æœ‰<code>3ä¸ªæ–‡ä»¶æè¿°ç¬¦</code></p>
</li>
</ol>
<ul>
<li>æ ‡å‡†è¾“å…¥<code>0</code></li>
<li>æ ‡å‡†è¾“å‡º<code>1</code></li>
<li>æ ‡å‡†é”™è¯¯<code>2</code></li>
</ul>
<ol start="4">
<li>è¿›ç¨‹çŠ¶æ€</li>
</ol>
<ul>
<li>initial: åˆ›å»ºè¿›ç¨‹æ—¶çš„çŠ¶æ€</li>
<li>running</li>
<li>ready</li>
<li>blocked</li>
<li>final: åƒµæ­»çŠ¶æ€ï¼Œå¾…å›æ”¶ï¼Œæœ‰æ—¶å€™ä¼šå‡ºç° parent progress å·²ç»è¢«å›æ”¶ä½†æ˜¯ child progress è¿˜åœ¨åƒµæ­»çŠ¶æ€æ—¶ï¼Œæ­¤æ—¶æœ‰é«˜ä¸€çº§çš„ init è¿›ç¨‹å›æ”¶ï¼Œæˆ–è€…ç›´æ¥å…³æœºä¹Ÿè¡Œï¼ˆæœ‰äº›åƒåœ¾ç¨‹åºåªèƒ½å…³æœºã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›ç¨‹ä¸»è¦çŠ¶æ€</span></span><br><span class="line">running  &lt;----------- è°ƒåº¦|å–æ¶ˆè°ƒåº¦ ----------&gt; ready</span><br><span class="line">  |                                             |</span><br><span class="line">  |---I/O: start---&gt; blocked --I/O: finished---&gt;|</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šæ“ä½œç³»ç»Ÿä¿å­˜å’Œæ¢å¤è¯¥è¿›ç¨‹çš„å¯„å­˜å™¨å†…å®¹çš„è¿‡ç¨‹</li>
</ol>
<h4 id="è¿›ç¨‹-API-ç³»ç»Ÿè°ƒç”¨é™·å…¥å†…æ ¸æ¨¡å¼-åŒºåˆ«äºç”¨æˆ·æ¨¡å¼ï¼‰"><a href="#è¿›ç¨‹-API-ç³»ç»Ÿè°ƒç”¨é™·å…¥å†…æ ¸æ¨¡å¼-åŒºåˆ«äºç”¨æˆ·æ¨¡å¼ï¼‰" class="headerlink" title="è¿›ç¨‹ API(ç³»ç»Ÿè°ƒç”¨é™·å…¥å†…æ ¸æ¨¡å¼,åŒºåˆ«äºç”¨æˆ·æ¨¡å¼ï¼‰"></a>è¿›ç¨‹ API(ç³»ç»Ÿè°ƒç”¨é™·å…¥å†…æ ¸æ¨¡å¼,åŒºåˆ«äºç”¨æˆ·æ¨¡å¼ï¼‰</h4><blockquote>
<p>æš‚æ—¶åªè€ƒè™‘å• CPU çš„æƒ…å†µï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆè¿›ç¨‹ï¼ŒCPU éƒ½æœ‰å¯èƒ½ä¸æ–­ä¸­æ–­ï¼Œåˆ‡æ¢ä»»æ„è¿›ç¨‹ï¼Œè®°ä½å°±ç®—æ˜¯äº²å­ï¼ˆè¿›ç¨‹ï¼‰ä¹Ÿæ˜¯ä¸å­˜åœ¨å°Šè€çˆ±å¹¼çš„ï¼Œè°å…ˆè¿è¡Œå–å†³äº CPU è°ƒåº¦ç¨‹åºï¼Œæ‰€ä»¥æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚âš ï¸ è¿™ç§ä¸ç¡®å®šæ€§è´¯ç©¿å…¨æ–‡</p>
</blockquote>
<ol>
<li>fork()ï¼šè°ƒç”¨ä¸€æ¬¡è¿”å›ä¸¤æ¬¡ï¼Œäº‰å…ˆæå</li>
</ol>
<ul>
<li>fork()è™½ç„¶å¤åˆ¶äº† parent progressï¼Œä½†æ˜¯ç”±äºå†™æ—¶å¤åˆ¶æ‹¥æœ‰ç§æœ‰è™šæ‹Ÿå†…å­˜ï¼ˆç”¨æˆ·æ ˆï¼‰ï¼Œä½†æ˜¯è°ƒç”¨æ—¶è¿”å›å€¼å´ä¸ç›¸åŒï¼Œchild progress çš„è¿”å›å€¼æ˜¯ 0ï¼Œparent progress çš„è¿”å›å€¼æ˜¯ child progress çš„ pidã€‚</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ‰å¿…è¦ç†è§£ä¸€ä¸‹è¿”å›2æ¬¡, ç¤ºä¾‹ä»£ç ï¼ˆcï¼‰å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">// å¤´æ–‡ä»¶çœç•¥</span></span><br><span class="line"><span class="comment">// è®©æˆ‘ä»¬å…ˆå‡å®šchild progresså…ˆè¿è¡Œ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;æ‚¨å¥½ï¼Œå½“å‰è¿è¡Œè¿›ç¨‹pid:%d&quot;</span>, <span class="keyword">int</span> getpid());</span><br><span class="line">  <span class="keyword">int</span> rc = fork()</span><br><span class="line">  <span class="comment">// ä¸è€ƒè™‘forkå¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (rc == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// child process, è¿™é‡Œæ ¹æ® rc çš„è¿”å›å€¼è¿è¡Œä¸€æ¬¡ - !!è¿”å›ä¸€æ¬¡</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (rc &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// parent process, è¿™é‡Œæ ¹æ® rc çš„è¿”å›å€¼å†è¿è¡Œä¸€æ¬¡ - !!è¿”å›ä¸¤æ¬¡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>â€¼ï¸ æ³¨æ„ï¼šnodejs child_process.fork()è™½ç„¶è°ƒç”¨çš„æ˜¯ fork(2),ä½†æ˜¯å´æœ‰æ‰€ä¸åŒï¼Œè¡ç”Ÿçš„ child progress ä¸ä¼šå…‹éš†å½“å‰ parent progressï¼Œåªèƒ½é€šè¿‡ IPC é€šä¿¡ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤è¡Œæ‰§è¡Œ: node ./os-notes/chapter-5.js è¾“å‡ºç»“æœ:</span></span><br><span class="line">æ­¤æ¶ˆæ¯æœ€æ–°æ˜¾ç¤º</span><br><span class="line">è¡ç”Ÿçš„child progressçš„ pidï¼š95650</span><br><span class="line">æ­¤è¿›ç¨‹çš„ pid æ˜¯ 95649</span><br><span class="line">^C</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>exec()ï¼šé¸ å é¹Šå·¢ï¼Œè‡­ä¸è¦è„¸</li>
</ol>
<blockquote>
<p>å…¶ä»–å˜ä½“ï¼šexecl(), execle(), execlp(), execv(), execvp()ç­‰ã€‚â€¼ï¸ æˆåŠŸè°ƒç”¨ä¸ä¼šè¿”å›ã€‚</p>
</blockquote>
<ul>
<li>exec()ä¼šç›´æ¥è¦†å†™å½“å‰è¿›ç¨‹çš„ä»£ç ï¼Œå †ï¼Œæ ˆå’Œå…¶ä»–å†…å­˜ç©ºé—´ç­‰ã€‚æ‰€ä»¥æ–°çš„ç¨‹åºçš„è™šæ‹Ÿåœ°å€ä¸å˜ï¼Œè¿›ç¨‹ id ä¸å˜</li>
</ul>
<ol start="3">
<li>wait()ï¼šparent progress å¯ä»¥é€šè¿‡è°ƒç”¨<code>wait()</code>æ¥ç¡®ä¿è‡ªå·±åè¿è¡Œï¼Œæ­¤æ—¶ 2 ç§æƒ…å†µï¼š</li>
</ol>
<ul>
<li>child progress å…ˆè¿è¡Œï¼Œç„¶å parent progress è¿è¡Œï¼Œå¤©æ„å¦‚æ­¤ã€‚</li>
<li>parent progress å…ˆè¿è¡Œï¼Œé©¬ä¸Šè°ƒç”¨<code>wait()</code>ï¼Œè¯¥ç³»ç»Ÿè°ƒç”¨ä¼šåœ¨ child progress è¿è¡Œç»“æŸåè¿”å›ï¼Œç„¶å parent progress è¾“å‡ºã€‚<br>æ€»ç»“ï¼šè¿™ 3 ä¸ªç³»ç»Ÿè°ƒç”¨å¯ä»¥ç”¨æ¥å®ç° shell çš„å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚é‡å®šå‘è¾“å‡ºï¼Œç®¡é“çš„å®ç°æ–¹å¼ç­‰ã€‚</li>
</ul>
<blockquote>
<p>â€¼ï¸ é—®é¢˜ï¼šå¤šè¿›ç¨‹ç¨‹åºæ˜¯æ€ä¹ˆæŠ½è±¡çš„ï¼Ÿ</p>
</blockquote>
<blockquote>
<p>è¿›ç¨‹æ˜¯ç¨‹åºè¿è¡Œçš„ä¸€ä¸ªå®ä¾‹ï¼Œå¤šè¿›ç¨‹å°±æ˜¯ç¨‹åºè¿è¡Œçš„å¤šä¸ªå®ä¾‹ï¼Œ<code>fork()</code>å‡½æ•°åœ¨æ–°çš„ child progress ä¸­è¿è¡Œç›¸åŒçš„ç¨‹åºï¼Œchild progress æ˜¯ parent progress çš„å¤åˆ¶å“ï¼Œè¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­å°†åªæœ‰<code>æ ˆ</code>å†…æ•°æ®ä¸åŒï¼ˆé€šè¿‡æ ‡è®°ä¸ºç§æœ‰çš„å†™æ—¶å¤åˆ¶ï¼Œå¤åˆ¶æ—¶æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œè¿è¡Œåä¸åŒï¼‰ï¼Œ<code>å †</code>ã€<code>ä»£ç </code>ä¸­çš„æ•°æ®å®Œå…¨ç›¸åŒï¼Œå› ä¸º fork å¤åˆ¶è¿›ç¨‹æ—¶åªæ˜¯é‡æ–°åˆ†é…äº†ä¸€æ®µè™šæ‹Ÿå†…å­˜å¤åˆ¶åŸè¿›ç¨‹å†…å®¹ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºåªè¯»ï¼Œå¯ä»¥é€šè¿‡ç»˜åˆ¶è¿›ç¨‹å›¾æ¥äº†è§£ fork()ã€‚è€Œé€šè¿‡<code>exec()</code>æ˜¯åœ¨å½“å‰è¿›ç¨‹ä¸­çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œå¦ä¸€ä¸ªæ–°ç¨‹åºï¼Œå°†è¦†ç›–å½“å‰è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼ˆè¯¥è¿›ç¨‹æ‰€åœ¨çš„è™šæ‹Ÿå†…å­˜ï¼‰ï¼Œä½†æ˜¯<code>PID</code>(è¿›ç¨‹ id)ä¸å˜ä¸”ç»§æ‰¿äº†è°ƒç”¨è¯¥å‡½æ•°æ—¶å·²æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ï¼ˆå³åŒ…å«<code>stdin</code>,<code>stdout</code>,<code>stderr</code>3 ä¸ªæè¿°ç¬¦ï¼‰ã€‚æ›´å¤šå†…å®¹è¯·å‚è€ƒ<code>csappç¬¬å…«ç« å¼‚å¸¸æ§åˆ¶æµ</code>ä¸€èµ·é£Ÿç”¨ã€‚</p>
</blockquote>
<h4 id="æœºåˆ¶-å—é™ç›´æ¥æ‰§è¡Œ-limited-direct-execution-ç®€ç§°-LDE-åè®®"><a href="#æœºåˆ¶-å—é™ç›´æ¥æ‰§è¡Œ-limited-direct-execution-ç®€ç§°-LDE-åè®®" class="headerlink" title="æœºåˆ¶: å—é™ç›´æ¥æ‰§è¡Œ(limited direct execution, ç®€ç§° LDE åè®®)"></a>æœºåˆ¶: å—é™ç›´æ¥æ‰§è¡Œ(limited direct execution, ç®€ç§° LDE åè®®)</h4><blockquote>
<p>LDE åè®®çš„ä¸¤ä¸ªè¿‡ç¨‹ï¼š1. å†…æ ¸åˆå§‹åŒ–é™·é˜±è¡¨ï¼Œå¹¶è®°ä½ä½ç½®ä»¥ä¾¿åç»­æ‰§è¡Œæ“ä½œï¼›2. åœ¨è¿›ç¨‹ä¸­è®¾ç½®èŠ‚ç‚¹åˆ†é…å†…å­˜ï¼Œç”¨äºä¿å­˜é™·å…¥é™·é˜±å’Œè¿”å›çš„ä¿¡æ¯</p>
</blockquote>
<p>æ­¤åè®®ä¸‹éœ€è¦è§£å†³ 2 ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å—é™åˆ¶æ“ä½œï¼šå¼•å…¥<strong>ç”¨æˆ·æ¨¡å¼(user mode)**ï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯</strong>å†…æ ¸æ¨¡å¼(kernel mode)**</li>
</ol>
<ul>
<li>ç”¨æˆ·æ¨¡å¼ å’Œ ç³»ç»Ÿäº¤äº’ é€šè¿‡ å†…æ ¸æ¨¡å¼æš´éœ²ä¸€äº›å…³é”®åŠŸèƒ½ï¼Œå¦‚ï¼šè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œåˆ›å»ºæˆ–é”€æ¯è¿›ç¨‹ï¼Œæˆ–ä¸å…¶ä»–è¿›ç¨‹é€šä¿¡ä»¥åŠåˆ†é…æ›´å¤šå†…å­˜ç­‰ï¼Œç§°ä¸ºç³»ç»Ÿè°ƒç”¨ã€‚æš´éœ²åŠŸèƒ½çš„æ–¹å¼ä¸ºåœ¨å¯åŠ¨æ—¶è®¾ç½® <strong>é™·é˜±è¡¨</strong> ç³»ç»Ÿå¯ä»¥åœ¨ <strong><em>ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼</em></strong>ä¸­åå¤æ¨ªè·³</li>
<li>ä¾‹å¦‚ï¼šç”¨æˆ·æ¨¡å¼ä¸‹è¿›ç¨‹ä¸èƒ½å‘å‡º I/O è¯·æ±‚ ï¼Œå¦åˆ™ä¼šå¯¼è‡´è¿›ç¨‹ç»ˆæ­¢</li>
</ul>
<ol start="2">
<li>è¿›ç¨‹åˆ‡æ¢ï¼š</li>
</ol>
<ul>
<li>éœ€è¦è§£å†³æ“ä½œç³»ç»Ÿé‡æ–°è·å–å æ®ä¸»åŠ¨æƒçš„é—®é¢˜<ul>
<li>ç­‰å¾…è¿›ç¨‹æ‰§è¡Œç³»ç»Ÿè°ƒç”¨æˆ–è€…å‡ºé”™ - è¯¥è¿›ç¨‹å¿…é¡»æ˜¯ä¸ªå¬è¯çš„å¥½å­©å­æ‰è¡Œ</li>
<li>æ—¶é’Ÿä¸­æ–­</li>
</ul>
</li>
<li>ä¿å­˜è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼š2 ç§å¯èƒ½ï¼Œå­˜å‚¨ä½ç½®ï¼Œå­˜å‚¨å†…å®¹å’Œå­˜å‚¨æ–¹å¼å‡ä¸ç›¸åŒ<ul>
<li>æ—¶é’Ÿä¸­æ–­æ—¶ï¼šç”¨æˆ·å¯„å­˜å™¨æœ‰ç¡¬ä»¶éšå¼ä¿å­˜ï¼Œä½¿ç”¨è¯¥è¿›ç¨‹çš„<strong>å†…æ ¸æ ˆ</strong>ã€‚</li>
<li>è°ƒåº¦ç¨‹åºåˆ‡æ¢è¿›ç¨‹ï¼šå†…æ ¸å¯„å­˜å™¨è¢«è½¯ä»¶ OS ä¿å­˜ï¼Œå¹¶å­˜å‚¨åœ¨è¯¥è¿›ç¨‹çš„è¿›ç¨‹ç»“æ„çš„å†…å­˜ä¸­ï¼ˆâ€¼ï¸ ç”¨æˆ·æ ˆå—ï¼Ÿï¼‰ã€‚</li>
</ul>
</li>
</ul>
<ol start="3">
<li>è¿›ç¨‹å¹¶å‘ï¼šé”ï¼Ÿä¸­æ–­ä¸­ç¦æ­¢ä¸­æ–­ - ç¦æ­¢å¥—å¨ƒï¼Ÿä¿¡å·ï¼Ÿ =&gt; å¹¶å‘ç« èŠ‚ä¼šè¯¦ç»†è®¨è®º</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼š</span></span><br><span class="line">-------------------------</span><br><span class="line">| å†…æ ¸æ ˆï¼ˆä»£ç ï¼Œæ•°æ®ï¼Œå †ï¼Œæ ˆï¼‰|  ----&gt; ç”¨æˆ·ä»£ç ä¸å¯è§çš„å†…å­˜</span><br><span class="line">--------------------------</span><br><span class="line">|   ç”¨æˆ·æ ˆï¼ˆè¿è¡Œæ—¶åˆ›å»ºï¼‰     |</span><br><span class="line">--------------------------</span><br><span class="line">|  å…±äº«åº“çš„å†…å­˜æ˜ å°„åŒºåŸŸ      |</span><br><span class="line">---------------------------</span><br><span class="line">|    è¿è¡Œæ—¶å †              |</span><br><span class="line">--------------------------</span><br><span class="line">|    è¯»/å†™æ®µï¼ˆ.data,.bssï¼‰ |   ----&gt; ä»å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½</span><br><span class="line">--------------------------</span><br><span class="line">|       åªè¯»ä»£ç æ®µ         |   ----&gt; ä»å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½</span><br><span class="line">|ï¼ˆ.init,.text,.rodataï¼‰  |</span><br><span class="line">--------------------------</span><br></pre></td></tr></table></figure>

<h4 id="è¿›ç¨‹è°ƒåº¦ï¼šä»‹ç»"><a href="#è¿›ç¨‹è°ƒåº¦ï¼šä»‹ç»" class="headerlink" title="è¿›ç¨‹è°ƒåº¦ï¼šä»‹ç»"></a>è¿›ç¨‹è°ƒåº¦ï¼šä»‹ç»</h4><blockquote>
<p>å¦‚ä½•å¼€å‘è°ƒåº¦ç­–ç•¥ï¼Ÿ æƒ³ä¸€æƒ³ä»€ä¹ˆæƒ…å†µä¸‹è¦ä½¿ç”¨è°ƒåº¦ç­–ç•¥ï¼Ÿç„¶åå¼„æ¸…æ¥šè¯„ä»·è°ƒåº¦ç­–ç•¥çš„å…³é”®æŒ‡æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<pre><code>å·¥ä½œè´Ÿè½½å‡è®¾ï¼š
1. æ¯ä¸€ä¸ªè¿›ç¨‹è¿è¡Œç›¸åŒçš„æ—¶é—´ -&gt; å®Œå…¨å…¬å¹³
2. æ‰€æœ‰å·¥ä½œåŒæ—¶åˆ°è¾¾ -&gt; å¹³å‡å“åº”æ—¶é—´
3. ä¸€æ—¦å¼€å§‹ï¼Œæ¯ä¸ªè¿›ç¨‹è¿è¡Œåˆ°å®Œæˆ -&gt; è¿è¡Œæ—¶ç‹¬å CPU
4. æ‰€æœ‰è¿›ç¨‹ä¸æ¶‰åŠI/O -&gt; è¿›ç¨‹ä»»åŠ¡å•ä¸€
5. å·²çŸ¥æ¯ä¸ªè¿›ç¨‹çš„è¿è¡Œæ—¶é—´ -&gt; å¹³å‡å‘¨è½¬æ—¶é—´

è°ƒåº¦æŒ‡æ ‡ï¼š
1. å‘¨è½¬æ—¶é—´ = Tå®Œæˆæ—¶é—´ - Tåˆ°è¾¾æ—¶é—´ =&gt; æ€§èƒ½æŒ‡æ ‡
2. å…¬å¹³
3. å“åº”æ—¶é—´ = Té¦–æ¬¡è¿è¡Œ - Tåˆ°è¾¾æ—¶é—´
è®©æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªæ—¶é—´å‡½æ•° T(å‚ä¸è¿›ç¨‹, ç­–ç•¥, [æ”¾å¼€çš„å‡è®¾æ¡ä»¶])</code></pre>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å·¥ä½œè¿›ç¨‹å‡è®¾: åŸºäºé€æ¸æ”¾å¼€ä»¥ä¸Š5ä¸ªå‡è®¾æ¡ä»¶</span></span><br><span class="line"><span class="comment"># test1: å‡å®šç›®å‰çš„è¿›ç¨‹ä¸ºï¼ˆéšæœºæ’åºæ‰§è¡Œï¼‰ï¼šAï¼ˆ10så®Œæˆï¼‰ï¼ŒBï¼ˆ10så®Œæˆï¼‰ï¼ŒCï¼ˆ10så®Œæˆï¼‰</span></span><br><span class="line"> 10s  10s  10s</span><br><span class="line">-----|||||/////30s</span><br><span class="line">  A    B    C</span><br><span class="line"><span class="comment"># test2: å‡å®šç›®å‰çš„è¿›ç¨‹ä¸ºï¼ˆéšæœºæ’åºæ‰§è¡Œï¼‰ï¼šAï¼ˆ100så®Œæˆï¼‰ï¼ŒBï¼ˆ10så®Œæˆï¼‰ï¼ŒCï¼ˆ10så®Œæˆï¼‰ - å‡è®¾1</span></span><br><span class="line">         100s                   10s  10s</span><br><span class="line">-------------------------------|||||/////120s</span><br><span class="line">  A    B    C</span><br><span class="line"><span class="comment"># test3: å‡å®šç›®å‰çš„è¿›ç¨‹ä¸ºï¼ˆéšæœºæ’åºæ‰§è¡Œï¼‰ï¼šAï¼ˆ100så®Œæˆï¼‰0såˆ°è¾¾ï¼ŒBï¼ˆ10så®Œæˆï¼‰10såˆ°è¾¾ï¼ŒCï¼ˆ10så®Œæˆï¼‰10såˆ°è¾¾ - å‡è®¾1&amp;2</span></span><br><span class="line">         100s                   10s  10s</span><br><span class="line">-------------------------------|||||/////120s</span><br><span class="line">  A    B    C</span><br><span class="line"><span class="comment"># test4: å‡å®šç›®å‰çš„è¿›ç¨‹ä¸ºï¼ˆéšæœºæ’åºæ‰§è¡Œï¼‰ï¼šAï¼ˆ100så®Œæˆï¼‰0såˆ°è¾¾ï¼ŒBï¼ˆ10så®Œæˆï¼‰10såˆ°è¾¾ï¼ŒCï¼ˆ10så®Œæˆï¼‰10såˆ°è¾¾ - å‡è®¾1&amp;2&amp;3</span></span><br><span class="line"> 10s  10s  10s         90s</span><br><span class="line">-----|||||/////--------------------------120s</span><br><span class="line">  A    B    C           A</span><br></pre></td></tr></table></figure>

<ol>
<li>å…ˆè¿›å…ˆå‡º<strong>FIFO</strong>ï¼šé˜Ÿåˆ—</li>
</ol>
<ul>
<li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š<ul>
<li>Tt(test1,FIFO,[]) = (10 + 20 + 30) / 3 = 20s</li>
<li>Tt(test2,FIFO,[1]) = (100 + 110 + 120) / 3 = 110s</li>
</ul>
</li>
</ul>
<ol start="2">
<li>æœ€çŸ­ä»»åŠ¡ä¼˜å…ˆ<strong>SJF</strong>ï¼šFIFO ä¸‹ä¸€æ—¦å‡ºç°å•ä¸ªé•¿ä»»åŠ¡å‘¨è½¬æ—¶é—´å°±å¾ˆé•¿ï¼Œæ”¹è¿›ä¸€ä¸‹ç­–ç•¥</li>
</ol>
<ul>
<li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š<ul>
<li>Tt(test2,SJF,[1]) = (10 + 20 + 120) / 3 = 50s</li>
<li>Tt(test3,SJF,[1,2]) = (100 + 110-10 + 120-10 ) / 3 = 103.3s</li>
</ul>
</li>
</ul>
<ol start="3">
<li>æœ€çŸ­å®Œæˆæ—¶é—´ä¼˜å…ˆ<strong>STCF</strong>ï¼šSJF ä¸‹çŸ­ä»»åŠ¡ååˆ°è¾¾æ—¶ï¼Œé•¿ä»»åŠ¡çš„å‘¨è½¬æ—¶é—´å¹¶æ²¡æœ‰æ”¹å–„</li>
</ol>
<ul>
<li><p>å¹³å‡å‘¨è½¬æ—¶é—´ï¼š</p>
<ul>
<li>Tt(test4,STCF,[1,2ï¼Œ3]) = (120 + 10 + 20) / 3 = 50s</li>
</ul>
<p>å¹³å‡å‘¨è½¬æ—¶é—´ä½œä¸ºå”¯ä¸€æŒ‡æ ‡çš„è¯ï¼Œ<strong>STCF</strong>è¡¨ç°è‰¯å¥½ã€‚ç„¶é¹…ï¼Œå¼•å…¥åˆ†æ—¶ç³»ç»Ÿåç”¨æˆ·è¦æ±‚ç³»ç»Ÿäº¤äº’æ€§å¥½ï¼Œæ‰€ä»¥å¼•å…¥å“åº”æ—¶é—´ä½œä¸ºæ–°çš„æŒ‡æ ‡<br>å¹³å‡å“åº”æ—¶é—´ï¼šTr(test4,STCF,[1ï¼Œ2ï¼Œ3]) = (0 + 10 - 10 + 20 - 10) / 3 = 3.3s;<br>Tr(test1,FIFO,[]) = (0 + 10 - 10 + 20 - 10) / 3 = 3.3s;</p>
</li>
</ul>
<ol start="4">
<li>è½®è½¬<strong>RR(Round-Robin)</strong>: RR åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…è¿è¡Œï¼Œç„¶ååˆ‡æ¢åˆ°é˜Ÿåˆ—çš„ä¸‹ä¸€ä¸ªå·¥ä½œï¼Œåå¤åˆ‡æ¢æ‰§è¡Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚</li>
</ol>
<ul>
<li>æ—¶é—´ç‰‡(time slice)çš„é•¿åº¦ä¸ºæ—¶é’Ÿä¸­æ–­å‘¨æœŸçš„å€æ•°: ä»¥ä¸‹ç¤ºä¾‹å‡è®¾ RR æ—¶é—´ç‰‡ä¸º 1s</li>
<li>å¹³å‡å“åº”æ—¶é—´ï¼šTr(test1,SJF,[3]) = (0 + 10 + 20) / 3 = 10</li>
<li>å¹³å‡å“åº”æ—¶é—´ï¼šTr(test1,RR,[3]) = (0 + 1 + 2) / 3 = 1</li>
<li>å‡è®¾ RR æ—¶é—´ç‰‡ä¸º 50ms: Tr(test1,RR,[3]) = (0 + 0.05 + 0.1) / 3 = 0.05s</li>
<li>RR æ•ˆç‡çš„å…³é”®å°±æ˜¯æ—¶é—´ç‰‡çš„å¤§å°ï¼Œç„¶é¹…æ—¶é—´ç‰‡å¤ªå°ä¼šé¢‘ç¹åˆ‡æ¢è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œå½±å“æ•´ä½“æ€§èƒ½</li>
<li>æ‘Šé”€æŠ€æœ¯ï¼šå°†æ—¶é—´ç‰‡çš„å¤§å°ä¸åˆ‡æ¢ä¸Šä¸‹æ–‡æ—¶é—´æ¯”è¾ƒï¼Œ1ms/10ms _ 100% = 10% =&gt; å¤ªå¤§ï¼›1ms/100ms _ 100% = 1% =&gt; å¯ä»¥è€ƒè™‘</li>
<li>å¹³å‡å‘¨è½¬æ—¶é—´ï¼šTt(test1,RR,[3]) = (26 + 28 + 30) / 3 = 28s â€¼ï¸ å‘¨è½¬æ—¶é—´å¤ªå¯æ€•æƒ¹</li>
</ul>
<blockquote>
<p>ä¸¤ç§è°ƒåº¦ç¨‹åºï¼šSJF,STCF ä¼˜åŒ–äº†å‘¨è½¬æ—¶é—´ï¼Œä¸åˆ©äºå“åº”æ—¶é—´ï¼›RR ä¼˜åŒ–äº†å“åº”æ—¶é—´ï¼Œä¸åˆ©äºå‘¨è½¬æ—¶é—´ï¼Œæ¥ä¸‹æ¥éœ€è¦æ”¾å¼€å‡è®¾ 4 å’Œå‡è®¾ 5</p>
</blockquote>
<pre><code>ç»“åˆI/O: é‡å ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹è¢«I/Oé˜»å¡ï¼ŒCPUå¯ä»¥åˆ‡æ¢å…¶ä»–è¿›ç¨‹è¿è¡Œ
å·¥ä½œè¿›ç¨‹å‡è®¾ï¼šA 50ms è¿è¡Œ10ms å‘å‡ºI/O; B 50ms æ²¡æœ‰I/O</code></pre>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ²¡æœ‰é‡å </span></span><br><span class="line">     A   A   A   A  A  B B B B B</span><br><span class="line">CPU: --  --  --  --  --||||||||||</span><br><span class="line">I/O:   --  --  --  --</span><br><span class="line"><span class="comment"># é‡å å</span></span><br><span class="line">CPU: --||--||--||--||--||</span><br><span class="line">I/O:   --  --  --  --</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®é™…ä¸Šè°ƒåº¦ç¨‹åºå¹¶ä¸çŸ¥é“æ¯ä¸ªå·¥ä½œçš„é•¿åº¦ï¼Œä¸‹ä¸€ç« å°†é€šè¿‡æ„å»ºä¸€ä¸ªè°ƒåº¦ç¨‹åºåˆ©ç”¨æœ€è¿‘çš„ä½¿ç”¨æƒ…å†µé¢„æµ‹æœªæ¥ä»è€Œè§£å†³æœªçŸ¥å·¥ä½œé•¿åº¦çš„é—®é¢˜ï¼šå¤šçº§åé¦ˆé˜Ÿåˆ—</p>
</blockquote>
<h4 id="å¤šçº§åé¦ˆé˜Ÿåˆ—-Multi-level-Feedback-Queue"><a href="#å¤šçº§åé¦ˆé˜Ÿåˆ—-Multi-level-Feedback-Queue" class="headerlink" title="å¤šçº§åé¦ˆé˜Ÿåˆ—(Multi-level Feedback Queue)"></a>å¤šçº§åé¦ˆé˜Ÿåˆ—(Multi-level Feedback Queue)</h4><p>è¿™æ˜¯æˆ‘é‡åˆ°çš„ç¬¬äºŒä¸ªå¤šçº§ï¼ŒçœŸæ˜¯ç›¸å½“ç¾å¦™çš„æ€æƒ³ï¼Œç¬¬ä¸€ä¸ªå¤šçº§æ˜¯å¤šçº§é¡µè¡¨ï¼ˆè¿™æœ¬ä¹¦å®ƒå‡ºç°åœ¨ç¬¬äºŒç« ï¼Œæˆ‘å‘èª“æˆ‘æ²¡æœ‰è·³ç€çœ‹ä¹¦ ğŸ¶ï¼‰</p>
<blockquote>
<p>å¤šçº§åé¦ˆé˜Ÿåˆ—è¦è§£å†³ 2 ä¸ªé—®é¢˜ï¼šä¼˜åŒ–å‘¨è½¬æ—¶é—´ &amp;&amp; é™ä½å“åº”æ—¶é—´ =&gt; ä»å†å²ä¸­å­¦ä¹ å¹¶é¢„æµ‹</p>
</blockquote>
<pre><code>MLFQåŸºæœ¬è§„åˆ™ï¼š
MLFQæœ‰è®¸å¤šç‹¬ç«‹çš„é˜Ÿåˆ—(queue),æ¯ä¸ªé˜Ÿåˆ—æœ‰ä¸åŒçš„ä¼˜å…ˆçº§(priority level)ã€‚ä¸€ä¸ªè¿›ç¨‹åªèƒ½åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼ŒMLFQæ€»æ˜¯ä¼˜å…ˆæ‰§è¡Œè¾ƒé«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œæ¯ä¸ªé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹éƒ½æ‹¥æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ã€‚
MLFQçš„å…³é”®åœ¨äºå¦‚ä½•è®¾ç½®ä¼˜å…ˆçº§ã€‚
è§„åˆ™1ï¼šè‹¥Açš„ä¼˜å…ˆçº§ &gt; Bçš„ä¼˜å…ˆçº§ï¼Œè¿è¡ŒA
è§„åˆ™2ï¼šå¦‚æœAçš„ä¼˜å…ˆçº§ == Bçš„ä¼˜å…ˆçº§ï¼ŒRRï¼ˆè½®è½¬ï¼‰è¿è¡Œ</code></pre>
<blockquote>
<p>åˆšå®šä¸‹ 2 ä¸ªè§„åˆ™å°±å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šAB ä¸¤ä¸ªè¿›ç¨‹åœ¨é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ï¼ŒCD ä¸¤ä¸ªè¿›ç¨‹åœ¨ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ï¼Œå‡è®¾ AB ä»»åŠ¡ä¸€ç›´è¿è¡Œï¼ŒCD å²‚ä¸æ˜¯ç­‰åˆ°æ­»éƒ½æ²¡æ³•è¿è¡Œ</p>
</blockquote>
<pre><code>å¦‚ä½•æ”¹å˜ä¼˜å…ˆçº§ï¼š
å…ˆè€ƒè™‘å·¥ä½œè´Ÿè½½çš„ç±»å‹ï¼š1.è¿è¡Œæ—¶é—´çŸ­ï¼Œé¢‘ç¹æ”¾å¼ƒCPUçš„äº¤äº’å‹å·¥ä½œï¼›2.éœ€è¦æ›´å¤šCPUæ—¶é—´ï¼Œå“åº”æ—¶é—´ä¸é‡è¦çš„é•¿æ—¶é—´è®¡ç®—å¯†é›†å‹å·¥ä½œã€‚
æ‰€ä»¥è°ƒæ•´ç®—æ³•ï¼Œå¢åŠ è§„åˆ™ï¼š
è§„åˆ™3ï¼šå·¥ä½œè¿›å…¥ç³»ç»Ÿï¼Œæ”¾åˆ°æœ€é«˜ä¼˜å…ˆçº§ - å•ä¸ªé•¿å·¥ä½œï¼ˆå¯†é›†è®¡ç®—å‹ï¼‰
è§„åˆ™4aï¼šå·¥ä½œç”¨å®Œæ•´ä¸ªæ—¶é—´ç‰‡åï¼Œé™ä½åˆ°ä¸‹ä¸€ä¸ªä¼˜å…ˆçº§ - é•¿å·¥ä½œè¿è¡Œä¸€æ®µæ—¶é—´æ¥äº†ä¸€ä¸ªçŸ­å·¥ä½œï¼ˆäº¤äº’å‹ï¼‰
è§„åˆ™4bï¼šå¦‚æœå·¥ä½œåœ¨æ—¶é—´ç‰‡å†…åŠ¨é‡Šæ”¾CPUï¼Œåˆ™ä¼˜å…ˆçº§ä¸å˜ - äº¤äº’å‹çŸ­å·¥ä½œæ‰§è¡Œå¤§é‡I/Oæ“ä½œ
ä»¥ä¸Šå®ä¾‹çš†è¿è¡Œè‰¯å¥½ï¼Œä½†æ˜¯ä¼šå‡ºç°é•¿å·¥ä½œçš„é¥¥é¥¿é—®é¢˜ï¼š
ç³»ç»Ÿä¸­å‡ºç°äº†å¤§é‡çš„äº¤äº’å‹çŸ­å·¥ä½œï¼Œå¯¼è‡´é•¿å·¥ä½œæ— æ³•å¾—åˆ°CPU
||
æå‡ä¼˜å…ˆçº§ï¼šSå¤ªé«˜é•¿å·¥ä½œä¼šé¥¿æ­»ï¼Œå¤ªä½äº¤äº’å‹å·¥ä½œå¾—ä¸åˆ°åˆé€‚çš„CPUæ—¶é—´æ¯”ä¾‹
è§„åˆ™5ï¼šå‘¨æœŸæ€§æå‡æ‰€æœ‰å·¥ä½œçš„ä¼˜å…ˆçº§ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´Sï¼Œå°†ç³»ç»Ÿä¸­çš„ç´ æœ‰å·¥ä½œé‡æ–°åŠ å…¥æœ€é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—
æ›´å¥½çš„è®¡æ—¶æ–¹å¼ï¼šä¿®æ”¹è§„åˆ™4a &amp; 4b:
è§„åˆ™4ï¼šä¸€æ—¦å·¥ä½œç”¨æ¥äº†æŸä¸€å±‚çš„æ—¶é—´é…é¢ï¼ˆæ— è®ºä¸­é—´ä¸»åŠ¨æ”¾å¼ƒäº†å¤šå°‘æ¬¡CPUï¼‰ï¼Œå°±é™ä½ä¼˜å…ˆçº§ =&gt; é˜²æ­¢æ¶æ„ç¨‹åºæ„šå¼„CPU</code></pre>
<blockquote>
<p>MLFQ è°ƒä¼˜åŠå…¶ä»–é—®é¢˜</p>
</blockquote>
<ol>
<li><p>é…ç½®å¤šå°‘ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Ÿ</p>
</li>
<li><p>æ¯ä¸€å±‚é˜Ÿåˆ—çš„æ—¶é—´ç‰‡è®¾ç½®ä¸ºå¤šå¤§ï¼Ÿ</p>
</li>
<li><p>å¤šä¹…æå‡ä¸€æ¬¡è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Ÿ</p>
<p>å¤§å¤šæ•°çš„ MLFQ å˜ä½“éƒ½æ”¯æŒä¸åŒé˜Ÿåˆ—å¯å˜çš„æ—¶é—´ç‰‡é•¿åº¦ã€‚é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—é€šå¸¸åªæœ‰è¾ƒçŸ­çš„æ—¶é—´ç‰‡ï¼Œå› æ­¤è¿™ä¸€å±‚çš„äº¤äº’å·¥ä½œå¯ä»¥æ›´å¿«çš„åˆ‡æ¢ï¼Œç›¸åï¼Œä½ä¼˜å…ˆçº§é˜Ÿåˆ—æ›´å¤šçš„æ˜¯å¯†é›†å‹å·¥ä½œ</p>
</li>
</ol>
<h4 id="æ¯”ä¾‹ä»½é¢"><a href="#æ¯”ä¾‹ä»½é¢" class="headerlink" title="æ¯”ä¾‹ä»½é¢"></a>æ¯”ä¾‹ä»½é¢</h4><h4 id="å¤šå¤„ç†å™¨è°ƒåº¦"><a href="#å¤šå¤„ç†å™¨è°ƒåº¦" class="headerlink" title="å¤šå¤„ç†å™¨è°ƒåº¦"></a>å¤šå¤„ç†å™¨è°ƒåº¦</h4><h3 id="ç¬¬äºŒèŠ‚-å†…å­˜è™šæ‹ŸåŒ–"><a href="#ç¬¬äºŒèŠ‚-å†…å­˜è™šæ‹ŸåŒ–" class="headerlink" title="ç¬¬äºŒèŠ‚ - å†…å­˜è™šæ‹ŸåŒ–"></a>ç¬¬äºŒèŠ‚ - å†…å­˜è™šæ‹ŸåŒ–</h3><h4 id="åœ°å€ç©ºé—´"><a href="#åœ°å€ç©ºé—´" class="headerlink" title="åœ°å€ç©ºé—´"></a>åœ°å€ç©ºé—´</h4><h4 id="å†…å­˜æ“ä½œ-API"><a href="#å†…å­˜æ“ä½œ-API" class="headerlink" title="å†…å­˜æ“ä½œ API"></a>å†…å­˜æ“ä½œ API</h4><h4 id="åœ°å€è½¬æ¢"><a href="#åœ°å€è½¬æ¢" class="headerlink" title="åœ°å€è½¬æ¢"></a>åœ°å€è½¬æ¢</h4><ol>
<li>åˆ†æ®µ</li>
<li>åˆ†é¡µ</li>
</ol>
<ul>
<li>å¿«é€Ÿåœ°å€è½¬æ¢</li>
<li>è¾ƒå°çš„è¡¨</li>
</ul>
<ol start="3">
<li>äº¤æ¢ç©ºé—´</li>
</ol>
<ul>
<li>è™šæ‹ŸåŒ–ç£ç›˜ç©ºé—´</li>
<li>æ›¿æ¢ç­–ç•¥</li>
<li>è™šæ‹Ÿå†…å­˜æŠ€å·§åŠç¤ºä¾‹</li>
</ul>
<h4 id="ç©ºé—²ç©ºé—´ç®¡ç†"><a href="#ç©ºé—²ç©ºé—´ç®¡ç†" class="headerlink" title="ç©ºé—²ç©ºé—´ç®¡ç†"></a>ç©ºé—²ç©ºé—´ç®¡ç†</h4><h2 id="ç¬¬äºŒç« -å¹¶å‘"><a href="#ç¬¬äºŒç« -å¹¶å‘" class="headerlink" title="ç¬¬äºŒç«  - å¹¶å‘"></a>ç¬¬äºŒç«  - å¹¶å‘</h2><h3 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h3><h3 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h3><h3 id="åŸºäºå¹¶å‘çš„æ•°æ®ç»“æ„"><a href="#åŸºäºå¹¶å‘çš„æ•°æ®ç»“æ„" class="headerlink" title="åŸºäºå¹¶å‘çš„æ•°æ®ç»“æ„"></a>åŸºäºå¹¶å‘çš„æ•°æ®ç»“æ„</h3><h3 id="æ¡ä»¶å˜é‡"><a href="#æ¡ä»¶å˜é‡" class="headerlink" title="æ¡ä»¶å˜é‡"></a>æ¡ä»¶å˜é‡</h3><h3 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h3><h3 id="å¸¸è§å¹¶å‘é—®é¢˜"><a href="#å¸¸è§å¹¶å‘é—®é¢˜" class="headerlink" title="å¸¸è§å¹¶å‘é—®é¢˜"></a>å¸¸è§å¹¶å‘é—®é¢˜</h3><h3 id="åŸºäºäº‹ä»¶çš„å¹¶å‘"><a href="#åŸºäºäº‹ä»¶çš„å¹¶å‘" class="headerlink" title="åŸºäºäº‹ä»¶çš„å¹¶å‘"></a>åŸºäºäº‹ä»¶çš„å¹¶å‘</h3><h4 id="äº‹ä»¶å¾ªç¯ï¼š"><a href="#äº‹ä»¶å¾ªç¯ï¼š" class="headerlink" title="äº‹ä»¶å¾ªç¯ï¼š"></a>äº‹ä»¶å¾ªç¯ï¼š</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼ªä»£ç </span></span><br><span class="line"><span class="keyword">while</span>(1) &#123;</span><br><span class="line">  events = getEvents()</span><br><span class="line">  <span class="keyword">for</span> (e <span class="keyword">in</span> events)</span><br><span class="line">    processEvents(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨å¦‚ä½•å†³å®šäº‹ä»¶çš„å‘ç”Ÿé¡ºåºï¼Ÿå°¤å…¶æ˜¯ç½‘ç»œå’Œ I/O</p>
</blockquote>
<pre><code>è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¾‹å­ï¼Œæ¥é¦–å…ˆäº†è§£ä¸€ä¸‹select()å‡½æ•°ï¼šè¿™ä¸ªä¾‹å­æ˜¯ä»CSAPPä¸ŠæŠ„æ¥çš„ï¼ŒselectçœŸæ˜¯ä»¤äººå°è±¡æ·±åˆ»
å‡è®¾æœ‰ä¸€ä¸ªechoæœåŠ¡å™¨ï¼Œå®ƒå¾ˆå¼ºï¼Œä¸€è¾¹æ¥æ”¶ç½‘ç»œè¯·æ±‚ï¼Œä¸€è¾¹ä¹Ÿå¯ä»¥å“åº”ç”¨æˆ·çš„å‘½ä»¤è¡Œé”®å…¥è¯·æ±‚ã€‚è‚¿ä¹ˆåŠæï¼Œå…ˆå¤„ç†å“ªä¸€ä¸ªï¼Ÿæ›´å…·ä½“çš„ä»£ç ç¤ºä¾‹è¯·å‚è€ƒ`ã€ŠCSAPPã€‹ç¬¬12ç« ç¬¬2èŠ‚åŸºäºI/Oå¤šè·¯å¤ç”¨çš„å¹¶å‘ç¼–ç¨‹`
åŸºäºI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„å¹¶å‘ï¼šä½¿ç”¨select(),è¦æ±‚å†…æ ¸æŒ‚èµ·è¿›ç¨‹ï¼Œåªæœ‰åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªI/Oå‘ç”Ÿåæ‰å°†æ§åˆ¶æƒè¿”å›ç»™åº”ç”¨ç¨‹åºï¼ˆè¯´äººè¯ï¼šå¤šä¸ªI/Oè¯·æ±‚æ³¨å†Œåˆ°åŒä¸€ä¸ªselect, selectæä¸€ä¸ªé›†åˆå­˜å‚¨ä»–ä»¬çš„çŠ¶æ€ï¼Œåªè¦æœ‰I/Oè§¦å‘é‚£ä¹ˆå°±ç”±ç³»ç»Ÿè°ƒç”¨è½¬å›åº”ç”¨ç¨‹åºï¼ˆç”¨æˆ·æ¨¡å¼ï¼‰ï¼‰ã€‚</code></pre>
<h4 id="é‡è¦-API-select-or-poll-ç³»ç»Ÿè°ƒç”¨"><a href="#é‡è¦-API-select-or-poll-ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="é‡è¦ API: select() or poll() ç³»ç»Ÿè°ƒç”¨"></a>é‡è¦ API: select() or poll() ç³»ç»Ÿè°ƒç”¨</h4><pre><code>select() æ£€æŸ¥I/Oæè¿°ç¬¦é›†åˆ, åœ°å€é€šè¿‡`readfds`,`writefds`, `errorfds`ä¼ å…¥ï¼›
åœ¨æ¯ä¸ªé›†åˆä¸­æ£€æŸ¥å‰nfdsä¸ªæè¿°ç¬¦ã€‚
è¿”å›æ—¶ï¼Œselect()ç”¨ç»™å®šè¯·æ±‚æ“ä½œå‡†å¤‡å¥½çš„æè¿°ç¬¦ç»„æˆçš„å­é›†æ›¿æ¢ç»™å®šçš„æè¿°ç¬¦é›†åˆï¼Œè¿”å›æ‰€æœ‰é›†åˆä¸­å°±ç»ªæè¿°ç¬¦çš„æ€»æ•°ã€‚</code></pre>
<blockquote>
<p>è¯·æ³¨æ„ select()çš„è¶…æ—¶å‚æ•°ï¼Œå¸¸è§ç”¨æ³•æ˜¯è®¾ç½®ä¸º NULL,ä½†ä¼šå¯¼è‡´æ— é™æœŸé˜»å¡ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„å°±ç»ªæè¿°ç¬¦ã€‚æ›´å¥½çš„åšæ³•æ˜¯å°†è¶…æ—¶è®¾ç½®ä¸º 0ï¼Œå› æ­¤è®©è°ƒç”¨çš„ select()ç«‹å³è¿”å›ï¼Œè¿™ç§æ–¹å¼æä¾›äº†ä¸€ç§æ„å»ºéé˜»å¡ï¼ˆå¼‚æ­¥ï¼‰äº‹ä»¶å¾ªç¯çš„æ–¹æ³•ã€‚</p>
</blockquote>
<pre><code>è¡¥å……ï¼šé˜»å¡ä¸éé˜»å¡æ¥å£
é˜»å¡ï¼ˆåŒæ­¥ï¼‰æ¥å£ï¼šåœ¨è¿”å›ç»™è°ƒç”¨è€…ä¹‹å‰å®Œæˆæ‰€æœ‰å·¥ä½œï¼Œéé˜»å¡ï¼ˆå¼‚æ­¥ï¼‰æ¥å£å¼€å§‹ä¸€äº›å·¥ä½œä½†æ˜¯ç«‹å³è¿”å›ï¼Œä»è€Œè®©æ‰€æœ‰éœ€è¦å®Œæˆçš„å·¥ä½œéƒ½åœ¨åå°å®Œæˆã€‚
é€šå¸¸é˜»å¡è°ƒç”¨çš„å°±æ˜¯æŸç§I/Oã€‚
éé˜»å¡æ¥å£å¯ç”¨äºä»»ä½•ç±»å‹çš„ç¼–ç¨‹ï¼ˆä¾‹å¦‚ä½¿ç”¨çº¿ç¨‹ï¼‰ï¼Œä½†åœ¨åŸºäºäº‹ä»¶çš„æ–¹æ³•ä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºé˜»å¡çš„è°ƒç”¨ä¼šé˜»å¡æ‰€æœ‰è¿›å±•ã€‚</code></pre>
<blockquote>
<p>â€¼ï¸ è¦åˆ†æ¸…æ¥šå¹¶ä¸æ˜¯æ‰€æœ‰çš„éé˜»å¡=å¼‚æ­¥ï¼ŒI/O å°±ä¸æ˜¯ï¼Œéé˜»å¡ I/O!==å¼‚æ­¥ I/O</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨å•ä¸ª CPU å’ŒåŸºäºäº‹ä»¶çš„å¹¶å‘æœåŠ¡å™¨ï¼Œçº¿ç¨‹å¹¶å‘çš„ç¨‹åºä¸­å­˜åœ¨çš„æŠ¢å é”é‡Šæ”¾é”ç­‰é—®é¢˜ä¸å¤å­˜åœ¨ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ï¼Œä½†æ˜¯è¯·åŠ¡å¿…è®°ä½â€¼ï¸ ä¸è¦é˜»å¡åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨ï¼Œå³ node ä¸­ï¼Œå°å¿ƒä½¿ç”¨åŒæ­¥ api.</p>
</blockquote>
<blockquote>
<p>é˜»å¡ç³»ç»Ÿçš„è°ƒç”¨ï¼šI/O å¤§ boss å¦‚ä½•è§£å†³ï¼Ÿ</p>
</blockquote>
<h4 id="å¼‚æ­¥-I-O-Asyncchronous-I-O"><a href="#å¼‚æ­¥-I-O-Asyncchronous-I-O" class="headerlink" title="å¼‚æ­¥ I/O(Asyncchronous I/O):"></a>å¼‚æ­¥ I/O(Asyncchronous I/O):</h4><ol>
<li>å‘å‡ºå¼‚æ­¥è¯»å–</li>
<li>å¦‚ä½•æ‰èƒ½çŸ¥é“ I/O å·²ç»å®Œæˆï¼Œå¹¶ä¸”ç¼“å†²åŒº(aio_buf)å·²ç»æœ‰äº†æ•°æ®: aio_error ç³»ç»Ÿè°ƒç”¨æ£€æŸ¥ aiocbp å¼•ç”¨çš„è¯·æ±‚æ˜¯å¦å·²ç»å®Œæˆï¼Œå¦‚æœå®Œæˆåˆ™å‡½æ•°è¿”å›æˆåŠŸ <strong><em>ï¼ˆç”¨ 0 è¡¨ç¤ºï¼‰</em></strong>,å¦åˆ™è¿”å› EINPROGRESSã€‚å¯¹äºæ¯ä¸ªæœªå®Œæˆçš„ AIOï¼Œåº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨ aio_error æ¥å‘¨æœŸæ€§çš„è½®è¯¢(poll)ç³»ç»Ÿï¼Œä»¥ç¡®å®šæ‰€è¿° I/O æ˜¯å¦å®Œæˆã€‚è¿™æ¡çœ‹ç€å¾ˆç´¯ï¼Œçœ‹ä¸‹ä¸€æ¡ï¼Œå®è´ã€‚</li>
<li>poll ä¸€ä¸ª I/O å®³è¡Œï¼Œ1000 ä¸ªæææ€•è¦ç´¯å±æƒ¹ï¼Œæ‰€ä»¥æŸäº›ç³»ç»Ÿæä¾›äº† <strong>åŸºäºä¸­æ–­(interrupt)</strong> çš„æ–¹æ³•ã€‚ä½¿ç”¨ UNIX ä¿¡å·(signal)åœ¨å¼‚æ­¥ I/O å®Œæˆæ—¶é€šçŸ¥ä¸€ä¸‹ç¨‹åºï¼Œä»è€Œæ¶ˆé™¤äº†è½®è¯¢çš„ç—›è‹¦ï¼Œä»ä»Šä»¥åå¹¸ç¦å¿«ä¹ ğŸ¥°ã€‚</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AIO control block</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">aiocb</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> aio_fildes; <span class="comment">/* file descriptor */</span></span><br><span class="line">  <span class="keyword">off_t</span> aio_offser; <span class="comment">/* file offset */</span></span><br><span class="line">  <span class="keyword">volatile</span> <span class="keyword">void</span> *aio_buf; <span class="comment">/* location of buffer */</span></span><br><span class="line">  <span class="keyword">size_t</span> aio_nbytes; <span class="comment">/* length of transfer */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AIO ç¬¬ä¸€æ­¥ï¼š å‘æ–‡ä»¶å‘å‡ºå¼‚æ­¥è¯»å–,å‘å‡ºæˆåŠŸåä¼šç«‹å³è¿”å›å¹¶ä¸”åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­å·¥ä½œ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aio_read</span><span class="params">(struct aiocb * aiocbp)</span></span>;</span><br><span class="line"><span class="comment">// AIO ç¬¬äºŒæ­¥ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aio_error</span><span class="params">(<span class="keyword">const</span> struct aiocb *aiocbp)</span></span></span><br></pre></td></tr></table></figure>

<pre><code>è¡¥å……ï¼šUNIXä¿¡å·
ä¿¡å·æä¾›äº†ä¸€ç§ä¸è¿›ç¨‹é€šä¿¡çš„æ–¹å¼ï¼Œå¯ä»¥å°†ä¿¡å·ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼Œè¿›ç¨‹å°†æš‚åœå½“å‰å·¥ä½œå¼€å§‹è¿è¡Œä¿¡å·å¤„ç†ç¨‹åºã€‚å®Œæˆåï¼Œè¯¥è¿›ç¨‹å°±å›å¤å…ˆå‰çš„è¡Œä¸ºã€‚
æ¯ä¸ªä¿¡å·éƒ½æœ‰åå­—ï¼Œå¦‚ï¼šHUP(æŒ‚æ–­),INT(ä¸­æ–­),SEGV(æ®µè¿è§„)
å†…æ ¸æˆ–è€…ç¨‹åºéƒ½å¯ä»¥å‘å‡ºä¿¡å·
å¯ä»¥ç”¨killå‘½ä»¤è¡Œå·¥å…·å‘å‡ºä¿¡å·ï¼Œä¾‹å¦‚ï¼š
prompt &gt; ./main &amp; [3] 36705
prompt &gt; kill -HUP 36705
stop wakin&#39; me up...</code></pre>
<blockquote>
<p>åœ¨æ²¡æœ‰å¼‚æ­¥ I/O çš„ç³»ç»Ÿä¸­ï¼Œçº¯åŸºäºäº‹ä»¶çš„æ–¹æ³•æ— æ³•å®ç°ã€‚ç„¶é¹…å¯ä»¥ä½¿ç”¨æŸç§æ··åˆæ–¹æ³•ï¼Œä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†æœªå®Œæˆçš„ I/Oã€‚å‚è€ƒã€Šflash: an efficient and portable web serverã€‹æ¥äº†è§£æ›´å¤šã€‚</p>
</blockquote>
<h4 id="çŠ¶æ€ç®¡ç†ï¼šåŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªå¤æ‚é—®é¢˜"><a href="#çŠ¶æ€ç®¡ç†ï¼šåŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªå¤æ‚é—®é¢˜" class="headerlink" title="çŠ¶æ€ç®¡ç†ï¼šåŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªå¤æ‚é—®é¢˜"></a>çŠ¶æ€ç®¡ç†ï¼šåŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªå¤æ‚é—®é¢˜</h4><pre><code>å½“äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆäº‹ä»¶å¾ªç¯ä¸­å¾…å¤„ç†çš„ä¸€ä¸ªäº‹ä»¶ï¼‰å‘å‡ºå¼‚æ­¥I/Oæ—¶ï¼Œå¿…é¡»æ‰“åŒ…ä¸€äº›ç¨‹åºçŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºåœ¨I/Oå®Œæˆå®Œæˆæ—¶ä½¿ç”¨ã€‚è€ŒåŸºäºçº¿ç¨‹çš„å·¥ä½œæ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºçŠ¶æ€éƒ½ä¿å­˜åœ¨çº¿ç¨‹æ ˆå†…ã€‚
nodeæ˜¯å¦‚ä½•å¤„ç†è¿™ä¸ªé—®é¢˜çš„ï¼Ÿ
æ®é„™äººçœ‹å®Œçš„ã€Šæ·±å…¥æµ…å‡ºnodejsã€‹åçš„ä¸€äº›ç¬”è®°æ¥çœ‹ï¼Œnodeåªæ˜¯JSè¿è¡Œåœ¨å•çº¿ç¨‹ä¸Šï¼Œå¼‚æ­¥I/Oå¦æœ‰çº¿ç¨‹ï¼š
éƒ¨åˆ†çº¿ç¨‹é€šè¿‡é˜»å¡æˆ–éé˜»å¡&amp;è½®è¯¢æŠ€æœ¯æ¥å®Œæˆæ•°æ®è·å–ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¡ç®—å¤„ç†ï¼Œé€šè¿‡çº¿ç¨‹é—´é€šä¿¡è¿›è¡Œæ•°æ®ä¼ é€’ï¼Œå®ç°å¼‚æ­¥I/Oï¼Œä¹Ÿå°±æ˜¯è¯´nodeå¤„ç†å¼‚æ­¥I/Oæ˜¯é€šè¿‡ç®¡ç†çº¿ç¨‹æ± æ¥å®ç°çš„ã€‚ï¼ˆæ²¡æƒ³åˆ°å§Î£(âŠ™â–½âŠ™&quot;aï¼‰</code></pre>
<h4 id="å¤ªéš¾äº†"><a href="#å¤ªéš¾äº†" class="headerlink" title="å¤ªéš¾äº†"></a>å¤ªéš¾äº†</h4><p>å½“ç³»ç»Ÿæ˜¯å¤šæ ¸ CPU æ—¶ï¼ŒåŸºäºäº‹ä»¶çš„ä¸€äº›ç®€å•æ€§ï¼ˆä¸ç”¨åŠ é”ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸­æ–­ï¼‰å°±æ²¡æœ‰äº†ï¼Œä¸ºäº†åˆ©ç”¨å¤šä¸ª CPUï¼Œäº‹ä»¶æœåŠ¡å™¨å¿…é¡»å¹¶è¡Œè¿è¡Œå¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œè¿™æ—¶ä¼šå‡ºç°ã€Œç¼“å­˜ä¸€è‡´æ€§ã€ï¼Ÿã€ŒåŠ é”ï¼å¿…é¡»åŠ é”!!ã€,ã€Œå‘ç”Ÿç¼ºé¡µè‚¿ä¹ˆåŠï¼è¢«å µæ­»äº†ã€ç­‰å„ç§é—®é¢˜ï¼Œç°åœ¨å…ˆä¸è¦å¿ƒå¡ï¼Œåé¢å¿ƒå¡çš„è¿˜å¤šç€å‘¢ï¼ŒæŠ½å±‰é‡Œæ”¾ç‚¹ç¡é…¸ç”˜æ²¹ç‰‡å•¥çš„ â¤ï¸ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼šåŒæ­¥ I/O åŒ…å«éé˜»å¡ I/O å—ï¼Ÿå¼‚æ­¥ I/O å‘¢ï¼Ÿ</p>
</blockquote>
<p>I/O åŒ…å«ä¸¤æ­¥ï¼šè¯·æ±‚å’Œæ•°æ®å¤åˆ¶åˆ°ç¼“å†²åŒº</p>
<table>
<thead>
<tr>
<th>I/O ç±»å‹</th>
<th>è¯·æ±‚</th>
<th>æ•°æ®å¤åˆ¶åˆ°ç¼“å†²åŒºï¼ˆaio_bufï¼‰</th>
<th>æ£€æŸ¥ I/O æ˜¯å¦å®Œæˆçš„æ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>åŒæ­¥ I/O</td>
<td>é˜»å¡</td>
<td>é˜»å¡</td>
<td>ç­‰å‰ä¸¤æ­¥å®Œæˆä¹Ÿå°±æ‹¿åˆ°äº†</td>
</tr>
<tr>
<td>éé˜»å¡ I/O</td>
<td>å¼‚æ­¥</td>
<td>é˜»å¡</td>
<td>è½®è¯¢ï¼ŒCPU å¾ˆå¿™</td>
</tr>
<tr>
<td>I/O å¤šè·¯å¤ç”¨</td>
<td>å¼‚æ­¥</td>
<td>é˜»å¡</td>
<td>è½®è¯¢ï¼ŒCPU å¾ˆå¿™ï¼ˆlinux: epoll;ï¼‰</td>
</tr>
<tr>
<td>å¼‚æ­¥ I/O</td>
<td>å¼‚æ­¥</td>
<td>å¼‚æ­¥</td>
<td>ä¸­æ–­æ—¶å‘ä¿¡å·(windows:IOCP)</td>
</tr>
</tbody></table>
<h4 id="æŠ€æœ¯æ€»ç»“ï¼šç»„åˆä½¿ç”¨ç”¨äºç½‘ç»œçš„-select-æ¥å£å’Œç”¨äºç£ç›˜çš„-AIO-çš„è°ƒç”¨ï¼ˆæˆ‘çŒœ-node-å°±æ˜¯è¿™æ ·ï¼‰"><a href="#æŠ€æœ¯æ€»ç»“ï¼šç»„åˆä½¿ç”¨ç”¨äºç½‘ç»œçš„-select-æ¥å£å’Œç”¨äºç£ç›˜çš„-AIO-çš„è°ƒç”¨ï¼ˆæˆ‘çŒœ-node-å°±æ˜¯è¿™æ ·ï¼‰" class="headerlink" title="æŠ€æœ¯æ€»ç»“ï¼šç»„åˆä½¿ç”¨ç”¨äºç½‘ç»œçš„ select()æ¥å£å’Œç”¨äºç£ç›˜çš„ AIO çš„è°ƒç”¨ï¼ˆæˆ‘çŒœ node å°±æ˜¯è¿™æ ·ï¼‰"></a>æŠ€æœ¯æ€»ç»“ï¼šç»„åˆä½¿ç”¨ç”¨äºç½‘ç»œçš„ select()æ¥å£å’Œç”¨äºç£ç›˜çš„ AIO çš„è°ƒç”¨ï¼ˆæˆ‘çŒœ node å°±æ˜¯è¿™æ ·ï¼‰</h4><p>node åŸºäº I/Oï¼ˆAIOï¼ˆé€šè¿‡çº¿ç¨‹æ± æ¥å®ç°å¼‚æ­¥ I/Oï¼‰ï¼‰å¤šè·¯å¤ç”¨ï¼Œæ‰€ä»¥æ˜¯<strong>å•çº¿ç¨‹ï¼ˆJSï¼‰ã€éé˜»å¡ã€å¼‚æ­¥ I/O</strong>ï¼ŒJS è¿è¡Œçš„å•çº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œä½†æ˜¯ I/O è¿‡ç¨‹æœ‰å¯èƒ½æ˜¯é˜»å¡çš„ï¼Œä¸€æ—¦é‡åˆ°ç¼ºé¡µå°±ä¼šå¡ä½ï¼Œå°±ç®—ä¸»åŠ¨å»éæ´²å®¢æˆ·ä¹Ÿä¸ä¼šåŸè°…ä½ ï¼ŒOMG ç”Ÿæ´»çœŸæ˜¯è‹¦æ¶©ã€‚</p>
<blockquote>
<p>æ€è€ƒ: node å•çº¿ç¨‹æ˜¯æ€ä¹ˆå®ç°å¹¶å‘çš„ï¼Ÿ</p>
</blockquote>
<pre><code>nodejsä½¿ç”¨cluster(é›†ç¾¤)åˆ›å»ºå¤šä¸ªå…±äº«æœåŠ¡å™¨ç«¯å£çš„child progressæ¥åˆ©ç”¨å¤šæ ¸CPUç³»ç»Ÿ
åŸç†æ˜¯ï¼šchild_process.fork()è¡ç”Ÿçš„æ˜¯ç‹¬ç«‹çš„child progressï¼Œå’Œ parent progressåªé€šè¿‡IPCç®¡é“æ¥é€šä¿¡ï¼Œå¯ä»¥æ ¹æ®éœ€è¦éšæ—¶å…³é—­æˆ–è€…åˆ›å»ºï¼Œä¸å½±å“å…¶ä»–è¿›ç¨‹ã€‚
clusteråˆ†å‘è¿æ¥ï¼šä¸»è¿›ç¨‹è´Ÿè´£ç›‘å¬æ¥å£ï¼Œç„¶åå¾ªç¯åˆ†å‘ç»™å„child progressã€‚</code></pre>
<blockquote>
<p>æ€è€ƒï¼šå¤šä¸ªè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥å…±äº«æœåŠ¡å™¨ç«¯å£ï¼Ÿ</p>
</blockquote>
<pre><code>é¦–å…ˆè¦çŸ¥é“ç›‘å¬æè¿°ç¬¦å’Œå·²è¿æ¥æè¿°çš„åŒºåˆ«ï¼Œæ˜¯å¹¶å‘æœåŠ¡å™¨çš„åŸºç¡€ï¼Œæ¯æ¬¡ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾ç›‘å¬æè¿°ç¬¦æ—¶ï¼Œå¯ä»¥åœ¨æ­¤æ—¶æ´¾å‘fork()ä¸€ä¸ªæ–°è¿›ç¨‹æ¥è¿æ¥å·²è¿æ¥æè¿°ç¬¦ä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚æœåŠ¡å™¨è°ƒç”¨server.listen(&#123;fd:7&#125;)å°†æ¶ˆæ¯å‘ç»™ä¸»è¿›ç¨‹ï¼Œparent progresså°†ç›‘å¬ç›‘å¬æè¿°ç¬¦å¹¶å°†å¥æŸ„ï¼ˆhandleï¼‰æ´¾å‘ç»™child progressï¼Œchild progressè°ƒç”¨server.listen(handle)ä¼šæ˜¾å¼ç›‘å¬handleè€Œä¸æ˜¯ä¸ parent progressé€šä¿¡ï¼Œchild progressè¿˜ä¼šè°ƒç”¨server.listen(0)ä¼šæ”¶åˆ°ç›¸åŒçš„ã€Œéšæœºç«¯å£ã€ï¼Œéšæœºç«¯å£åœ¨ç¬¬ä¸€æ¬¡éšæœºåˆ†é…ï¼Œè€Œåéƒ½æ˜¯å·²çŸ¥çš„ã€‚
å¦‚æœéœ€è¦ç‹¬ç«‹ç«¯å£ï¼Œå¯æ ¹æ®child progressçš„PIDæ¥ç”Ÿæˆã€‚</code></pre>
<blockquote>
<p>æ€è€ƒ again: nodejs ä¸»è¿›ç¨‹æŒ‚äº†è‚¿ä¹ˆåŠï¼Ÿæ‰€æœ‰ç›¸å…³ child progress ä¼šä¸€èµ·è¢«å›æ”¶è¿˜æ˜¯ç§»äº¤ç»™ä¸»è¿›ç¨‹æŒ‚æ‰æ—¶ç«‹å³é‡å¯ä¸€ä¸ªæ–°çš„ parent progress å‘¢ï¼Ÿ</p>
</blockquote>
<pre><code>child progressæ­»äº¡ä¸ä¼šå½±å“ parent progress, ä¸è¿‡child progressæ­»äº¡æ—¶ï¼ˆçº¿ç¨‹ç»„çš„æœ€åä¸€ä¸ªçº¿ç¨‹ï¼Œé€šå¸¸æ˜¯â€œé¢†å¤´â€çº¿ç¨‹æ­»äº¡æ—¶ï¼‰ï¼Œä¼šå‘å®ƒçš„ parent progresså‘é€æ­»äº¡ä¿¡å·. åä¹‹ parent progressæ­»äº¡, ä¸€èˆ¬æƒ…å†µä¸‹child progressä¹Ÿä¼šéšä¹‹æ­»äº¡, ä½†å¦‚æœæ­¤æ—¶child progresså¤„äºå¯è¿è¡Œæ€ã€åƒµæ­»çŠ¶æ€ç­‰ç­‰çš„è¯, child progresså°†è¢«è¿›ç¨‹1ï¼ˆinit è¿›ç¨‹ï¼Œç”±å†…æ ¸åˆ›å»ºï¼Œæ˜¯æ‰€æœ‰è¿›ç¨‹çš„ç¥–å…ˆï¼‰æ”¶å…»ï¼Œä»è€Œæˆä¸ºå­¤å„¿è¿›ç¨‹. å¦å¤–, child progressæ­»äº¡çš„æ—¶å€™ï¼ˆå¤„äºâ€œç»ˆæ­¢çŠ¶æ€â€ï¼‰ï¼Œparent progressæ²¡æœ‰åŠæ—¶è°ƒç”¨ wait() æˆ– waitpid() æ¥è¿”å›æ­»äº¡è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼Œæ­¤æ—¶child progressè¿˜æœ‰ä¸€ä¸ª PCB (Process Control Blockè¿›ç¨‹æ§åˆ¶ç»“æ„)æ®‹ç•™åœ¨è¿›ç¨‹è¡¨ä¸­ï¼Œè¢«ç§°ä½œåƒµå°¸è¿›ç¨‹.</code></pre>
<blockquote>
<p>æ€è€ƒï¼šè®©æˆ‘ä»¬æ¥æƒ³æƒ³ <strong><em>nodejs è¿›ç¨‹ç®¡ç†</em></strong> æ˜¯æ€ä¹ˆå®ç°çš„?</p>
</blockquote>
<h2 id="ç¬¬ä¸‰ç« -æŒä¹…æ€§"><a href="#ç¬¬ä¸‰ç« -æŒä¹…æ€§" class="headerlink" title="ç¬¬ä¸‰ç«  - æŒä¹…æ€§"></a>ç¬¬ä¸‰ç«  - æŒä¹…æ€§</h2><h3 id="I-O-è®¾å¤‡"><a href="#I-O-è®¾å¤‡" class="headerlink" title="I/O è®¾å¤‡"></a>I/O è®¾å¤‡</h3><h3 id="ç£ç›˜é©±åŠ¨å™¨"><a href="#ç£ç›˜é©±åŠ¨å™¨" class="headerlink" title="ç£ç›˜é©±åŠ¨å™¨"></a>ç£ç›˜é©±åŠ¨å™¨</h3><h3 id="RAID-å†—ä½™ç£ç›˜é˜µåˆ—"><a href="#RAID-å†—ä½™ç£ç›˜é˜µåˆ—" class="headerlink" title="RAID å†—ä½™ç£ç›˜é˜µåˆ—"></a>RAID å†—ä½™ç£ç›˜é˜µåˆ—</h3><h3 id="æ–‡ä»¶ä¸ç›®å½•"><a href="#æ–‡ä»¶ä¸ç›®å½•" class="headerlink" title="æ–‡ä»¶ä¸ç›®å½•"></a>æ–‡ä»¶ä¸ç›®å½•</h3><h3 id="æ–‡ä»¶ç³»ç»Ÿçš„å®ç°"><a href="#æ–‡ä»¶ç³»ç»Ÿçš„å®ç°" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿçš„å®ç°"></a>æ–‡ä»¶ç³»ç»Ÿçš„å®ç°</h3><h4 id="å±€éƒ¨æ€§å’Œå¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ"><a href="#å±€éƒ¨æ€§å’Œå¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="å±€éƒ¨æ€§å’Œå¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ"></a>å±€éƒ¨æ€§å’Œå¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ</h4><h4 id="å´©æºƒä¸€è‡´æ€§"><a href="#å´©æºƒä¸€è‡´æ€§" class="headerlink" title="å´©æºƒä¸€è‡´æ€§"></a>å´©æºƒä¸€è‡´æ€§</h4><h4 id="æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ"></a>æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ</h4><h4 id="æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤"><a href="#æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤" class="headerlink" title="æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤"></a>æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤</h4><h4 id="æ€è€ƒï¼šæ•°æ®åº“"><a href="#æ€è€ƒï¼šæ•°æ®åº“" class="headerlink" title="æ€è€ƒï¼šæ•°æ®åº“"></a>æ€è€ƒï¼šæ•°æ®åº“</h4><h2 id="åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><h3 id="é€šä¿¡åŸºç¡€"><a href="#é€šä¿¡åŸºç¡€" class="headerlink" title="é€šä¿¡åŸºç¡€"></a>é€šä¿¡åŸºç¡€</h3><h3 id="Sun-çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ-NFS-Network-File-System"><a href="#Sun-çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ-NFS-Network-File-System" class="headerlink" title="Sun çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ NFS (Network File System)"></a>Sun çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ NFS (Network File System)</h3><h3 id="Andrew-æ–‡ä»¶ç³»ç»Ÿ-AFS"><a href="#Andrew-æ–‡ä»¶ç³»ç»Ÿ-AFS" class="headerlink" title="Andrew æ–‡ä»¶ç³»ç»Ÿ AFS"></a>Andrew æ–‡ä»¶ç³»ç»Ÿ AFS</h3><h3 id="æ€è€ƒï¼šä¸è®¡ç®—æœºç½‘ç»œçš„è”ç³»"><a href="#æ€è€ƒï¼šä¸è®¡ç®—æœºç½‘ç»œçš„è”ç³»" class="headerlink" title="æ€è€ƒï¼šä¸è®¡ç®—æœºç½‘ç»œçš„è”ç³»"></a>æ€è€ƒï¼šä¸è®¡ç®—æœºç½‘ç»œçš„è”ç³»</h3><h4 id="TCP-ä¸-UDP-çš„æ¯”è¾ƒ"><a href="#TCP-ä¸-UDP-çš„æ¯”è¾ƒ" class="headerlink" title="TCP ä¸ UDP çš„æ¯”è¾ƒ"></a>TCP ä¸ UDP çš„æ¯”è¾ƒ</h4><h4 id="TCP-æ¡æ‰‹æŒ¥æ‰‹æœºåˆ¶"><a href="#TCP-æ¡æ‰‹æŒ¥æ‰‹æœºåˆ¶" class="headerlink" title="TCP æ¡æ‰‹æŒ¥æ‰‹æœºåˆ¶"></a>TCP æ¡æ‰‹æŒ¥æ‰‹æœºåˆ¶</h4><h4 id="TCP-ä¸-UDP-çš„ä¸¢åŒ…å¤„ç†"><a href="#TCP-ä¸-UDP-çš„ä¸¢åŒ…å¤„ç†" class="headerlink" title="TCP ä¸ UDP çš„ä¸¢åŒ…å¤„ç†"></a>TCP ä¸ UDP çš„ä¸¢åŒ…å¤„ç†</h4><h4 id="å®è·µï¼šå±€éƒ¨ç½‘ç»œä¸­çš„é€šä¿¡-wireless"><a href="#å®è·µï¼šå±€éƒ¨ç½‘ç»œä¸­çš„é€šä¿¡-wireless" class="headerlink" title="å®è·µï¼šå±€éƒ¨ç½‘ç»œä¸­çš„é€šä¿¡-wireless"></a>å®è·µï¼šå±€éƒ¨ç½‘ç»œä¸­çš„é€šä¿¡-wireless</h4><!-- #### æ¨èé˜…è¯»ï¼šä»¥æ“ä½œç³»ç»Ÿä¸ºåŸºç¡€æŒ‰é¡ºåºé˜…è¯»ä»¥ä¸‹ä¹¦ç±

1. CSAPP
2. unixç¯å¢ƒé«˜çº§ç¼–ç¨‹
3. å›¾è§£TCP/IP && Wiresharkç½‘ç»œåˆ†æå°±æ˜¯è¿™ä¹ˆç®€å•
4. æ·±å…¥æµ…å‡ºnodejs
5. ç®—æ³•
6. æ•°æ®åº“æ¦‚è®º
7. SQLåŸºç¡€æ•™ç¨‹
8. Redisæ·±åº¦å†é™©ï¼šæ ¸å¿ƒåŸç†ä¸åº”ç”¨å®è·µ
9. Redisè®¾è®¡ä¸å®ç°
10. æ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ -->

<!-- ### æ€è€ƒï¼šä¸CDNçš„æ¯”è¾ƒ -->

<!-- ## æ¢³ç†ï¼šæ•°æ®ç»“æ„å’Œç®—æ³•çš„åº”ç”¨
1. LRU... -->

<!-- ## ç»ƒä¹ 
### Homework(jsç‰ˆæœ¬)
### Projects(jsç‰ˆæœ¬) -->

<!-- ## å¾…è¡¥å……ï¼šã€ŠUNIXç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹
### æ–‡ä»¶I/O
### ç»ˆç«¯I/O
### æ–‡ä»¶ä¸ç›®å½•
### è¿›ç¨‹
### çº¿ç¨‹
### ä¿¡å·
### IPC -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2020/11/07/Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/07/Docker/" class="post-title-link" itemprop="url">Docker</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-11-07 16:10:21" itemprop="dateCreated datePublished" datetime="2020-11-07T16:10:21+08:00">2020-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-11-10 18:38:42" itemprop="dateModified" datetime="2020-11-10T18:38:42+08:00">2020-11-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Set-up-your-Docker-environment"><a href="#Set-up-your-Docker-environment" class="headerlink" title="Set up your Docker environment"></a>Set up your Docker environment</h2><ul>
<li>å‡†å¤‡å·¥ä½œï¼š ä¸‹è½½</li>
<li>Dockerfile: é¡¹ç›®ä¸­æ ¹ç›®å½•ä¸‹å¢åŠ ä¸€ä¸ªDockerfileé…ç½®æ–‡ä»¶ï¼Œä»¥å‰ç«¯é¡¹ç›®ä¸ºä¾‹</li>
<li>docker å‡ ä¸ªæ¦‚å¿µå’Œå¸¸ç”¨å‘½ä»¤:<ul>
<li>æ¦‚å¿µï¼š<ul>
<li><code>container</code>: å®¹å™¨ï¼Œä¸€ä¸ªè¢«éš”ç¦»çš„ä¸”æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç½‘ç»œçš„æ­£å¸¸çš„æ“ä½œç³»ç»Ÿè¿›ç¨‹ï¼Œè¿›ç¨‹æ ‘ç‹¬ç«‹äºä¸»æœº</li>
<li><code>image</code>: é•œåƒï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶ç”¨æ¥ç”Ÿæˆå®¹å™¨çš„</li>
</ul>
</li>
<li>å¸¸ç”¨å‘½ä»¤ï¼š<ol>
<li><code>docker run your-Docker-image</code>,</li>
<li><code>docker ps --all</code></li>
<li>Build and test: <code>docker build --tag tagName:Vsesion .</code></li>
<li>Run your image as a container: <code>docker run --publish 8000:8080 --detach --name container-alias-name tagName:Vsesion</code></li>
<li>Delete container: <code>docker rm --force container-alias-name</code></li>
</ol>
</li>
</ul>
</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FORM: ä» node:12.18.1 è¿™ä¸ªçº¿ä¸Šçš„imageç»§æ‰¿</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">12.18</span>.<span class="number">1</span></span><br><span class="line"><span class="comment"># ENV æ‰§è¡Œç¯å¢ƒæ˜¯ç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯å¼€å‘ç¯å¢ƒ</span></span><br><span class="line"><span class="keyword">ENV</span> NODE_ENV=production</span><br><span class="line"><span class="comment"># WORKDIR: å·¥ä½œç›®å½•/app</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> [<span class="string">&quot;package.json&quot;</span>, <span class="string">&quot;package-lock.json*&quot;</span>, <span class="string">&quot;./&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install --production</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;node&quot;</span>, <span class="string">&quot;server.js&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<h2 id="Build-and-run-your-image-In-projects"><a href="#Build-and-run-your-image-In-projects" class="headerlink" title="Build and run your image: In projects"></a>Build and run your image: In projects</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2020/11/04/shell-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/04/shell-notes/" class="post-title-link" itemprop="url">Shell Notes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-11-04 13:11:30" itemprop="dateCreated datePublished" datetime="2020-11-04T13:11:30+08:00">2020-11-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-06-26 15:44:46" itemprop="dateModified" datetime="2021-06-26T15:44:46+08:00">2021-06-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç¬¬ä¸€ç« ï¼šæ¦‚è§ˆ"><a href="#ç¬¬ä¸€ç« ï¼šæ¦‚è§ˆ" class="headerlink" title="ç¬¬ä¸€ç« ï¼šæ¦‚è§ˆ"></a>ç¬¬ä¸€ç« ï¼šæ¦‚è§ˆ</h2><p><code>shell:</code> è®¡ç®—æœºæä¾›ç»™ç”¨æˆ·çš„ä¸€ç§æ–‡å­—æ¥å£ï¼Œæ ¸å¿ƒåŠŸèƒ½ - å…è®¸ç”¨æˆ·æ‰§è¡Œç¨‹åºï¼Œè¾“å…¥å¹¶è·å–æŸç§åŠç»“æ„åŒ–çš„è¾“å‡ºï¼›<br>shellæ˜¯ä¸€ä¸ªç¼–ç¨‹ç¯å¢ƒï¼Œæ‰€ä»¥å®ƒå…·å¤‡å˜é‡ã€æ¡ä»¶ã€å¾ªç¯å’Œå‡½æ•°ã€‚<br>å½“ä½ åœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ‰§è¡Œä¸€æ®µ shell å¯ä»¥è§£é‡Šæ‰§è¡Œçš„ç®€çŸ­ä»£ç ã€‚<br>å¦‚æœè¦æ±‚ shell æ‰§è¡ŒæŸä¸ªæŒ‡ä»¤ï¼Œä½†æ˜¯è¯¥æŒ‡ä»¤å¹¶ä¸æ˜¯ shell æ‰€äº†è§£çš„ç¼–ç¨‹å…³é”®å­—ï¼Œé‚£ä¹ˆå®ƒä¼šå»æŸ¥è¯¢ç¯å¢ƒå˜é‡ $PATHï¼Œæœç´¢ç”±<code>:</code>åˆ†éš”çš„ä¸€ç³»åˆ—ç›®å½•ï¼ŒåŸºäºåå­—æœç´¢è¯¥æ‰§è¡Œç¨‹åº</p>
<h3 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><h4 id="shellçš„ç•Œé¢ï¼ˆbash-zshï¼‰"><a href="#shellçš„ç•Œé¢ï¼ˆbash-zshï¼‰" class="headerlink" title="shellçš„ç•Œé¢ï¼ˆbash@zshï¼‰"></a>shellçš„ç•Œé¢ï¼ˆbash@zshï¼‰</h4><p><code>#</code> å¼€å¤´æ˜¯æ³¨é‡Šï¼Œæç¤ºä¿¡æ¯ï¼Œ<code>hostname</code>æ˜¯ä¸»æœºåï¼Œ<code>~</code>æŒ‡å½“å‰å·¥ä½œç›®å½•æ˜¯<code>home</code>ï¼Œ<code>$</code>è¡¨ç¤ºå½“å‰ç”¨æˆ·ä¸æ˜¯<code>root</code>ç”¨æˆ·ï¼Œ<code>Last login...</code>æ‰“å¼€ä¸€ä¸ªæ–°çš„windowå°±ä¼šå‡ºç°è¯¥æç¤º</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Last login: Tue Nov  3 17:59:22 on ttys007</span><br><span class="line"><span class="comment"># hostname @ MacBook-Air in ~ [13:34:52]</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<h4 id="åŸºç¡€å‘½ä»¤-ä½¿ç”¨-man-command-æ¥äº†è§£è¿™äº›å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯"><a href="#åŸºç¡€å‘½ä»¤-ä½¿ç”¨-man-command-æ¥äº†è§£è¿™äº›å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="åŸºç¡€å‘½ä»¤: ä½¿ç”¨ man [command]æ¥äº†è§£è¿™äº›å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯"></a>åŸºç¡€å‘½ä»¤: ä½¿ç”¨ <code>man [command]</code>æ¥äº†è§£è¿™äº›å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯</h4><blockquote>
<p>å†…ç½®å‘½ä»¤&amp;å˜é‡: date, echo, which echo, $PATH, ls, cd, pwd, /(root path), ./(current path,relative), ../(parent path, relative), mv(ç”¨äºé‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶), mkdir(æ–°å»ºæ–‡ä»¶å¤¹), cp(å¤åˆ¶æ–‡ä»¶)</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># -l  use a long listing format</span></span><br><span class="line">$ ls -l /home</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x   3 user  staff   96 12  9  2016 beginning</span><br><span class="line">  _3_           /|\</span><br><span class="line">   |_____________|</span><br><span class="line"><span class="comment"># d -&gt; directory</span></span><br><span class="line"><span class="comment"># ç„¶åæ¥ä¸‹æ¥çš„ä¹ä¸ªå­—ç¬¦ï¼Œæ¯ä¸‰ä¸ªå­—ç¬¦æ„æˆä¸€ç»„</span></span><br><span class="line"><span class="comment"># rwx -&gt; æŒ‡(user)æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™</span></span><br><span class="line"><span class="comment"># r-x -&gt; ç”¨æˆ·(staff)çš„æƒé™ï¼Œ`-x`ä»£è¡¨staffæ²¡æœ‰æ‰§è¡Œæ–‡ä»¶(x)çš„æƒé™</span></span><br><span class="line"><span class="comment"># r-x -&gt; å…¶ä»–å®¢äººç”¨æˆ·çš„æƒé™</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Last login: Fri Nov  6 18:13:54 on ttys007</span><br><span class="line"><span class="comment"># username @ MacBook-Air in ~ [13:34:52]</span></span><br><span class="line">$ date</span><br><span class="line">2020å¹´11æœˆ 7æ—¥ æ˜ŸæœŸå…­ 16æ—¶09åˆ†15ç§’ CST</span><br><span class="line">$ <span class="built_in">echo</span> hello DaiYing</span><br><span class="line">hello DaiYing</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/Users/hostname/.yarn/bin:/Users/hostname/.config/yarn/global/node_modules/.bin:/Users/hostname/.avn/bin:/Users/hostname/.nvm/versions/node/v8.9.4/bin:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Users/hostname/.rvm/bin</span><br><span class="line">$ <span class="built_in">which</span> <span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span>: shell built-in <span class="built_in">command</span></span><br></pre></td></tr></table></figure>

<h4 id="åœ¨ç¨‹åºé—´å»ºç«‹è¿æ¥"><a href="#åœ¨ç¨‹åºé—´å»ºç«‹è¿æ¥" class="headerlink" title="åœ¨ç¨‹åºé—´å»ºç«‹è¿æ¥"></a>åœ¨ç¨‹åºé—´å»ºç«‹è¿æ¥</h4><blockquote>
<p>è¾“å…¥æµï¼Œè¾“å‡ºæµï¼Œé‡å®šå‘(é‡å®šå‘æ–¹å‘ &lt;, &gt;é‡å®šå‘æ–¹å‘, &gt;&gt;è¿½åŠ å†…å®¹æ–¹å‘)<br>| (pipes)ç®¡é“æ“ä½œç¬¦ï¼Œè¿æ¥å·¦è¾¹çš„è¾“å…¥åˆ°å³è¾¹çš„è¾“å‡º<br>sudo(super user do)æ ¹ç”¨æˆ·</p>
</blockquote>
<h4 id="ç»ƒä¹ é¢˜ï¼šMac-OSXç³»ç»Ÿ"><a href="#ç»ƒä¹ é¢˜ï¼šMac-OSXç³»ç»Ÿ" class="headerlink" title="ç»ƒä¹ é¢˜ï¼šMac OSXç³»ç»Ÿ"></a>ç»ƒä¹ é¢˜ï¼šMac OSXç³»ç»Ÿ</h4><ul>
<li>æ–°å»ºtmp/missing/semesteræ–‡ä»¶ï¼ŒæŒ‰è¡Œå‘semesterè¾“å…¥å†…å®¹</li>
<li><a href="https://github.com/MillyTang/missing-semester/blob/main/first.sh">ç»ƒä¹ </a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># username @ MacBook-Air in ~ [16:52:44]</span></span><br><span class="line">$ mkdir tmp</span><br><span class="line">$ <span class="built_in">cd</span> tmp/</span><br><span class="line">$ mkdir missing</span><br><span class="line">$ <span class="built_in">cd</span> missing/</span><br><span class="line">$ touch semester</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;#!/bin/sh&#x27;</span> &gt; semester</span><br><span class="line"><span class="comment"># è¿½åŠ ç¬¬äºŒè¡Œå†…å®¹</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;curl --head --silent https://missing.csail.mit.edu&#x27;</span> &gt;&gt; semester</span><br><span class="line">$ vim semester</span><br><span class="line"><span class="comment"># :qé€€å‡º</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬äºŒç« ï¼š-shellå·¥å…·å’Œè„šæœ¬"><a href="#ç¬¬äºŒç« ï¼š-shellå·¥å…·å’Œè„šæœ¬" class="headerlink" title="ç¬¬äºŒç« ï¼š shellå·¥å…·å’Œè„šæœ¬"></a>ç¬¬äºŒç« ï¼š shellå·¥å…·å’Œè„šæœ¬</h2><h3 id="å­—ç¬¦ä¸²åŒºåˆ«"><a href="#å­—ç¬¦ä¸²åŒºåˆ«" class="headerlink" title="å­—ç¬¦ä¸²åŒºåˆ«"></a>å­—ç¬¦ä¸²åŒºåˆ«</h3><ul>
<li><code>&#39;&#39;</code>å•å¼•å·å¯ä»¥è½¬ä¹‰</li>
<li><code>&quot;&quot;</code>åŒå¼•å·ä¸è¡Œ</li>
</ul>
<blockquote>
<p>shellè®¿é—®å˜é‡: å‰ç¼€$+å˜é‡åï¼›å¦‚ï¼š$foo</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo=bar</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$foo</span>&quot;</span></span><br><span class="line">bar</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;$foo&#x27;</span></span><br><span class="line"><span class="variable">$foo</span></span><br></pre></td></tr></table></figure>

<h3 id="shellè„šæœ¬æ§åˆ¶æµ"><a href="#shellè„šæœ¬æ§åˆ¶æµ" class="headerlink" title="shellè„šæœ¬æ§åˆ¶æµ"></a>shellè„šæœ¬æ§åˆ¶æµ</h3><blockquote>
<p>Here is an example of a func that creates a dir and  cd into it</p>
</blockquote>
<ul>
<li><code>$0</code>-script command</li>
<li><code>$1</code>~<code>$9</code>- script commandçš„å‚æ•°</li>
<li><code>$@</code> script commandçš„æ‰€æœ‰å‚æ•°</li>
<li><code>$#</code>- script commandå‚æ•°ä¸ªæ•°</li>
<li><code>$?</code>-ä¸Šä¸€ä¸ªscript command</li>
<li><code>$$</code>-å½“å‰scrippt commandçš„PID(Process Identification number)</li>
<li><code>!!</code>-ä½¿ç”¨<code>sudo !!</code>æ‰§è¡Œä¸Šä¸€ä¸ªcommand(åŒ…å«æ‰€æœ‰å‚æ•°)</li>
<li><code>$_</code>-ä¸Šä¸€ä¸ªå‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># testShellFunc.sh</span></span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="function"><span class="title">mcd</span></span>() &#123;</span><br><span class="line">  mkdir -p <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># bashæ‰§è¡ŒtestShellFunc.shæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># source å¯æ‰§è¡Œshellæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">source</span> testShellFunc.sh</span><br><span class="line"><span class="comment"># cd æ˜¯åœ¨ mcd()å†…éƒ¨ï¼Œé’ˆå¯¹çš„æ˜¯å­shell, ä¸å½±å“å¤–éƒ¨ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æ‰§è¡Œ ./testShellFunc.sh</span></span><br></pre></td></tr></table></figure>

<h3 id="çŸ­è·¯æ“ä½œç¬¦"><a href="#çŸ­è·¯æ“ä½œç¬¦" class="headerlink" title="çŸ­è·¯æ“ä½œç¬¦"></a>çŸ­è·¯æ“ä½œç¬¦</h3><blockquote>
<p><code>||, &amp;&amp;, ;</code>, åŒä¸€è¡Œå‘½ä»¤å¯ä»¥ç”¨<code>;</code>é—´éš”ï¼Œ<code>true</code>çš„è¿”å›ç æ˜¯<code>0</code>,<code>false</code>çš„è¿”å›ç æ˜¯<code>1</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å’Œjsçš„çŸ­è·¯æ“ä½œç¬¦ç»“æœç›¸ä¼¼ï¼Œè¿™é‡Œå”¯ä¸€ç‰¹åˆ«çš„æ˜¯ã€Œ;ã€ï¼Œå§‹ç»ˆèƒ½è¿è¡ŒçŸ­è·¯åé¢çš„è¯­å¥</span></span><br><span class="line"><span class="literal">true</span> ; <span class="built_in">echo</span> <span class="string">&#x27;I can run!&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼šI can run!</span></span><br><span class="line"><span class="literal">false</span> ; <span class="built_in">echo</span> <span class="string">&#x27;I can run again!&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼šI can run again!</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>linuxä¸­ï¼š <code>| and ||, &amp; and &amp;&amp;, &amp;&gt; and &gt;</code> çš„åŒºåˆ«ï¼š<br><code>&amp;</code> è¡¨ç¤ºä»»åŠ¡åœ¨åå°æ‰§è¡Œï¼Œå¦‚è¦åœ¨åå°è¿è¡Œ<br><code>|</code> è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤å‚æ•°(è¾“å…¥)<br><code>&gt;</code>ç¬¦å·æ˜¯æŒ‡ï¼šå°†æ­£å¸¸ä¿¡æ¯é‡å®šå‘; <code>&amp;&gt;</code>å¯ä»¥å°†é”™è¯¯ä¿¡æ¯æˆ–è€…æ™®é€šä¿¡æ¯éƒ½é‡å®šå‘è¾“å‡º</p>
</blockquote>
<h3 id="å‘½ä»¤æ›¿æ¢ï¼šä»¥å˜é‡çš„å½¢å¼è·å–ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡º"><a href="#å‘½ä»¤æ›¿æ¢ï¼šä»¥å˜é‡çš„å½¢å¼è·å–ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡º" class="headerlink" title="å‘½ä»¤æ›¿æ¢ï¼šä»¥å˜é‡çš„å½¢å¼è·å–ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡º"></a>å‘½ä»¤æ›¿æ¢ï¼šä»¥å˜é‡çš„å½¢å¼è·å–ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡º</h3><blockquote>
<p>æ‰§è¡Œ<code>$(CMD)</code>,<code>CMD</code>çš„æ‰§è¡Œç»“æœä¼šæ›¿æ¢<code>$(CMD)</code>çš„ä½ç½®ï¼›<br>å†·é—¨åº”ç”¨-è¿›ç¨‹æ›¿æ¢:<code>&lt;(CMD)</code>, æ‰§è¡Œç»“æœå°†ä¼šè¾“å‡ºåˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶è€Œä¸æ˜¯é€šè¿‡<code>STDIN</code>ä¼ é€’<br>ç‰¹æ®Šçš„è¿›ç¨‹æ ‡è¯†ç¬¦ï¼š 0æ ‡å‡†è¾“å…¥(stdin),1æ ‡å‡†è¾“å‡º(stdout),2æ ‡å‡†é”™è¯¯(stderr)</p>
</blockquote>
<ul>
<li><code>2&gt;</code>é‡å®šå‘stderrï¼›å¼•ç”³ï¼š<code>&amp;&gt;</code>é‡å®šå‘stderr, <code>&gt;&amp;2</code>ï¼Œé‡å®šå‘<code>åˆ°</code>stderr</li>
<li><code>-ne</code> means <code>not equal to</code>, æŸ¥é˜…<code>bash æ¡ä»¶è¡¨è¾¾å¼</code>æˆ–<code>man test</code>(æŸ¥testæ‰‹å†Œ)</li>
<li>ä½¿ç”¨<code>shellcheck</code>å·¥å…·æ£€æŸ¥shell scripté”™è¯¯</li>
<li>è¯¦è§<a target="_blank" rel="noopener" href="http://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html">bash æ¡ä»¶è¡¨è¾¾å¼</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/test.1.html">testæ‰‹å†Œ</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># testfunc.bash, æ³¨æ„åç¼€æ˜¯bash,è€Œä¸æ˜¯sh,å› ä¸º`[[`åˆ¤æ–­ç¬¦ä¸shä¸å…¼å®¹</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Starting program at <span class="subst">$(date)</span>&quot;</span> <span class="comment"># dateä¼šè¢«æ›¿æ¢æˆæ—¥æœŸå’Œæ—¶é—´</span></span><br><span class="line"><span class="comment"># `$$`è¿›ç¨‹IDï¼Œ`$#`å‚æ•°ä¸ªæ•°ï¼Œ$0å½“å‰å‘½ä»¤</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Running program <span class="variable">$0</span> with <span class="variable">$#</span> arguments with pid $$&quot;</span></span><br><span class="line"><span class="comment"># `$@`æ‰€æœ‰å‚æ•°</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$@</span>; <span class="keyword">do</span></span><br><span class="line">    grep foobar <span class="variable">$file</span> &gt; /dev/null 2&gt; /dev/null</span><br><span class="line">    <span class="comment"># å¦‚æœæ¨¡å¼æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™grepé€€å‡ºçŠ¶æ€ä¸º 1</span></span><br><span class="line">    <span class="comment"># æˆ‘ä»¬å°†æ ‡å‡†è¾“å‡ºæµå’Œæ ‡å‡†é”™è¯¯æµé‡å®šå‘åˆ°Nullï¼Œå› ä¸ºæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè¿™äº›ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">if</span> [[ $? -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;File <span class="variable">$file</span> does not have any foobar, adding one&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;# foobar&quot;</span> &gt;&gt; <span class="string">&quot;<span class="variable">$file</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># `source testfunc.bash`</span></span><br><span class="line"><span class="comment"># è¾“å‡ºï¼š </span></span><br><span class="line"><span class="comment"># Starting program at 2020å¹´12æœˆ20æ—¥ æ˜ŸæœŸæ—¥ 14æ—¶52åˆ†03ç§’ CST</span></span><br><span class="line"><span class="comment"># Running program ./testfunc.bash with 0 arguments with pid 10741</span></span><br><span class="line"><span class="comment"># åŠ ç‚¹å‚æ•°æ‰§è¡Œ `source testfunc.bash test1 test2`, åŒæ—¶åœ¨åŒçº§ç›®å½•ä¸‹ç”Ÿæˆäº† test1 &amp; test2æ–‡ä»¶å¹¶å‘æ–‡ä»¶ä¸­è¾“å…¥äº† `# foobar`</span></span><br><span class="line">Starting program at 2020å¹´12æœˆ20æ—¥ æ˜ŸæœŸæ—¥ 14æ—¶54åˆ†51ç§’ CST</span><br><span class="line">Running program ./testfunc.bash with 2 arguments with pid 10741</span><br><span class="line">File test1 does not have any foobar, adding one</span><br><span class="line">File test2 does not have any foobar, adding one</span><br></pre></td></tr></table></figure>

<h3 id="shellçš„-é€šé…ï¼ˆ-globbingï¼‰-æ­£åˆ™"><a href="#shellçš„-é€šé…ï¼ˆ-globbingï¼‰-æ­£åˆ™" class="headerlink" title="shellçš„ é€šé…ï¼ˆ globbingï¼‰: {}, æ­£åˆ™"></a>shellçš„ é€šé…ï¼ˆ globbingï¼‰: {}, æ­£åˆ™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">convert image.&#123;png,jpg&#125;</span><br><span class="line"><span class="comment"># å±•å¼€ä¸º: </span></span><br><span class="line">convert image.png image.jpg</span><br><span class="line">cp /path/to/project/&#123;foo,bar&#125;.sh /newpath</span><br><span class="line"><span class="comment"># å±•å¼€ä¸º: </span></span><br><span class="line">cp /path/to/project/foo.sh /path/to/project/bar.sh /newpath</span><br><span class="line">mv *&#123;.py,.sh&#125; folder</span><br><span class="line"><span class="comment"># ä¼šç§»åŠ¨æ‰€æœ‰ *.py å’Œ *.sh æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºfooå’Œbaræ–‡ä»¶çš„ä¸åŒ</span></span><br><span class="line">diff &lt;(ls foo) &lt;(ls bar)</span><br></pre></td></tr></table></figure>

<h3 id="shebang"><a href="#shebang" class="headerlink" title="shebang"></a>shebang</h3><blockquote>
<p><code>#!</code>è¯­æ³•ä½¿ç”¨è„šæœ¬æ¥æŒ‡ç¤ºè§£é‡Šå™¨å¦‚ä½•åœ¨<code>unix/linux</code>ä¸‹æ‰§è¡Œ<br>ä¾‹å¦‚ï¼š <code>#!/bin/bash</code>;<code>#!/usr/bin/perl</code>;<code>#!/usr/bin/python</code>;<code>#!/usr/bin/python3</code>;<code>#!/usr/bin/env bash</code><br>å¦‚æœä¸æŒ‡å®šè§£é‡Šå™¨ï¼Œé€šå¸¸ä¼šé»˜è®¤ä¸º<code>#!/bin/sh</code>,ä¸è¿‡å®˜æ–¹æ¨èä½¿ç”¨<code>#!/bin/bash</code>,<code>shå’Œbash</code>åœ¨æŸäº›è¯­æ³•ä¸Šæœ‰äº›ä¸å…¼å®¹ï¼Œå¦‚æ¡ä»¶åˆ¤æ–­<code>[[]]</code></p>
</blockquote>
<ul>
<li>ä½¿ç”¨<code>env</code>æ¥æ‰§è¡Œé<code>bash</code>è„šæœ¬ï¼Œ<code>env</code>ä¼šåˆ©ç”¨<code>PATH</code>å˜é‡æ¥å®šä½è„šæœ¬</li>
<li><a target="_blank" rel="noopener" href="https://bash.cyberciti.biz/guide/Shebang#:~:text=It%20is%20called%20a%20shebang%20or%20a%20%22bang%22,using%20the%20interpreter%20specified%20on%20a%20first%20line.">å‚è€ƒ</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/local/bin/python</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨pythonæ¥è§£æè¯¥è„šæœ¬</span></span><br><span class="line">import sys</span><br><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> reversed(sys.argv[1:]):</span><br><span class="line">    <span class="built_in">print</span>(arg)</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹å‘½ä»¤"><a href="#æŸ¥çœ‹å‘½ä»¤" class="headerlink" title="æŸ¥çœ‹å‘½ä»¤"></a>æŸ¥çœ‹å‘½ä»¤</h4><ul>
<li><code>man -h</code>æŸ¥çœ‹å‘½ä»¤å¦‚ä½•ä½¿ç”¨</li>
<li>ä½¿ç”¨<code>TLDR</code>ï¼Œä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£å“ï¼Œ<code>npm install -g tldr</code>å…¨å±€å®‰è£…</li>
</ul>
<h4 id="æŸ¥æ‰¾æ–‡ä»¶"><a href="#æŸ¥æ‰¾æ–‡ä»¶" class="headerlink" title="æŸ¥æ‰¾æ–‡ä»¶"></a>æŸ¥æ‰¾æ–‡ä»¶</h4><ul>
<li><code>find</code>å·¥å…·</li>
<li><code>fd</code>æ›´å¿«æ›´å‹å¥½</li>
<li><code>locate</code>åªèƒ½é€šè¿‡æ–‡ä»¶åæ¥å®šä½ï¼Œä¸”æ¯å¤©éƒ½ä¼šæ›´æ–°</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰åç§°ä¸ºsrcçš„ æ–‡ä»¶å¤¹:d</span></span><br><span class="line">find . -name src -<span class="built_in">type</span> d</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶å¤¹è·¯å¾„ä¸­åŒ…å«testçš„python æ–‡ä»¶:f</span></span><br><span class="line">find . -path <span class="string">&#x27;**/test/**/*.py&#x27;</span> -<span class="built_in">type</span> f</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾å‰ä¸€å¤©ä¿®æ”¹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">find . -mtime -1</span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰å¤§å°åœ¨500kè‡³10Mçš„tar.gzæ–‡ä»¶</span></span><br><span class="line">find . -size +500k -size -10M -name <span class="string">&#x27;*.tar.gz&#x27;</span></span><br><span class="line"><span class="comment"># Delete all files with .tmp extension</span></span><br><span class="line">find . -name <span class="string">&#x27;*.tmp&#x27;</span> -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br><span class="line"><span class="comment"># Find all PNG files and convert them to JPG</span></span><br><span class="line">find . -name <span class="string">&#x27;*.png&#x27;</span> -<span class="built_in">exec</span> convert &#123;&#125; &#123;&#125;.jpg \;</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥æ‰¾ä»£ç "><a href="#æŸ¥æ‰¾ä»£ç " class="headerlink" title="æŸ¥æ‰¾ä»£ç "></a>æŸ¥æ‰¾ä»£ç </h4><ul>
<li><code>grep</code>å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡ŒåŒ¹é…çš„é€šç”¨å·¥å…·, <code>ack</code>, <code>ag</code>ç­‰</li>
<li><code>rg</code>ï¼Œripgrepé€Ÿåº¦å¿«ï¼Œç¬¦åˆç›´è§‰</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰ä½¿ç”¨äº† requests åº“çš„æ–‡ä»¶</span></span><br><span class="line">rg -t py <span class="string">&#x27;import requests&#x27;</span></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰æ²¡æœ‰å†™ shebang çš„æ–‡ä»¶ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰</span></span><br><span class="line">rg -u --files-without-match <span class="string">&quot;^#!&quot;</span></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰çš„fooå­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°å…¶ä¹‹åçš„5è¡Œ</span></span><br><span class="line">rg foo -A 5</span><br><span class="line"><span class="comment"># æ‰“å°åŒ¹é…çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆåŒ¹é…çš„è¡Œå’Œæ–‡ä»¶çš„æ•°é‡ï¼‰</span></span><br><span class="line">rg --stats PATTERN</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥æ‰¾shellå‘½ä»¤"><a href="#æŸ¥æ‰¾shellå‘½ä»¤" class="headerlink" title="æŸ¥æ‰¾shellå‘½ä»¤"></a>æŸ¥æ‰¾shellå‘½ä»¤</h4><ul>
<li><code>history</code>è®¿é—®shellä¸­è¾“å…¥çš„å†å²å‘½ä»¤, <code>history | grep find</code> ä¼šæ‰“å°åŒ…å«findå­ä¸²çš„å‘½ä»¤</li>
<li><code>Ctrl+R</code>å‘½ä»¤å†å²è®°å½•è¿›è¡Œå›æº¯æœç´¢ï¼Œå¯ä»¥é…åˆ<code>fzf</code>ä½¿ç”¨ï¼Œ<code>fzf</code> æ˜¯ä¸€ä¸ªé€šç”¨å¯¹æ¨¡ç³ŠæŸ¥æ‰¾å·¥å…·</li>
<li>è¾“å…¥å‘½ä»¤æ—¶ï¼Œå¦‚æœæ‚¨åœ¨å‘½ä»¤çš„å¼€å¤´åŠ ä¸Šä¸€ä¸ªç©ºæ ¼ï¼Œå®ƒå°±ä¸ä¼šè¢«åŠ è¿›shellè®°å½•ä¸­</li>
<li>bash_historyæˆ– .zhistory æ¥æ‰‹åŠ¨åœ°ä»å†å²è®°å½•ä¸­ç§»é™¤</li>
</ul>
<h4 id="æ–‡ä»¶å†…å¯¼èˆª"><a href="#æ–‡ä»¶å†…å¯¼èˆª" class="headerlink" title="æ–‡ä»¶å†…å¯¼èˆª"></a>æ–‡ä»¶å†…å¯¼èˆª</h4><ul>
<li><code>fasd</code>å¯ä»¥æŸ¥æ‰¾æœ€å¸¸ç”¨å’Œ/æˆ–æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å’Œç›®å½•ã€‚åŸºäº <code>frecency</code> å¯¹æ–‡ä»¶å’Œæ–‡ä»¶æ’åºï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šåŒæ—¶é’ˆå¯¹é¢‘ç‡ï¼ˆfrequency ï¼‰å’Œæ—¶æ•ˆï¼ˆ recencyï¼‰è¿›è¡Œæ’åº</li>
<li>æ¦‚è§ˆç›®å½•ç»“æ„ï¼š <code>tree</code>, <code>broot</code></li>
<li>æ–‡ä»¶ç®¡ç†å™¨ï¼š <code>nnn</code>, <code>ranger</code></li>
</ul>
<h4 id="è¯¾åç»ƒä¹ "><a href="#è¯¾åç»ƒä¹ " class="headerlink" title="è¯¾åç»ƒä¹ "></a>è¯¾åç»ƒä¹ </h4><ul>
<li>ç¬¬ä¸€é¢˜ï¼š<code>ls -AGulht</code></li>
<li>ç¬¬äºŒé¢˜ï¼š<a href="https://github.com/MillyTang/missing-semester/tree/main/second/macro.bash">macro.bash</a>; <a href="https://github.com/MillyTang/missing-semester/tree/main/second/polo.bash">polo.bash</a></li>
<li>ç¬¬ä¸‰é¢˜ï¼š<a href="https://github.com/MillyTang/missing-semester/tree/main/second/check_run.bash">check_run</a></li>
<li>ç¬¬å››é¢˜ï¼š<code>find . -name &#39;*.html&#39; | xargs -0 zip -r output.zip</code> æ³¨æ„æ–‡ä»¶åä¸è¦ç›¸åŒï¼Œå¦åˆ™zipä¼šæŠ›é”™åœæ­¢</li>
<li>ç¬¬äº”é¢˜ï¼š <code>find . ctime 10</code></li>
</ul>
<h4 id="å…¶ä»–ç»ƒä¹ -amp-å¸¸ç”¨å‘½ä»¤"><a href="#å…¶ä»–ç»ƒä¹ -amp-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å…¶ä»–ç»ƒä¹ &amp;å¸¸ç”¨å‘½ä»¤"></a>å…¶ä»–ç»ƒä¹ &amp;å¸¸ç”¨å‘½ä»¤</h4><p>sshæœ¬åœ°ä¸Šä¼ åŒ…æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‹ç¼©distæ–‡ä»¶å¤¹</span></span><br><span class="line">zip -r dist.zip dist</span><br><span class="line">scp dist.zip username@hostname:/path/<span class="keyword">in</span>/dir/</span><br><span class="line">username@hostname<span class="string">&#x27;&quot;s&#x27;</span> password:</span><br><span class="line"><span class="comment"># ç™»å½•æœåŠ¡å™¨æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸ</span></span><br><span class="line">ssh username@hostname</span><br><span class="line">username@hostname<span class="string">&#x27;&quot;s&#x27;</span> password:</span><br><span class="line"><span class="built_in">cd</span> /path/<span class="keyword">in</span>/dir/</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">ll</span><br><span class="line"><span class="comment"># è§£å‹ä¸Šä¼ çš„dist.zip</span></span><br><span class="line">unzip dist.zip</span><br><span class="line">mv old-dir save-old-dir</span><br><span class="line">mv dist old-dir</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/MillyTang/MillyTang.github.io/2020/11/03/sad-punk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Comfortably Numb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/03/sad-punk/" class="post-title-link" itemprop="url">The Adventure of DaiYing</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-11-03 18:38:08" itemprop="dateCreated datePublished" datetime="2020-11-03T18:38:08+08:00">2020-11-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-07 13:21:20" itemprop="dateModified" datetime="2021-09-07T13:21:20+08:00">2021-09-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ–½å·¥ğŸš§ä¸­ï¼Œæ•¬è¯·æœŸå¾…</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ä¸»ä½“-å®¢ä½“è”åˆåˆ›ä½œ</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
